

[toc]

# wordè¡¨æ ¼

## ref

- [æ‹†åˆ†è¡¨æ ¼ - Microsoft æ”¯æŒ](https://support.microsoft.com/zh-cn/office/æ‹†åˆ†è¡¨æ ¼-d231a898-6983-4ef8-acb0-797c7f2b0c45)
- [è°ƒæ•´è¡¨æ ¼ã€åˆ—æˆ–è¡Œçš„å¤§å° - Microsoft æ”¯æŒ](https://support.microsoft.com/zh-cn/office/è°ƒæ•´è¡¨æ ¼-åˆ—æˆ–è¡Œçš„å¤§å°-9340d478-21be-4392-81cf-488f7bbd6715)
- [wordè¡¨æ ¼ç¾åŒ–æŠ€å·§ï¼šå¦‚ä½•ç»Ÿä¸€æ”¹å˜è¡¨æ ¼çš„æ ·å¼ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/266351000)

## å¸¸ç”¨æ“ä½œ

| pictures                                                     | caption                                                      |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/0426cf874f6b48fdb0e5b8fa7247e317.png) | é€‰ä¸­è¡¨æ ¼                                                     |
| ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/faae78f9b39c4e5b93e688aed40f5c53.png) | é€‰ä¸­è¡¨æ ¼å¸ƒå±€borderç»„çš„å°ç®­å¤´:`borders and shading`è®¾ç½®è¡¨æ ¼æ¡†çº¿ |
| ![image-20230501212941771](D:\repos\blogs\softwares\office@wps\word\assets\image-20230501212941771.png) | åŒºåˆ†ä¸¤ä¸ª`å¸ƒå±€`                                               |

## è¡¨æ ¼å•å…ƒæ ¼åˆå¹¶vsçº¿æ¡æ“¦é™¤

- [å°†è¡¨æ ¼å•å…ƒæ ¼åˆå¹¶ä¸ºä¸€ä¸ªå•å…ƒæ ¼ - Microsoft æ”¯æŒ](https://support.microsoft.com/zh-cn/office/å°†è¡¨æ ¼å•å…ƒæ ¼åˆå¹¶ä¸ºä¸€ä¸ªå•å…ƒæ ¼-689227b5-c73f-43e8-bece-ac564f60b9eb)
- å•å…ƒæ ¼åˆå¹¶å’Œçº¿æ¡æ“¦é™¤ä½œç”¨ä¸åŒ,é€šå¸¸å•å…ƒæ ¼åˆå¹¶æ›´åŠ å¸¸ç”¨,é¼ æ ‡é€‰ä¸­(æ‹–é€‰)æƒ³è¦åˆå¹¶çš„è¿ç»­(ç›¸é‚»)å•å…ƒæ ¼è¿›è¡Œåˆå¹¶(cell merge)
- ä¸¤è€…æœ€æ˜æ˜¾çš„å·®åˆ«åœ¨äºå•å…ƒæ ¼å†…å®¹å±…ä¸­çš„æ—¶å€™è¡¨ç°å‡ºä¸åŒçš„è¡Œä¸º

## å¤„ç†è·¨é¡µè¡¨æ ¼

- é•¿è¡¨æ ¼è·¨é¡µ:
  - [Format a table|Control where a table is divided - Microsoft Support](https://support.microsoft.com/en-us/office/format-a-table-e6e77bc6-1f4e-467e-b818-2e2acc488006#ID0EFDBD)
- å¼ºåˆ¶è·¨é¡µ:
  - [Format a table|Force a table to break across pages at a particular row - Microsoft Support](https://support.microsoft.com/en-us/office/format-a-table-e6e77bc6-1f4e-467e-b818-2e2acc488006#ID0EFBBD)

## è¡¨æ ¼å±æ€§è®¾ç½®

- [Set or change table properties - Microsoft Support](https://support.microsoft.com/en-us/office/set-or-change-table-properties-3237de89-b287-4379-8e0c-86d94873b2e0#__toc1)
- [è®¾ç½®æˆ–æ›´æ”¹è¡¨æ ¼å±æ€§ - Microsoft æ”¯æŒ](https://support.microsoft.com/zh-cn/office/è®¾ç½®æˆ–æ›´æ”¹è¡¨æ ¼å±æ€§-3237de89-b287-4379-8e0c-86d94873b2e0)

### è¡¨æ ¼çš„å¯¹é½

| pictures                                                     | notes                                                        |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/e211db63ded64bb6b14d259dd59c038d.png) | è¡¨æ ¼å±æ€§è®¾ç½®çª—å£(`Table Properties)`<br />`Table`é€‰é¡¹å¡:<br />1. è¿™é‡Œçš„å¯¹é½æ˜¯åœ¨è¡¨æ ¼æŒ‡æ°´å¹³å®½åº¦å†…,æ•´ä¸ªè¡¨æ ¼çš„å¯¹é½,è€Œä¸æ˜¯å•å…ƒæ ¼å†…å†…å®¹å¯¹é½;<br /> |
| ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/f9308d7e57a14e529d6cc655f5f693fa.png) | `Cell`é€‰é¡¹å¡ä¸­å¯ä»¥è®¾ç½®è¡¨æ ¼å•å…ƒæ ¼å†…å®¹çš„å¯¹é½<br />ä¸å¹¸çš„æ˜¯,è¯¥é€‰é¡¹å¡åªæä¾›äº†ç«–ç›´æ–¹å‘ä¸Šçš„å¯¹é½,è€Œæ²¡æœ‰æ°´å¹³æ–¹å‘ä¸Šå¯¹é½çš„é€‰é¡¹ |
| ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/a4f465286a934491817d4753f672f78d.png) | æƒ³è¦è°ƒæ•´å•å…ƒæ ¼å†…å®¹åœ¨æ°´å¹³æ–¹å‘çš„å¯¹é½,éœ€è¦åˆ°:<br />`table tool`->`layout`->`Align Center`ä¸­è°ƒèŠ‚ |

### è¡¨æ ¼å†…æ–‡æœ¬çš„æ ·å¼å’Œå¯¹é½

- [Table options - Microsoft Support](https://support.microsoft.com/en-us/office/table-options-be966c8b-6fe7-49c9-927a-ac976f2d1cfa?ns=winword&version=19&syslcid=1033&uilcid=1033&appver=zwd190&helpid=547&ui=en-us&rs=en-us&ad=us)

- | pictures                                                     | notes                                                 |
  | ------------------------------------------------------------ | ----------------------------------------------------- |
  | ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/88fe718208db4f3da414170ce8d23c4b.png) | å·¦ä¾§è¡¨æ ¼æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªå•å…ƒæ ¼å†…å¯¹é½çš„9ä¸­ä½ç½®             |
  | ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/aad003bce6014949bdb6be9e49bc06b1.png) | å–æ¶ˆå•å…ƒæ ¼å†…çš„è¾¹è·è®¾ç½®,ä»¥ä¾¿å®Œå…¨å±…ä¸­å•å…ƒæ ¼å†…å®¹å¯ä»¥å®ç° |

- æ¨èåšæ³•æ˜¯ä¸ºè¡¨æ ¼å•å…ƒæ ¼çš„æ–‡æœ¬è®¾ç½®ä¸€ä¸ªä¸“é—¨çš„æ ·å¼,é€šå¸¸,è¿™ä¸ªæ ·å¼<u>ä¸è¦æœ‰ç¼©è¿›</u>

- å¦‚æœæƒ³è¦å°†è¡¨æ ¼å†…å®¹å±…ä¸­(ä½äºå•å…ƒæ ¼ä¸­å¿ƒ),è¡¨æ ¼å±æ€§çš„è®¾ç½®ä¸­marginä¹Ÿåº”è¯¥è®¾ç½®0

  

## è¡¨æ ¼è®¾è®¡

- [Format a table - Microsoft Support](https://support.microsoft.com/en-us/office/format-a-table-e6e77bc6-1f4e-467e-b818-2e2acc488006)
- [Customize or create new styles - Microsoft Support](https://support.microsoft.com/en-us/office/customize-or-create-new-styles-d38d6e47-f6fc-48eb-a607-1eb120dec563?ns=winword&version=19&syslcid=1033&uilcid=1033&appver=zwd190&helpid=348&ui=en-us&rs=en-us&ad=us)
- ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/014aaebf525d4159bbd14a7e489cfd03.png)

### ä¸‰çº¿è¡¨è®¾è®¡

- ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/7dba1adb32a444f7ad26a55682914163.png)

- åå­—éšæ„å–(å¯ä»¥å«ä¸­æ–‡ä¸‰çº¿è¡¨(æˆ‘ç®€å†™ä¸ºTLT))
- ä¸»è¦æ˜¯Formattingä¸‹çš„`Apply formatting to`
  - Whole table
    - å¯ä»¥è®¾ç½®ä¸‰çº¿è¡¨çš„ç¬¬ä¸€æ¡çº¿å’Œç¬¬ä¸‰æ¡çº¿
    - çº¿æ¡æ ·å¼å¯ä»¥è®¾ç½®çš„ç²—ä¸€äº›
  - Header line
    - å¯ä»¥è®¾ç½®ç¬¬äºŒæ¡çº¿
    - çº¿æ¡æ ·å¼å¯ä»¥æ”¹ç»†ä¸€äº›
- Note:ä¸Šè¿°è®¾ç½®ä¸€éå¯èƒ½ä¸ç¬¦åˆé¢„æœŸ,å¯ä»¥å†è®¾ç½®ä¸€é
  - çº¿æ¡ç²—ç»†å¯èƒ½å’Œç¬¬äºŒæ¡çº¿å¯èƒ½éƒ½è¦è®¾ç½®ä¸¤è¾¹æ‰æœ‰æ•ˆ,åº”è¯¥æ˜¯è½¯ä»¶çš„bug
  - ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/66d26098a7924d4fb3874f7e900e2561.png)

## é¡µé¢è®¾ç½®ï¼ˆpage setup ï¼‰

- [æ›´æ”¹é¡µè¾¹è· - Microsoft æ”¯æŒ](https://support.microsoft.com/zh-cn/office/æ›´æ”¹é¡µè¾¹è·-da21a474-99d8-4e54-b12d-a8a14ea7ce02)

## æ‰¹é‡é€‰ä¸­è¡¨æ ¼ğŸˆ

- ä½¿ç”¨æ’ä»¶:[Quickly select all tables in a Word document (extendoffice.com)](https://www.extendoffice.com/product/kutools-for-word/word-select-all-tables.html)
  - è¯¥æ’ä»¶æ˜¯ä¸€ä¸ªä»˜è´¹æ’ä»¶,ä½†æœ‰è¯•ç”¨æœŸ
- ä½¿ç”¨å®,ä¸‹ä¸€ç« ä»‹ç»
  - [How can I select all tables in a document. (microsoft.com)](https://social.technet.microsoft.com/Forums/ie/en-US/4f0164f7-9379-47c7-ae81-3316d3c6186e/how-can-i-select-all-tables-in-a-document?forum=officeitproprevious)
  - [Microsoft Word: How to edit the properties of multiple tables - Super User](https://superuser.com/questions/1232065/microsoft-word-how-to-edit-the-properties-of-multiple-tables)

### é€‰ä¸­æ‰€æœ‰è¡¨æ ¼

- ç®€æ´ç‰ˆæœ¬

  ```vb
  Sub selecttables()
   Dim mytable As Table
   Application.ScreenUpdating = False
   For Each mytable In ActiveDocument.Tables
   mytable.Range.Editors.Add wdEditorEveryone
   Next
   ActiveDocument.SelectAllEditableRanges (wdEditorEveryone)
   ActiveDocument.DeleteAllEditableRanges (wdEditorEveryone)
   Application.ScreenUpdating = True
  End Sub
  ```

- ä¸‹é¢æ˜¯å¸¦æ³¨é‡Šçš„ç‰ˆæœ¬

  ```vb
  
  ' Subroutine to select all tables in the active document and add editing permission to everyone.
  Sub selecttables()
      ' Declare a variable to hold the current table being processed.
      Dim mytable As Table
  
      ' Disable screen updates to improve performance.
      Application.ScreenUpdating = False
  
      ' Loop through all tables in the document.
      For Each mytable In ActiveDocument.Tables
          ' Add editing permission to everyone for the table.
          mytable.Range.Editors.Add wdEditorEveryone
      Next
  
      ' Select all editable ranges for everyone in the document.
      ActiveDocument.SelectAllEditableRanges (wdEditorEveryone)
  
      ' Delete all editable ranges for everyone in the document.
      ActiveDocument.DeleteAllEditableRanges (wdEditorEveryone)
  
      ' Enable screen updates again.
      Application.ScreenUpdating = True
  End Sub
  ```

#### ä¸´æ—¶è¿è¡Œ

- å°†ä¸Šè¿°ä»£ç ç‰‡æ®µä¹‹ä¸€å¤åˆ¶
- åœ¨wordä¸­æ‰“å¼€vbç¼–è¾‘å™¨(å¿«æ·é”®ä½`alt+F11`)
- æ–°å»ºæ–‡ä»¶,ç²˜è´´å¹¶ç‚¹å‡»vbç¼–è¾‘å™¨ä¸Šçš„è¿è¡ŒæŒ‰é’®

#### ç¼–è¾‘å·²æœ‰çš„å®

- å¯ä»¥æ ¹æ®æŒ‡å¼•`alt+F8`åˆ›å»ºä¸€ä¸ªå®,æˆ–è€…ç¼–è¾‘å·²æœ‰çš„å®,æ³¨æ„è¿‡æ»¤åŠŸèƒ½(`Macros in`)

  - ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/e8e355101194411a85b53df454a810bb.png)

    

## å½•åˆ¶æ“ä½œå®ğŸˆ

- [Create or run a macro - Microsoft Support](https://support.microsoft.com/en-us/office/create-or-run-a-macro-c6b99036-905c-49a6-818a-dfb98b7c3c9c)

- [åˆ›å»ºæˆ–è¿è¡Œå® - Microsoft æ”¯æŒ](https://support.microsoft.com/zh-cn/office/åˆ›å»ºæˆ–è¿è¡Œå®-c6b99036-905c-49a6-818a-dfb98b7c3c9c)



#  å…³äºVBAå®

- [Word | Microsoft Learn](https://learn.microsoft.com/en-us/office/client-developer/word/word-home?redirectedfrom=MSDN)

- [Office Visual Basic for Applications (VBA) å‚è€ƒ | Microsoft Learn](https://learn.microsoft.com/zh-cn/office/vba/api/overview/)

- [Office VBA å…¥é—¨ | Microsoft Docs](https://docs.microsoft.com/zh-cn/office/vba/library-reference/concepts/getting-started-with-vba-in-office)

## VBA å’Œ VB

Visual Basic (VB) å’Œ Visual Basic for Applications (VBA) éƒ½æ˜¯ç”± Microsoft å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ã€‚å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å¦‚ä¸‹ï¼š

1. ç›®æ ‡åº”ç”¨ç¨‹åºï¼šVB æ˜¯ä¸€ç§ç‹¬ç«‹çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¯ä»¥ç”¨äºå¼€å‘ Windows åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬æ¡Œé¢åº”ç”¨ç¨‹åºã€Web åº”ç”¨ç¨‹åºå’Œç§»åŠ¨åº”ç”¨ç¨‹åºã€‚VBA æ˜¯ä¸€ç§å®è¯­è¨€ï¼Œä¸“é—¨ç”¨äºè‡ªåŠ¨åŒ– Microsoft Office åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Excelã€Wordã€PowerPoint ç­‰ã€‚
2. å¼€å‘å¹³å°ï¼šVB å¯ä»¥ä½¿ç”¨ Microsoft Visual Studio å’Œå…¶ä»–é›†æˆå¼€å‘ç¯å¢ƒ (IDE) è¿›è¡Œå¼€å‘ã€‚VBA åªèƒ½åœ¨ Microsoft Office åº”ç”¨ç¨‹åºå†…éƒ¨ä½¿ç”¨ã€‚
3. è¯­è¨€ç‰¹æ€§ï¼šVB å…·æœ‰æ›´å¤æ‚çš„è¯­æ³•å’Œæ›´å¤šçš„ç¼–ç¨‹ç‰¹æ€§ï¼Œä¾‹å¦‚å¤šçº¿ç¨‹æ”¯æŒã€é¢å‘å¯¹è±¡ç¼–ç¨‹ç­‰ã€‚VBA çš„è¯­æ³•æ›´ä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºå¤„ç† Office æ–‡æ¡£å’Œè‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚
4. åº”ç”¨åœºæ™¯ï¼šVB é€‚ç”¨äºéœ€è¦å¼€å‘ç‹¬ç«‹çš„åº”ç”¨ç¨‹åºçš„æƒ…å†µï¼Œä¾‹å¦‚å¼€å‘æ¡Œé¢è½¯ä»¶ã€Web åº”ç”¨ç¨‹åºæˆ–ç§»åŠ¨åº”ç”¨ç¨‹åºã€‚VBA é€‚ç”¨äºè‡ªåŠ¨åŒ–å¤„ç† Microsoft Office åº”ç”¨ç¨‹åºçš„æƒ…å†µï¼Œä¾‹å¦‚è‡ªåŠ¨æ‰§è¡Œé‡å¤æ€§ä»»åŠ¡ã€è‡ªå®šä¹‰ Office åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ç­‰ã€‚

æ€»çš„æ¥è¯´ï¼ŒVB å’Œ VBA éƒ½æ˜¯ç”± Microsoft å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒä»¬çš„åº”ç”¨åœºæ™¯å’Œç›®æ ‡åº”ç”¨ç¨‹åºä¸åŒã€‚VB é€‚ç”¨äºç‹¬ç«‹åº”ç”¨ç¨‹åºçš„å¼€å‘ï¼Œè€Œ VBA é€‚ç”¨äºè‡ªåŠ¨åŒ–å¤„ç† Microsoft Office åº”ç”¨ç¨‹åºçš„åœºæ™¯ã€‚

## VBA

### ä½¿ç”¨ä»£ç è®©åº”ç”¨ç¨‹åºå®Œæˆä»»åŠ¡

### Using code to make applications do things

You might think that writing code is mysterious or difficult, but the basic principles use every-day reasoning and are quite accessible. Microsoft Office applications are created in such a way that they expose things called objects that can receive instructions, in much the same way that a phone is designed with buttons that you use to interact with the phone.

 When you press a button, the phone recognizes the instruction and includes the corresponding number in the sequence that you are dialing. 

In programming, you interact with the application by sending instructions to various objects in the application. These objects are expansive, but they have their limits. They can only do what they are designed to do, and they will only do what you instruct them to do.

For example, consider the user who opens a document in Word, makes a few changes, saves the document, and then closes it. In the world of VBA programming, Word exposes a Document object. By using VBA code, you can instruct the Document object to do things such as Open, Save, or Close.

The following section discusses how objects are organized and described.

æ‚¨å¯èƒ½è®¤ä¸ºç¼–å†™ä»£ç æ˜¯ç¥ç§˜æˆ–å›°éš¾çš„ï¼Œä½†åŸºæœ¬åŸç†ä½¿ç”¨æ—¥å¸¸æ¨ç†ï¼Œç›¸å½“å®¹æ˜“ç†è§£ã€‚Microsoft Officeåº”ç”¨ç¨‹åºè¢«åˆ›å»ºæˆä¸€ç§æ–¹å¼ï¼Œå®ƒä»¬å…¬å¼€äº†è¢«ç§°ä¸ºå¯¹è±¡çš„ä¸œè¥¿ï¼Œå¯ä»¥æ¥æ”¶æŒ‡ä»¤ï¼Œå°±åƒæ‰‹æœºè®¾è®¡æœ‰æŒ‰é’®ï¼Œæ‚¨ç”¨å®ƒä»¬ä¸æ‰‹æœºäº¤äº’ä¸€æ ·ã€‚å½“æ‚¨æŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œæ‰‹æœºä¼šè¯†åˆ«æŒ‡ä»¤ï¼Œå¹¶åœ¨æ‚¨æ‹¨å·åºåˆ—ä¸­åŒ…å«ç›¸åº”çš„å·ç ã€‚

åœ¨ç¼–ç¨‹ä¸­ï¼Œæ‚¨é€šè¿‡å‘åº”ç”¨ç¨‹åºä¸­çš„å„ç§å¯¹è±¡å‘é€æŒ‡ä»¤æ¥ä¸åº”ç”¨ç¨‹åºäº¤äº’ã€‚è¿™äº›å¯¹è±¡å¾ˆå¹¿æ³›ï¼Œä½†å®ƒä»¬æœ‰å…¶é™åˆ¶ã€‚å®ƒä»¬åªèƒ½åšå®ƒä»¬è¢«è®¾è®¡ä¸ºåšçš„äº‹æƒ…ï¼Œå¹¶ä¸”åªä¼šåšæ‚¨æŒ‡ç¤ºå®ƒä»¬åšçš„äº‹æƒ…ã€‚

ä¾‹å¦‚ï¼Œè€ƒè™‘ç”¨æˆ·åœ¨Wordä¸­æ‰“å¼€æ–‡æ¡£ï¼Œè¿›è¡Œäº†ä¸€äº›æ›´æ”¹ï¼Œä¿å­˜äº†æ–‡æ¡£ï¼Œç„¶åå…³é—­äº†æ–‡æ¡£ã€‚åœ¨VBAç¼–ç¨‹çš„ä¸–ç•Œä¸­ï¼ŒWordå…¬å¼€äº†ä¸€ä¸ªDocumentå¯¹è±¡ã€‚é€šè¿‡ä½¿ç”¨VBAä»£ç ï¼Œæ‚¨å¯ä»¥æŒ‡ç¤ºDocumentå¯¹è±¡æ‰§è¡Œè¯¸å¦‚æ‰“å¼€ã€ä¿å­˜æˆ–å…³é—­ç­‰æ“ä½œã€‚

ä¸‹é¢çš„éƒ¨åˆ†è®¨è®ºäº†å¯¹è±¡å¦‚ä½•ç»„ç»‡å’Œæè¿°ã€‚

### The Object Model

Developers organize programming objects in a hierarchy, and that hierarchy is called <u>the object model of the application</u>. Word, for example, has <u>a top-level **Application** object</u> that contains <u>a **Document** object</u>. 

The Document object contains **Paragraph** objects and so on. 

Object models roughly mirror what you see in the user interface. They are a conceptual map of the application and its capabilities.

The **definition** of an object is called a **class**, so you might see these two terms used **<u>interchangeably</u>**. 

Technically, a **class** is the description or template that is used to create, or instantiate, an **object**.

Once an object exists, you can <u>manipulate</u> it by setting its properties and calling its methods. 

If you think of the object as a noun, the **properties** are the adjectives that describe the noun and the **methods** are the verbs that animate the noun. 

Changing a **property** changes some **quality** of appearance or behavior of the **object**. Calling one of the object methods causes the object to perform some action.

The VBA code in this article runs against <u>an open Office application</u> where many of the **objects** that the code manipulates are already <u>up and running</u>; 

- for example, the Application itself, the Worksheet in Excel, the Document in Word, the Presentation in PowerPoint, the Explorer and Folder objects in Outlook. 
- Once you know the basic layout of the object model and some key properties of the Application that give access to its current **state**, you can start to extend and manipulate that Office application with VBA in Office.

å¼€å‘äººå‘˜å°†ç¼–ç¨‹å¯¹è±¡ç»„ç»‡æˆå±‚æ¬¡ç»“æ„ï¼Œè¿™ä¸ªå±‚æ¬¡ç»“æ„ç§°ä¸ºåº”ç”¨ç¨‹åºçš„å¯¹è±¡æ¨¡å‹ã€‚ä¾‹å¦‚ï¼ŒWordæœ‰ä¸€ä¸ªé¡¶çº§çš„Applicationå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªDocumentå¯¹è±¡ã€‚Documentå¯¹è±¡åŒ…å«Paragraphå¯¹è±¡ç­‰ã€‚å¯¹è±¡æ¨¡å‹å¤§è‡´åæ˜ äº†æ‚¨åœ¨ç”¨æˆ·ç•Œé¢ä¸­çœ‹åˆ°çš„å†…å®¹ã€‚å®ƒä»¬æ˜¯åº”ç”¨ç¨‹åºåŠå…¶åŠŸèƒ½çš„æ¦‚å¿µåœ°å›¾ã€‚

å¯¹è±¡çš„å®šä¹‰ç§°ä¸ºç±»ï¼Œå› æ­¤æ‚¨å¯èƒ½ä¼šçœ‹åˆ°è¿™ä¸¤ä¸ªæœ¯è¯­äº¤æ›¿ä½¿ç”¨ã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼Œç±»æ˜¯ç”¨äºåˆ›å»ºæˆ–å®ä¾‹åŒ–å¯¹è±¡çš„æè¿°æˆ–æ¨¡æ¿ã€‚

ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡å­˜åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡è®¾ç½®å…¶å±æ€§å’Œè°ƒç”¨å…¶æ–¹æ³•æ¥æ“çºµå®ƒã€‚å¦‚æœæ‚¨å°†å¯¹è±¡çœ‹ä½œæ˜¯åè¯ï¼Œåˆ™å±æ€§æ˜¯æè¿°åè¯çš„å½¢å®¹è¯ï¼Œæ–¹æ³•æ˜¯ä½¿åè¯æ´»è·ƒçš„åŠ¨è¯ã€‚æ›´æ”¹å±æ€§ä¼šæ›´æ”¹å¯¹è±¡çš„æŸäº›å¤–è§‚æˆ–è¡Œä¸ºè´¨é‡ã€‚è°ƒç”¨å¯¹è±¡çš„å…¶ä¸­ä¸€ä¸ªæ–¹æ³•ä¼šå¯¼è‡´å¯¹è±¡æ‰§è¡ŒæŸäº›æ“ä½œã€‚

æœ¬æ–‡ä¸­çš„VBAä»£ç é’ˆå¯¹å·²æ‰“å¼€çš„Officeåº”ç”¨ç¨‹åºè¿è¡Œï¼Œä»£ç æ“çºµçš„è®¸å¤šå¯¹è±¡å·²ç»å¯åŠ¨è¿è¡Œï¼›ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºæœ¬èº«ï¼Œåœ¨Excelä¸­çš„Worksheetï¼Œåœ¨Wordä¸­çš„Documentï¼Œåœ¨PowerPointä¸­çš„Presentationï¼Œåœ¨Outlookä¸­çš„Explorerå’ŒFolderå¯¹è±¡ã€‚ä¸€æ—¦æ‚¨äº†è§£äº†å¯¹è±¡æ¨¡å‹çš„åŸºæœ¬å¸ƒå±€å’Œè®¿é—®å…¶å½“å‰çŠ¶æ€çš„ä¸€äº›å…³é”®å±æ€§ï¼Œæ‚¨å°±å¯ä»¥å¼€å§‹ä½¿ç”¨Officeä¸­çš„VBAæ‰©å±•å’Œæ“çºµè¯¥åº”ç”¨ç¨‹åºã€‚

### Methods

- In Word, for example, you can change the properties and invoke the methods of the current Word document by using the **ActiveDocument** property of the **Application** object. 
- This **ActiveDocument** property returns a reference to the **Document** object that is currently active in the Word application. "Returns a reference to" means "gives you access to."

- The following code does exactly what it says; that is, it saves the active document in the application.



```vb
Application.ActiveDocument.Save
```

- Read the code from left to right, "In this Application, with the Document referenced by ActiveDocument, invoke the **Save** method." Be aware that **Save** is the simplest form of method; it does not require any detailed instructions from you. You instruct a **Document** object to **Save** and it does not require any more input from you.

- If a method requires more **information**, those details are called **parameters**. The following code runs the **SaveAs** method, which requires a new name for the file.

VB

```vb
Application.ActiveDocument.SaveAs ("New Document Name.docx")
```

Values listed in parentheses after a method name are the parameters. Here, the new name for the file is a parameter for the **SaveAs** method.

### Properties

You use the same syntax to set a property that you use to read a property. The following code executes a method to select cell A1 in Excel and then to set a property to put something in that cell.æ‚¨ä½¿ç”¨ç›¸åŒçš„è¯­æ³•æ¥è®¾ç½®å±æ€§ï¼Œå°±åƒè¯»å–å±æ€§ä¸€æ ·ã€‚ä»¥ä¸‹ä»£ç æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨Excelä¸­é€‰æ‹©å•å…ƒæ ¼A1ï¼Œç„¶åè®¾ç½®ä¸€ä¸ªå±æ€§ï¼Œå°†æŸäº›å†…å®¹æ”¾å…¥è¯¥å•å…ƒæ ¼ã€‚

- ```vb
      Application.ActiveSheet.Range("A1").Select
      Application.Selection.Value = "Hello World"
  ```

- The first **challenge** in VBA programming is to **get a feeling** for the object model of each Office application and to read the object, method, and property syntax. 
- The object models are similar in all Office applications, but each is specific to the kind of documents and objects that it manipulates.

- In the first line of the code snippet, there is the **Application** object, Excel this time, and then the **ActiveSheet**, which provides access to the active worksheet.
- After that is a term not as familiar, `Range`, which means "define a range of cells in this way." The code instructs **Range** to create itself with just A1 as its defined set of cells. 
- In other words, the first line of code defines an object, the Range, and runs a method against it to select it.
- The result is automatically stored in another **property** of the **Application** called **Selection**.
  - The second line of code sets the **Value** property of **Selection** to the text "Hello World", and that value appears in cell A1.

The simplest VBA code that you write might simply gain access to objects in the Office application that you are working with and set properties. For example, you could get access to the rows in a table in Word and change their formatting in your VBA script.

That sounds simple, but it can be incredibly useful; once you can write that code, you can **harness** (åˆ©ç”¨)all of the power of programming to make those same changes in several tables or documents, or make them according to some logic or condition. 

For a computer, making 1000 changes is no different from making 10, so there is an **economy of scale** here with larger documents and problems, and that is where VBA can really shine and save you time.

VBAç¼–ç¨‹çš„ç¬¬ä¸€ä¸ªæŒ‘æˆ˜æ˜¯ç†Ÿæ‚‰æ¯ä¸ªOfficeåº”ç”¨ç¨‹åºçš„å¯¹è±¡æ¨¡å‹ï¼Œå¹¶é˜…è¯»å¯¹è±¡ã€æ–¹æ³•å’Œå±æ€§è¯­æ³•ã€‚å¯¹è±¡æ¨¡å‹åœ¨æ‰€æœ‰Officeåº”ç”¨ç¨‹åºä¸­éƒ½å¾ˆç›¸ä¼¼ï¼Œä½†æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½é’ˆå¯¹å…¶æ“ä½œçš„æ–‡æ¡£å’Œå¯¹è±¡ç±»å‹è€Œç‰¹å®šã€‚

åœ¨ä»£ç ç‰‡æ®µçš„ç¬¬ä¸€è¡Œä¸­ï¼Œæœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯¹è±¡ï¼Œè¿™æ¬¡æ˜¯Excelï¼Œç„¶åæ˜¯ActiveSheetï¼Œå®ƒæä¾›å¯¹æ´»åŠ¨å·¥ä½œè¡¨çš„è®¿é—®ã€‚ä¹‹åæ˜¯ä¸€ä¸ªä¸å¤ªç†Ÿæ‚‰çš„æœ¯è¯­Rangeï¼Œå®ƒçš„æ„æ€æ˜¯â€œä»¥è¿™ç§æ–¹å¼å®šä¹‰ä¸€ç»„å•å…ƒæ ¼â€ã€‚ä»£ç æŒ‡ç¤ºRangeä½¿ç”¨åªæœ‰A1ä½œä¸ºå…¶å®šä¹‰çš„å•å…ƒæ ¼é›†çš„æ–¹å¼æ¥åˆ›å»ºè‡ªå·±ã€‚æ¢å¥è¯è¯´ï¼Œä»£ç çš„ç¬¬ä¸€è¡Œå®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå³Rangeï¼Œå¹¶å¯¹å…¶è¿è¡Œä¸€ä¸ªæ–¹æ³•æ¥é€‰æ‹©å®ƒã€‚ç»“æœè‡ªåŠ¨å­˜å‚¨åœ¨Applicationçš„å¦ä¸€ä¸ªå±æ€§Selectionä¸­ã€‚

ç¬¬äºŒè¡Œä»£ç å°†Selectionçš„Valueå±æ€§è®¾ç½®ä¸ºæ–‡æœ¬â€œHello Worldâ€ï¼Œå¹¶å°†è¯¥å€¼æ˜¾ç¤ºåœ¨å•å…ƒæ ¼A1ä¸­ã€‚

æ‚¨ç¼–å†™çš„æœ€ç®€å•çš„VBAä»£ç å¯èƒ½ä»…ä»…æ˜¯è®¿é—®æ­£åœ¨ä½¿ç”¨çš„Officeåº”ç”¨ç¨‹åºä¸­çš„å¯¹è±¡å¹¶è®¾ç½®å±æ€§ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥è·å–Wordè¡¨æ ¼ä¸­çš„è¡Œå¹¶åœ¨VBAè„šæœ¬ä¸­æ›´æ”¹å®ƒä»¬çš„æ ¼å¼ã€‚

å¬èµ·æ¥ç®€å•ï¼Œä½†å®ƒéå¸¸æœ‰ç”¨ï¼›ä¸€æ—¦æ‚¨èƒ½å¤Ÿç¼–å†™è¯¥ä»£ç ï¼Œæ‚¨å°±å¯ä»¥åˆ©ç”¨ç¼–ç¨‹çš„å…¨éƒ¨åŠ›é‡ï¼Œåœ¨å‡ ä¸ªè¡¨æ ¼æˆ–æ–‡æ¡£ä¸­è¿›è¡Œç›¸åŒçš„æ›´æ”¹ï¼Œæˆ–æ ¹æ®æŸäº›é€»è¾‘æˆ–æ¡ä»¶è¿›è¡Œæ›´æ”¹ã€‚å¯¹äºè®¡ç®—æœºæ¥è¯´ï¼Œè¿›è¡Œ1000æ¬¡æ›´æ”¹ä¸è¿›è¡Œ10æ¬¡æ›´æ”¹æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œå› æ­¤å¯¹äºæ›´å¤§çš„æ–‡æ¡£å’Œé—®é¢˜ï¼Œå­˜åœ¨ä¸€ç§è§„æ¨¡ç»æµï¼Œè¿™å°±æ˜¯VBAçœŸæ­£å‘æŒ¥ä½œç”¨å¹¶èŠ‚çœæ‚¨çš„æ—¶é—´çš„åœ°æ–¹ã€‚

## Macros and the Visual Basic Editor

- Now that you know something about how Office applications expose their object models, you are probably eager to try calling object methods, setting object properties, and responding to object events. 
- To do so, you must write your code in a place and in a way that Office can understand; typically, by using the Visual Basic Editor. 
- Although it is installed by default, many users don't know that it is even available until it is enabled on the ribbon.

- All Office applications use the ribbon. One tab on the ribbon is the **Developer** tab, where you access the Visual Basic Editor and other developer tools. Because Office does not display the **Developer** tab by default, you must enable it by using the following procedure:

ç°åœ¨æ‚¨å·²ç»äº†è§£Officeåº”ç”¨ç¨‹åºå¦‚ä½•å…¬å¼€å…¶å¯¹è±¡æ¨¡å‹ï¼Œæ‚¨å¯èƒ½æ¸´æœ›å°è¯•è°ƒç”¨å¯¹è±¡æ–¹æ³•ã€è®¾ç½®å¯¹è±¡å±æ€§å’Œå“åº”å¯¹è±¡äº‹ä»¶ã€‚è¦è¿™æ ·åšï¼Œæ‚¨å¿…é¡»ä»¥Officeå¯ä»¥ç†è§£çš„æ–¹å¼å’Œä½ç½®ç¼–å†™æ‚¨çš„ä»£ç ï¼›é€šå¸¸é€šè¿‡ä½¿ç”¨Visual Basic Editorã€‚è™½ç„¶å®ƒæ˜¯é»˜è®¤å®‰è£…çš„ï¼Œä½†è®¸å¤šç”¨æˆ·åœ¨å¯ç”¨äº†è¯¥åŠŸèƒ½ä¹‹å‰ç”šè‡³ä¸çŸ¥é“å®ƒçš„å­˜åœ¨ã€‚

æ‰€æœ‰Officeåº”ç”¨ç¨‹åºéƒ½ä½¿ç”¨åŠŸèƒ½åŒºã€‚åŠŸèƒ½åŒºä¸Šçš„ä¸€ä¸ªé€‰é¡¹å¡æ˜¯â€œå¼€å‘äººå‘˜â€é€‰é¡¹å¡ï¼Œåœ¨å…¶ä¸­å¯ä»¥è®¿é—®Visual Basic Editorå’Œå…¶ä»–å¼€å‘äººå‘˜å·¥å…·ã€‚å› ä¸ºOfficeé»˜è®¤æƒ…å†µä¸‹ä¸æ˜¾ç¤ºâ€œå¼€å‘äººå‘˜â€é€‰é¡¹å¡ï¼Œæ‰€ä»¥æ‚¨å¿…é¡»é€šè¿‡ä»¥ä¸‹æ­¥éª¤å¯ç”¨å®ƒï¼š



### To enable the Developer tabğŸˆ

- On the **File** tab, choose **Options** to open the **Options** dialog box.

  1. Choose **Customize Ribbon** on the left side of the dialog box.
  2. Under **Choose commands from** on the left side of the dialog box, select **Popular Commands**.
  3. Under **Customize the Ribbon** on the right side of the dialog box, select **Main Tabs** in the drop down list box, and then select the **Developer** checkbox.
  4. Choose **OK**.

- |                                                              |                                        |      |
  | ------------------------------------------------------------ | -------------------------------------- | ---- |
  | ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/2efc4c801bf348eaa83b245a6e06df47.png) | è‹±æ–‡ç‰ˆç•Œé¢æ“ä½œç¤ºæ„å›¾ï¼Œå¯ç”¨å¼€å‘è€…é€‰é¡¹å¡ |      |

  

- å¯ç”¨â€œå¼€å‘äººå‘˜â€é€‰é¡¹å¡

  - åœ¨â€œæ–‡ä»¶â€é€‰é¡¹å¡ä¸Šï¼Œé€‰æ‹©â€œé€‰é¡¹â€ä»¥æ‰“å¼€â€œé€‰é¡¹â€å¯¹è¯æ¡†ã€‚
  - åœ¨å¯¹è¯æ¡†çš„å·¦ä¾§ï¼Œé€‰æ‹©â€œè‡ªå®šä¹‰åŠŸèƒ½åŒºâ€ã€‚
  - åœ¨å¯¹è¯æ¡†çš„å·¦ä¾§ï¼Œâ€œä»é€‰æ‹©å‘½ä»¤â€ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©â€œå¸¸ç”¨å‘½ä»¤â€ã€‚
  - åœ¨å¯¹è¯æ¡†çš„å³ä¾§â€œè‡ªå®šä¹‰åŠŸèƒ½åŒºâ€ä¸­ï¼Œé€‰æ‹©ä¸‹æ‹‰åˆ—è¡¨æ¡†ä¸­çš„â€œä¸»é€‰é¡¹å¡â€ï¼Œç„¶åé€‰æ‹©â€œå¼€å‘äººå‘˜â€å¤é€‰æ¡†ã€‚
  - é€‰æ‹©â€œç¡®å®šâ€ã€‚

### Security issues

- To protect Office users against viruses and dangerous macro code, you cannot save macro code in a standard Office document that uses a standard file extension. 

- Instead, you must save the code in a file with **a special extension**.

-  For example you cannot save macros in a standard Word document with a .docx extension;

-  instead, you must use a special Word Macro-Enabled Document with a **.docm** extension.

- å®‰å…¨é—®é¢˜
  ä¸ºäº†ä¿æŠ¤Officeç”¨æˆ·å…å—ç—…æ¯’å’Œå±é™©çš„å®ä»£ç çš„å½±å“ï¼Œæ‚¨ä¸èƒ½å°†å®ä»£ç ä¿å­˜åœ¨ä½¿ç”¨æ ‡å‡†æ–‡ä»¶æ‰©å±•åçš„æ ‡å‡†Officeæ–‡æ¡£ä¸­ã€‚ç›¸åï¼Œæ‚¨å¿…é¡»å°†ä»£ç ä¿å­˜åœ¨å…·æœ‰ç‰¹æ®Šæ‰©å±•åçš„æ–‡ä»¶ä¸­ã€‚ä¾‹å¦‚ï¼Œæ‚¨ä¸èƒ½ä½¿ç”¨ .docx æ‰©å±•ååœ¨æ ‡å‡†Wordæ–‡æ¡£ä¸­ä¿å­˜å®ï¼›ç›¸åï¼Œæ‚¨å¿…é¡»ä½¿ç”¨å…·æœ‰ .docm æ‰©å±•åçš„ç‰¹æ®Šçš„å¯ç”¨å®çš„Wordæ–‡æ¡£ã€‚

  

### docmå®æ–‡ä»¶

- `document-macro` file

When you open a .docm file, Office security might still prevent the macros in the document from running, with or without telling you. Examine the settings and options in the Trust Center on all Office applications. 

The default setting disables macro from running, but warns you that macros have been disabled and gives you the option to turn them back on for that document.

You can designate specific folders where macros can run by creating Trusted Locations, Trusted Documents, or Trusted Publishers. The most portable option is to use Trusted Publishers, which works with digitally signed documents that you distribute. 

For more information about the security settings in a particular Office application, open the **Options** dialog box, choose **Trust Center**, and then choose **Trust Center Settings**.

 å½“æ‚¨æ‰“å¼€ä¸€ä¸ª .docm æ–‡ä»¶æ—¶ï¼ŒOfficeå®‰å…¨è®¾ç½®å¯èƒ½ä»ä¼šé˜»æ­¢æ–‡æ¡£ä¸­çš„å®è¿è¡Œï¼Œå¹¶å¯èƒ½ä¸å‘Šè¯‰æ‚¨ã€‚æ£€æŸ¥æ‰€æœ‰Officeåº”ç”¨ç¨‹åºä¸­çš„ä¿¡ä»»ä¸­å¿ƒçš„è®¾ç½®å’Œé€‰é¡¹ã€‚é»˜è®¤è®¾ç½®ç¦æ­¢è¿è¡Œå®ï¼Œä½†ä¼šè­¦å‘Šæ‚¨å·²ç¦ç”¨å®ï¼Œå¹¶ä¸ºè¯¥æ–‡æ¡£æä¾›é‡æ–°å¯ç”¨å®çš„é€‰é¡¹ã€‚

æ‚¨å¯ä»¥é€šè¿‡åˆ›å»ºå—ä¿¡ä»»çš„ä½ç½®ã€å—ä¿¡ä»»çš„æ–‡æ¡£æˆ–å—ä¿¡ä»»çš„å‘å¸ƒè€…æ¥æŒ‡å®šå¯ä»¥è¿è¡Œå®çš„ç‰¹å®šæ–‡ä»¶å¤¹ã€‚æœ€ä¾¿æºçš„é€‰é¡¹æ˜¯ä½¿ç”¨å—ä¿¡ä»»çš„å‘å¸ƒè€…ï¼Œå®ƒé€‚ç”¨äºæ‚¨åˆ†å‘çš„æ•°å­—ç­¾åæ–‡æ¡£ã€‚

æœ‰å…³ç‰¹å®šOfficeåº”ç”¨ç¨‹åºä¸­çš„å®‰å…¨è®¾ç½®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æ‰“å¼€â€œé€‰é¡¹â€å¯¹è¯æ¡†ï¼Œé€‰æ‹©â€œä¿¡ä»»ä¸­å¿ƒâ€ï¼Œç„¶åé€‰æ‹©â€œä¿¡ä»»ä¸­å¿ƒè®¾ç½®â€ã€‚

Some Office applications, like Outlook, <u>save macros by default in a master template on your local computer.</u> Although that strategy reduces the local security issues on your own computer when you run your own macros, it requires a deployment strategy if you want to distribute your macro.

ä¸€äº›Officeåº”ç”¨ç¨‹åºï¼Œå¦‚Outlookï¼Œé»˜è®¤æƒ…å†µä¸‹å°†å®ä¿å­˜åœ¨æ‚¨æœ¬åœ°è®¡ç®—æœºä¸Šçš„ä¸»æ¨¡æ¿ä¸­ã€‚è™½ç„¶è¿™ç§ç­–ç•¥åœ¨æ‚¨è¿è¡Œè‡ªå·±çš„å®æ—¶å‡å°‘äº†æœ¬åœ°å®‰å…¨é—®é¢˜ï¼Œä½†å¦‚æœæ‚¨æƒ³åˆ†å‘æ‚¨çš„å®ï¼Œåˆ™éœ€è¦éƒ¨ç½²ç­–ç•¥ã€‚

### Recording a macro

- When you choose the **Macro** button on the **Developer** tab, it opens the **Macros** dialog box, which gives you access to VBA subroutines or macros that you can access from a particular document or application. The **Visual Basic** button opens the Visual Basic Editor, where you create and edit VBA code.

- Another button on the **Developer** tab in Word and Excel is the **Record Macro** button, which automatically generates VBA code that can reproduce the actions that you perform in the application. **Record Macro** is a <span style="color:red">terrific(æå¥½çš„ï¼‰</span> tool that you can use to learn more about VBA. 

- Reading the generated code can give you insight into VBA and provide a stable bridge between your knowledge of Office as a user and your knowledge as a programmer. The only **caveat** is that the generated code can be confusing because the Macro editor must make some assumptions about your intentions, and those assumptions are not necessarily accurate.

- å½“æ‚¨åœ¨â€œå¼€å‘äººå‘˜â€é€‰é¡¹å¡ä¸Šé€‰æ‹©â€œå®â€æŒ‰é’®æ—¶ï¼Œå®ƒä¼šæ‰“å¼€â€œå®â€å¯¹è¯æ¡†æ¡†ï¼Œè®©æ‚¨è®¿é—®å¯ä»¥ä»ç‰¹å®šæ–‡æ¡£æˆ–åº”ç”¨ç¨‹åºä¸­è®¿é—®çš„VBAå­ä¾‹ç¨‹æˆ–å®ã€‚Visual Basic æŒ‰é’®æ‰“å¼€äº†Visual Basic Editorï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­åˆ›å»ºå’Œç¼–è¾‘VBAä»£ç ã€‚

  Word å’Œ Excel ä¸­â€œå¼€å‘äººå‘˜â€é€‰é¡¹å¡ä¸Šçš„å¦ä¸€ä¸ªæŒ‰é’®æ˜¯â€œå½•åˆ¶å®â€æŒ‰é’®ï¼Œå®ƒä¼šè‡ªåŠ¨ç”Ÿæˆå¯ä»¥å¤åˆ¶æ‚¨åœ¨åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œçš„æ“ä½œçš„ VBA ä»£ç ã€‚å½•åˆ¶å®æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„å·¥å…·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥äº†è§£æ›´å¤šå…³äºVBAçš„çŸ¥è¯†ã€‚é˜…è¯»ç”Ÿæˆçš„ä»£ç å¯ä»¥è®©æ‚¨äº†è§£VBAï¼Œå¹¶æä¾›ä¸€ä¸ªç¨³å®šçš„æ¡¥æ¢ï¼Œå°†æ‚¨ä½œä¸ºç”¨æˆ·å¯¹Officeçš„äº†è§£å’Œä½œä¸ºç¨‹åºå‘˜çš„çŸ¥è¯†è”ç³»èµ·æ¥ã€‚å”¯ä¸€çš„æ³¨æ„äº‹é¡¹æ˜¯ç”Ÿæˆçš„ä»£ç å¯èƒ½ä¼šä»¤äººå›°æƒ‘ï¼Œå› ä¸ºå®ç¼–è¾‘å™¨å¿…é¡»å¯¹æ‚¨çš„æ„å›¾ä½œå‡ºä¸€äº›å‡è®¾ï¼Œè€Œè¿™äº›å‡è®¾ä¸ä¸€å®šå‡†ç¡®ã€‚

#### To record a macro

1. Open `Excel` to a new Workbook and choose the **Developer** tab in the ribbon. Choose **Record Macro** and accept all of the default settings in the **Record Macro** dialog box, including **Macro1** as the name of the macro and **This Workbook** as the location.

2. Choose **OK** to begin recording the macro. Note how the button text changes to **Stop Recording**. Choose that button the instant you complete the actions that you want to record.

3. Choose cell B1 and type the programmer's classic first string: `Hello World`. Stop typing and look at the **Stop Recording** button; it is grayed out because Excel is waiting for you to finish typing the value in the cell.

4. Choose cell B2 to complete the action in cell B1, and then choose **Stop Recording**.

5. Choose **Macros** on the **Developer** tab, select **Macro1** if it is not selected, and then choose **Edit** to view the code from Macro1 in the Visual Basic Editor.

   - ```vb
     Sub Macro1()
     '
     ' Macro1 Macro
     '
     
     '
         Range("B1").Select
         ActiveCell.FormulaR1C1 = "hellow world"
         Range("B2").Select
     End Sub
     
     ```

     

1. æ‰“å¼€ Excel å¹¶æ–°å»ºä¸€ä¸ªå·¥ä½œç°¿ï¼Œåœ¨åŠŸèƒ½åŒºä¸­é€‰æ‹©â€œå¼€å‘äººå‘˜â€é€‰é¡¹å¡ã€‚é€‰æ‹©â€œå½•åˆ¶å®â€ï¼Œå¹¶åœ¨â€œå½•åˆ¶å®â€å¯¹è¯æ¡†ä¸­æ¥å—æ‰€æœ‰é»˜è®¤è®¾ç½®ï¼ŒåŒ…æ‹¬ä½¿ç”¨â€œMacro1â€ä½œä¸ºå®çš„åç§°ï¼Œå¹¶å°†å…¶ä½ç½®è®¾ç½®ä¸ºâ€œæ­¤å·¥ä½œç°¿â€ã€‚
2. é€‰æ‹©â€œç¡®å®šâ€å¼€å§‹å½•åˆ¶å®ã€‚è¯·æ³¨æ„æŒ‰é’®æ–‡æœ¬å¦‚ä½•æ›´æ”¹ä¸ºâ€œåœæ­¢å½•åˆ¶â€ã€‚åœ¨æ‚¨å®Œæˆè¦è®°å½•çš„æ“ä½œåç«‹å³é€‰æ‹©è¯¥æŒ‰é’®ã€‚
3. é€‰æ‹©å•å…ƒæ ¼ B1 å¹¶è¾“å…¥ç¨‹åºå‘˜çš„ç»å…¸é¦–ä¸ªå­—ç¬¦ä¸²ï¼šâ€œHello Worldâ€ã€‚åœæ­¢è¾“å…¥å¹¶æŸ¥çœ‹â€œåœæ­¢å½•åˆ¶â€æŒ‰é’®ï¼›å®ƒè¢«ç¦ç”¨ï¼Œå› ä¸ºExcelæ­£åœ¨ç­‰å¾…æ‚¨å®Œæˆå•å…ƒæ ¼ä¸­çš„å€¼çš„è¾“å…¥ã€‚
4. é€‰æ‹©å•å…ƒæ ¼ B2 å®Œæˆ B1 ä¸­çš„æ“ä½œï¼Œç„¶åé€‰æ‹©â€œåœæ­¢å½•åˆ¶â€ã€‚
5. åœ¨â€œå¼€å‘äººå‘˜â€é€‰é¡¹å¡ä¸Šé€‰æ‹©â€œå®â€ï¼Œå¦‚æœæœªé€‰æ‹©â€œMacro1â€ï¼Œåˆ™é€‰æ‹©å®ƒï¼Œç„¶åé€‰æ‹©â€œç¼–è¾‘â€ä»¥åœ¨Visual Basic Editorä¸­æŸ¥çœ‹ Macro1 çš„ä»£ç ã€‚

Be aware of the similarities to the earlier code snippet that selected text in cell A1, and the differences. In this code, cell B1 is selected, and then the string "Hello World" is applied to the cell that has been made active. The quotes around the text specify a string value as opposed to a numeric value.

Remember how you chose cell B2 to display the **Stop Recording** button again? That action shows up as a line of code as well. The macro recorder records every **keystroke**.

The lines of code that start with an **apostrophe**(å•å¼•å·) and colored green by the editor are comments that explain the code or remind you and other programmers <u>the purpose of the codeæ³¨é‡Š</u>. VBA ignores any line, or portion of a line, that begins with a **single quote**.

 Writing clear and appropriate comments in your code is an important topic, but that discussion is out of the scope of this article. Subsequent references to this code in the article don't include those four comment lines.

When the macro recorder generates the code, it uses a complex algorithm to determine the methods and the properties that you intended. If you don't recognize a given property, there are many resources available to help you. For example, in the macro that you recorded, the macro recorder generated code that refers to the **FormulaR1C1** property. Not sure what that means?

Be aware that **Application** object is implied in all VBA macros. The code that you recorded works with **Application.** at the beginning of each line.

è¯·æ³¨æ„è¿™æ®µä»£ç ä¸ä¹‹å‰é€‰ä¸­å•å…ƒæ ¼ A1 ä¸­çš„æ–‡æœ¬çš„ä»£ç æ®µçš„ç›¸ä¼¼ä¹‹å¤„å’Œä¸åŒä¹‹å¤„ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œé€‰æ‹©äº†å•å…ƒæ ¼ B1ï¼Œç„¶åå°†å­—ç¬¦ä¸²â€œHello Worldâ€åº”ç”¨äºå·²æ¿€æ´»çš„å•å…ƒæ ¼ã€‚å¼•å·å°†æ–‡æœ¬æŒ‡å®šä¸ºå­—ç¬¦ä¸²å€¼ï¼Œè€Œä¸æ˜¯æ•°å€¼ã€‚

è¿˜è®°å¾—æ‚¨é€‰æ‹©å•å…ƒæ ¼ B2 ä»¥å†æ¬¡æ˜¾ç¤ºâ€œåœæ­¢å½•åˆ¶â€æŒ‰é’®å—ï¼Ÿè¯¥æ“ä½œä¹Ÿæ˜¾ç¤ºä¸ºä¸€è¡Œä»£ç ã€‚å®å½•åˆ¶å™¨è®°å½•æ¯ä¸ªæŒ‰é”®ã€‚

ä»¥å•å¼•å·å¼€å¤´å¹¶ç”±ç¼–è¾‘å™¨å‘ˆç»¿è‰²çš„è¡Œæ˜¯æ³¨é‡Šï¼Œç”¨äºè§£é‡Šä»£ç æˆ–æé†’æ‚¨å’Œå…¶ä»–ç¨‹åºå‘˜ä»£ç çš„ç›®çš„ã€‚VBA å¿½ç•¥ä»¥å•å¼•å·å¼€å¤´çš„ä»»ä½•è¡Œæˆ–è¡Œçš„éƒ¨åˆ†ã€‚åœ¨æ‚¨çš„ä»£ç ä¸­ç¼–å†™æ¸…æ™°å’Œé€‚å½“çš„æ³¨é‡Šæ˜¯ä¸€ä¸ªé‡è¦çš„ä¸»é¢˜ï¼Œä½†è¯¥è®¨è®ºä¸åœ¨æœ¬æ–‡çš„èŒƒå›´å†…ã€‚æœ¬æ–‡ä¸­å¯¹æ­¤ä»£ç çš„åç»­å¼•ç”¨ä¸åŒ…æ‹¬è¿™å››è¡Œæ³¨é‡Šä»£ç ã€‚

å½“å®å½•åˆ¶å™¨ç”Ÿæˆä»£ç æ—¶ï¼Œå®ƒä½¿ç”¨å¤æ‚çš„ç®—æ³•æ¥ç¡®å®šæ‚¨æ‰“ç®—ä½¿ç”¨çš„æ–¹æ³•å’Œå±æ€§ã€‚å¦‚æœæ‚¨ä¸è®¤è¯†ç‰¹å®šçš„å±æ€§ï¼Œæœ‰è®¸å¤šå¯ç”¨çš„èµ„æºå¯ä»¥å¸®åŠ©æ‚¨ã€‚ä¾‹å¦‚ï¼Œåœ¨æ‚¨å½•åˆ¶çš„å®ä¸­ï¼Œå®å½•åˆ¶å™¨ç”Ÿæˆäº†å¼•ç”¨ FormulaR1C1 å±æ€§çš„ä»£ç ã€‚ä¸ç¡®å®šè¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿï¼ˆä¸‹ä¸€èŠ‚ä»‹ç»ä½¿ç”¨å¸®åŠ©ç³»ç»Ÿï¼‰

- è¯·æ³¨æ„ï¼ŒApplication å¯¹è±¡åœ¨æ‰€æœ‰çš„ VBA å®ä¸­éƒ½è¢«æš—ç¤ºã€‚æ‚¨å½•åˆ¶çš„ä»£ç åœ¨æ¯è¡Œå¼€å¤´éƒ½ä½¿ç”¨äº† Application.

### Using Developer Help

Select **FormulaR1C1** in the recorded macro and press F1. The Help system runs a quick search, determines that the appropriate subjects are in the Excel Developer section of the Excel Help, and lists the **FormulaR1C1** property. You can choose the link to read more about the property, but before you do, be aware of the **Excel Object Model Reference** link near the bottom of the window. Choose the link to view a long list of objects that Excel uses in its object model to describe the Worksheets and their components.

Choose any one of those to see the properties and methods that apply to that particular object, along with cross references to different related options. Many Help entries also have brief code examples that can help you. For example, you can follow the links in the **Borders** object to see how to set a border in VBA.

```vb
Worksheets(1).Range("A1").Borders.LineStyle = xlDouble
```

é€‰æ‹©å½•åˆ¶çš„å®ä¸­çš„ FormulaR1C1 å¹¶æŒ‰ F1ã€‚å¸®åŠ©ç³»ç»Ÿä¼šè¿è¡Œå¿«é€Ÿæœç´¢ï¼Œç¡®å®šé€‚å½“çš„ä¸»é¢˜åœ¨ Excel å¸®åŠ©çš„ Excel å¼€å‘äººå‘˜éƒ¨åˆ†ä¸­ï¼Œå¹¶åˆ—å‡º FormulaR1C1 å±æ€§ã€‚æ‚¨å¯ä»¥é€‰æ‹©è¯¥é“¾æ¥ä»¥äº†è§£æ›´å¤šæœ‰å…³è¯¥å±æ€§çš„ä¿¡æ¯ï¼Œä½†åœ¨æ‚¨è¿™æ ·åšä¹‹å‰ï¼Œè¯·æ³¨æ„çª—å£åº•éƒ¨é™„è¿‘çš„ Excel å¯¹è±¡æ¨¡å‹å‚è€ƒé“¾æ¥ã€‚é€‰æ‹©è¯¥é“¾æ¥ä»¥æŸ¥çœ‹ Excel åœ¨å…¶å¯¹è±¡æ¨¡å‹ä¸­ç”¨äºæè¿°å·¥ä½œè¡¨åŠå…¶ç»„ä»¶çš„å¯¹è±¡çš„é•¿åˆ—è¡¨ã€‚

é€‰æ‹©å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œä»¥æŸ¥çœ‹é€‚ç”¨äºè¯¥ç‰¹å®šå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»¥åŠä¸åŒç›¸å…³é€‰é¡¹çš„äº¤å‰å¼•ç”¨ã€‚è®¸å¤šå¸®åŠ©æ¡ç›®è¿˜å…·æœ‰ç®€çŸ­çš„ä»£ç ç¤ºä¾‹ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§è¾¹æ¡†å¯¹è±¡ä¸­çš„é“¾æ¥ï¼Œä»¥æŸ¥çœ‹å¦‚ä½•åœ¨ VBA ä¸­è®¾ç½®è¾¹æ¡†ã€‚

- ä¸ºäº†ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæ‚¨çš„å…¶ä»–è½¯ä»¶ä¸åº”è¯¥ç»‘å®šä¸º`F1`,ä¾‹å¦‚æŸäº›æˆªå›¾å¿«æ·é”®ï¼Œå¦åˆ™æ— æ³•è¾¾åˆ°æŸ¥è¯¢æ–‡æ¡£çš„æ•ˆæœ
- è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¼šè·³è½¬æµè§ˆå™¨ï¼š[Range.FormulaR1C1 property (Excel) | Microsoft Learn](https://learn.microsoft.com/en-us/office/vba/api/excel.range.formular1c1?f1url=%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaxl10.chm144137)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue)

### Editing the code

The Borders code looks different from the recorded macro. One thing that can be confusing with an object model is that there is more than one way to address any given object, cell A1 in this example.

Sometimes the best way to learn programming is to make minor changes to some working code and see what happens as a result. Try it now. Open **Macro1** in the Visual Basic Editor and change the code to the following.

```vb
Sub Macro1()
    Worksheets(1).Range("A1").Value = "Wow!"
    Worksheets(1).Range("A1").Borders.LineStyle = xlDouble
End Sub
```

 Tipï¼š

Use Copy and Paste as much as possible when working with code to avoid typing errors.

You don't need to save the code to try it out, so return to the Excel document, choose **Macros** on the **Developer** tab, choose **Macro1**, and then choose **Run**. Cell A1 now contains the text Wow! and has a double-line border around it.



## Programming tips and tricks



### Start with examples

The VBA community is very large; a search on the Web can almost always yield an example of VBA code that does something similar to what you want to do. If you cannot find a good example, try to break the task down into smaller units and search on each of those, or try to think of a more common, but similar problem. Starting with an example can save you hours of time.

That does not mean that free and well-thought-out code is on the Web waiting for you to come along. In fact, some of the code that you find might have bugs or mistakes. The idea is that the examples you find online or in VBA documentation give you a head start. Remember that learning programming requires time and thought. Before you get in a big rush to use another solution to solve your problem, ask yourself whether VBA is the right choice for this problem.

ä»ç¤ºä¾‹å¼€å§‹
VBA ç¤¾åŒºéå¸¸åºå¤§ï¼›åœ¨ç½‘ç»œä¸Šæœç´¢å‡ ä¹æ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼äºæ‚¨æƒ³è¦çš„åŠŸèƒ½çš„ VBA ä»£ç ç¤ºä¾‹ã€‚å¦‚æœæ‰¾ä¸åˆ°å¥½çš„ç¤ºä¾‹ï¼Œè¯·å°è¯•å°†ä»»åŠ¡åˆ†è§£ä¸ºè¾ƒå°çš„å•å…ƒï¼Œå¹¶å¯¹æ¯ä¸ªå•å…ƒè¿›è¡Œæœç´¢ï¼Œæˆ–å°è¯•æƒ³å‡ºä¸€ä¸ªæ›´å¸¸è§ä½†ç±»ä¼¼çš„é—®é¢˜ã€‚ä»ç¤ºä¾‹å¼€å§‹å¯ä»¥èŠ‚çœæ‚¨æ•°å°æ—¶çš„æ—¶é—´ã€‚

è¿™å¹¶ä¸æ„å‘³ç€å…è´¹ä¸”ç»è¿‡æ·±æ€ç†Ÿè™‘çš„ä»£ç å°±åœ¨ç­‰ç€æ‚¨ä¸Šç½‘æ‰¾ã€‚å®é™…ä¸Šï¼Œæ‚¨æ‰¾åˆ°çš„ä¸€äº›ä»£ç å¯èƒ½å­˜åœ¨é”™è¯¯æˆ–é”™è¯¯ã€‚å…³é”®æ˜¯ï¼Œæ‚¨åœ¨åœ¨çº¿æˆ– VBA æ–‡æ¡£ä¸­æ‰¾åˆ°çš„ç¤ºä¾‹å¯ä»¥è®©æ‚¨äº‹åŠåŠŸå€ã€‚è¯·è®°ä½ï¼Œå­¦ä¹ ç¼–ç¨‹éœ€è¦æ—¶é—´å’Œæ€è€ƒã€‚åœ¨æ‚¨åŒ†å¿™ä½¿ç”¨å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥è§£å†³æ‚¨çš„é—®é¢˜ä¹‹å‰ï¼Œè¯·é—®é—®è‡ªå·± VBA æ˜¯å¦æ˜¯è§£å†³æ­¤é—®é¢˜çš„æ­£ç¡®é€‰æ‹©ã€‚

### Make a simpler problem

Programming can get complex quickly. It's critical, especially as a beginner, that you break the problem down to the smallest possible logical units, then write and test each piece in isolation. If you have too much code in front of you and you get confused or muddled, stop and set the problem aside. When you come back to the problem, copy out a small piece of the problem into a new module, solve that piece, get the code working, and test it to ensure that it works. Then move on to the next part.
ç¼–ç¨‹å¯ä»¥å¾ˆå¿«å˜å¾—å¤æ‚ã€‚ç‰¹åˆ«æ˜¯ä½œä¸ºä¸€ä¸ªæ–°æ‰‹ï¼Œå°†é—®é¢˜åˆ†è§£æˆæœ€å°å¯èƒ½çš„é€»è¾‘å•å…ƒï¼Œç„¶åç‹¬ç«‹ç¼–å†™å’Œæµ‹è¯•æ¯ä¸ªå•å…ƒéå¸¸é‡è¦ã€‚å¦‚æœæ‚¨é¢å‰æœ‰å¤ªå¤šçš„ä»£ç ï¼Œè®©æ‚¨æ„Ÿåˆ°å›°æƒ‘æˆ–æ··ä¹±ï¼Œè¯·åœä¸‹æ¥å¹¶å°†é—®é¢˜æ”¾åœ¨ä¸€è¾¹ã€‚å½“æ‚¨å›åˆ°é—®é¢˜æ—¶ï¼Œè¯·å°†å°é—®é¢˜å¤åˆ¶åˆ°ä¸€ä¸ªæ–°æ¨¡å—ä¸­ï¼Œè§£å†³è¯¥é—®é¢˜ï¼Œä½¿ä»£ç æ­£å¸¸å·¥ä½œï¼Œå¹¶æµ‹è¯•ä»¥ç¡®ä¿å®ƒèƒ½æ­£å¸¸å·¥ä½œã€‚ç„¶åå†è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªéƒ¨åˆ†ã€‚

### Bugs and debugging

There are two main types of programming errors: 

1. syntax errors, which violate the grammatical rules of the programming language, and
2. run-time errors, which look syntactically correct, but fail when VBA attempts to execute the code.

- Although they can be frustrating to fix, syntax errors are easy to catch; the Visual Basic Editor beeps and flashes at you if you type a syntax error in your code.

  - For example, string values must be surrounded by double quotes in VBA. To find out what happens when you use single quotes instead, return to the Visual Basic Editor and replace the "Wow!" string in the code example with 'Wow!' (that is, the word Wow enclosed in single quotes). 

  - If you choose the next line, the Visual Basic Editor reacts. The error "Compile error: Expected: expression" is not that helpful, but the line that generates the error turns red to tell you that you have a syntax error in that line and as a result, this program will not run.

  - Choose **OK** and change the text back to"Wow!".

- Runtime errors are harder to catch because the programming syntax looks correct, but the code fails when VBA tries to execute it.

  - For example, open the Visual Basic Editor and change the **Value** property name to ValueX in your Macro, **deliberately** introducing a runtime error since the **Range** object does not have a property called ValueX. Go back to the Excel document, open the **Macros** dialog box and run Macro1 again. You should see a Visual Basic message box that explains the run-time error with the text, "Object doesn't support this property of method." Although that text is clear, choose **Debug** to find out more.

  - When you return to the Visual Basic Editor, it is in a special debug mode that uses a yellow highlight to show you the line of code that failed. As expected, the line that includes the ValueX property is highlighted.

  - You can make changes to VBA code that is running, so change ValueX back to **Value** and choose the little green play button underneath the **Debug** menu. The program should run normally again.

- It's a good idea to learn how to use the debugger more deliberately for longer, more complex programs. At a minimum, learn a how to set break-points to stop execution at a point where you want to take a look at the code, how to add watches to see the values of different variables and properties as the code runs, and how to step through the code line by line. These options are all available in the **Debug** menu and serious debugger users typically memorize the accompanying keyboard shortcuts.

é”™è¯¯å’Œè°ƒè¯•
ç¼–ç¨‹é”™è¯¯æœ‰ä¸¤ç§ä¸»è¦ç±»å‹ï¼šè¯­æ³•é”™è¯¯è¿åäº†ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•è§„åˆ™ï¼Œè¿è¡Œæ—¶é”™è¯¯åœ¨è¯­æ³•ä¸Šçœ‹èµ·æ¥æ­£ç¡®ï¼Œä½†åœ¨ VBA å°è¯•æ‰§è¡Œä»£ç æ—¶å¤±è´¥ã€‚

è™½ç„¶å®ƒä»¬å¾ˆéš¾ä¿®å¤ï¼Œä½†è¯­æ³•é”™è¯¯å¾ˆå®¹æ˜“æ•æ‰åˆ°ï¼›å¦‚æœæ‚¨åœ¨ä»£ç ä¸­è¾“å…¥è¯­æ³•é”™è¯¯ï¼ŒVisual Basic ç¼–è¾‘å™¨ä¼šå‘å‡ºæç¤ºéŸ³å¹¶é—ªçƒã€‚

ä¾‹å¦‚ï¼Œåœ¨ VBA ä¸­ï¼Œå­—ç¬¦ä¸²å€¼å¿…é¡»ç”¨åŒå¼•å·æ‹¬èµ·æ¥ã€‚è¦äº†è§£å½“æ‚¨ä½¿ç”¨å•å¼•å·è€Œä¸æ˜¯åŒå¼•å·æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œè¯·è¿”å› Visual Basic ç¼–è¾‘å™¨ï¼Œå¹¶å°†ä»£ç ç¤ºä¾‹ä¸­çš„â€œWowï¼â€å­—ç¬¦ä¸²æ›¿æ¢ä¸º 'Wow!'ï¼ˆå³ç”¨å•å¼•å·æ‹¬èµ·æ¥çš„å•è¯â€œWowâ€ï¼‰ã€‚å¦‚æœæ‚¨é€‰æ‹©ä¸‹ä¸€è¡Œï¼ŒVisual Basic ç¼–è¾‘å™¨ä¼šåšå‡ºååº”ã€‚é”™è¯¯â€œç¼–è¯‘é”™è¯¯ï¼šé¢„æœŸï¼šè¡¨è¾¾å¼â€å¹¶ä¸æ˜¯å¾ˆæœ‰å¸®åŠ©ï¼Œä½†ç”Ÿæˆé”™è¯¯çš„è¡Œå˜ä¸ºçº¢è‰²ï¼Œå‘Šè¯‰æ‚¨è¯¥è¡Œä¸­æœ‰ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œå¹¶ä¸”å› æ­¤ï¼Œæ­¤ç¨‹åºå°†æ— æ³•è¿è¡Œã€‚

é€‰æ‹©â€œç¡®å®šâ€å¹¶å°†æ–‡æœ¬æ›´æ”¹å›â€œWowï¼â€ã€‚

è¿è¡Œæ—¶é”™è¯¯å¾ˆéš¾æ•æ‰ï¼Œå› ä¸ºç¼–ç¨‹è¯­æ³•çœ‹èµ·æ¥æ˜¯æ­£ç¡®çš„ï¼Œä½†ä»£ç åœ¨ VBA å°è¯•æ‰§è¡Œå®ƒæ—¶å¤±è´¥äº†ã€‚

ä¾‹å¦‚ï¼Œåœ¨æ‚¨çš„å®ä¸­å°† Value å±æ€§åç§°æ›´æ”¹ä¸º ValueXï¼Œæ•…æ„å¼•å…¥è¿è¡Œæ—¶é”™è¯¯ï¼Œå› ä¸º Range å¯¹è±¡æ²¡æœ‰åä¸º ValueX çš„å±æ€§ã€‚è¿”å› Excel æ–‡æ¡£ï¼Œæ‰“å¼€å®å¯¹è¯æ¡†ï¼Œå¹¶å†æ¬¡è¿è¡Œ Macro1ã€‚æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ª Visual Basic æ¶ˆæ¯æ¡†ï¼Œå…¶ä¸­è§£é‡Šäº†è¿è¡Œæ—¶é”™è¯¯ï¼Œæ–‡æœ¬ä¸ºâ€œå¯¹è±¡ä¸æ”¯æŒæ­¤å±æ€§æˆ–æ–¹æ³•ã€‚â€è™½ç„¶è¯¥æ–‡æœ¬å¾ˆæ¸…æ™°ï¼Œä½†é€‰æ‹©â€œè°ƒè¯•â€ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚

å½“æ‚¨è¿”å›åˆ° Visual Basic ç¼–è¾‘å™¨æ—¶ï¼Œå®ƒå¤„äºç‰¹æ®Šçš„è°ƒè¯•æ¨¡å¼ä¸­ï¼Œä½¿ç”¨é»„è‰²çªå‡ºæ˜¾ç¤ºå¤±è´¥çš„ä»£ç è¡Œã€‚æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼ŒåŒ…æ‹¬ ValueX å±æ€§çš„è¡Œè¢«çªå‡ºæ˜¾ç¤ºã€‚

æ‚¨å¯ä»¥æ›´æ”¹æ­£åœ¨è¿è¡Œçš„ VBA ä»£ç ï¼Œå› æ­¤å°† ValueX æ”¹å› Value å¹¶é€‰æ‹©è°ƒè¯•èœå•ä¸‹é¢çš„å°ç»¿è‰²æ’­æ”¾æŒ‰é’®ã€‚ç¨‹åºåº”è¯¥å†æ¬¡æ­£å¸¸è¿è¡Œã€‚

æœ€å¥½å­¦ä¹ å¦‚ä½•æ›´æœ‰æ„è¯†åœ°ä½¿ç”¨è°ƒè¯•å™¨æ¥å¤„ç†æ›´é•¿ã€æ›´å¤æ‚çš„ç¨‹åºã€‚è‡³å°‘è¦å­¦ä¼šå¦‚ä½•è®¾ç½®æ–­ç‚¹ï¼Œåœ¨æ‚¨æƒ³æŸ¥çœ‹ä»£ç çš„åœ°æ–¹åœæ­¢æ‰§è¡Œï¼Œå¦‚ä½•æ·»åŠ ç›‘è§†å™¨ä»¥åœ¨ä»£ç è¿è¡Œæ—¶æŸ¥çœ‹ä¸åŒå˜é‡å’Œå±æ€§çš„å€¼ï¼Œä»¥åŠå¦‚ä½•é€è¡Œæ‰§è¡Œä»£ç ã€‚è¿™äº›é€‰é¡¹éƒ½åœ¨è°ƒè¯•èœå•ä¸­æä¾›ï¼Œè®¤çœŸçš„è°ƒè¯•å™¨ç”¨æˆ·é€šå¸¸ä¼šè®°å¿†ç›¸åº”çš„é”®ç›˜å¿«æ·é”®ã€‚

## Using reference materials well@æŸ¥é˜…å‚è€ƒ

- Time spent browsing the Object Model reference pays off. After you understand the basics of VBA syntax and the object model for the Office application that you are working with, you advance from guesswork to methodical programming.æµè§ˆå¯¹è±¡æ¨¡å‹å‚è€ƒæ‰€èŠ±è´¹çš„æ—¶é—´æ˜¯å€¼å¾—çš„ã€‚åœ¨æ‚¨äº†è§£VBAè¯­æ³•çš„åŸºæœ¬çŸ¥è¯†å’Œæ­£åœ¨ä½¿ç”¨çš„Officeåº”ç”¨ç¨‹åºçš„å¯¹è±¡æ¨¡å‹åï¼Œæ‚¨å°†ä»çŒœæµ‹è¿‡æ¸¡åˆ°æœ‰æ¡ä¸ç´Šçš„ç¼–ç¨‹

- [Excel Visual Basic for Applications (VBA) å‚è€ƒ | Microsoft Learn](https://learn.microsoft.com/zh-cn/office/vba/api/overview/excel)

- |                                                              |                                          |      |
  | ------------------------------------------------------------ | ---------------------------------------- | ---- |
  | ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/c890c078263148cd8455b60f9720c20c.png) | officeä¸­åŒ…å«çš„åº”ç”¨çš„VBAå‚è€ƒï¼Œä»¥excelä¸ºä¾‹ |      |

  

## Going further with programming

Although this article is short and only scratches the surface of VBA and programming, it is hopefully enough to get you started.

This section briefly discusses a few more key topics.



### Variables

In the simple examples in this article you manipulated objects that the application had already created. You might want to create your own objects to store values or references to other objects for temporary use in your application. These are called variables.

To use a variable in VBA, must tell VBA which type of object the variable represents by using the **Dim** statement. You then set its value and use it to set other variables or properties.

```vb
    Dim MyStringVariable As String
    MyStringVariable = "Wow!"
    Worksheets(1).Range("A1").Value = MyStringVariable
```

- åœ¨VBAä¸­ï¼Œ"Dim"æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œå®ƒæ˜¯"Dimension"çš„ç¼©å†™ï¼Œæ„æ€æ˜¯å£°æ˜ä¸€ä¸ªå˜é‡å¹¶æŒ‡å®šå…¶æ•°æ®ç±»å‹ã€‚åœ¨ä¸­æ–‡ä¸­ï¼Œå¯ä»¥å°†"Dim"ç¿»è¯‘ä¸º"å£°æ˜"ã€"å®šä¹‰"æˆ–"ç»´åº¦"ã€‚

### Branching and looping

The simple programs in this article execute one line at a time, from the top down. The real power in programming comes from the options that you have to determine which lines of code to execute, based on one or more conditions that you specify. You can extend those capabilities even further when you can repeat an operation many times. For example, the following code extends Macro1.

```vb
Sub Macro1()
    If Worksheets(1).Range("A1").Value = "Yes!" Then
        Dim i As Integer
        For i = 2 To 10
            Worksheets(1).Range("A" & i).Value = "OK! " & i
        Next i
    Else
        MsgBox "Put Yes! in cell A1"
    End If
End Sub
```

Type or paste the code into the Visual Basic Editor and then run it. Follow the directions in the message box that appears and change the text in cell A1 from `Wow!` to `Yes!` and run it again to see the power of looping. ï¼ˆæ³¨æ„æ„Ÿå¹å·æ˜¯è‹±æ–‡ï¼Œé¦–å­—æ¯å¤§å†™ï¼‰

This code snippet demonstrates variables, branching and looping. Read it carefully after you see it in action and try to determine what happens as each line executes.

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/817e53e729ae4bd4bc2d731e770f5312.png)



## example code

Here are a few scripts to try; each solves a real-world Office problem.



### Create an email in Outlook

VB

```vb
Sub MakeMessage()
    Dim OutlookMessage As Outlook.MailItem
    Set OutlookMessage = Application.CreateItem(olMailItem)
    OutlookMessage.Subject = "Hello World!"
    OutlookMessage.Display
    Set OutlookMessage = Nothing
End Sub
```

Be aware that there are situations in which you might want to automate email in Outlook; you can use templates as well.



### Delete empty rows in an Excel worksheet

```vb
Sub DeleteEmptyRows()
    SelectedRange = Selection.Rows.Count
    ActiveCell.Offset(0, 0).Select
    For i = 1 To SelectedRange
        If ActiveCell.Value = "" Then
            Selection.EntireRow.Delete
        Else
            ActiveCell.Offset(1, 0).Select
        End If
    Next i
End Sub
```

Be aware that you can select a column of cells and run this macro to delete all rows in the selected column that have a blank cell.



### Delete empty text boxes in PowerPoint

VB

```vb
Sub RemoveEmptyTextBoxes()
    Dim SlideObj As Slide
    Dim ShapeObj As Shape
    Dim ShapeIndex As Integer
    For Each SlideObj In ActivePresentation.Slides
        For ShapeIndex = SlideObj.Shapes.Count To 1 Step -1
            Set ShapeObj = SlideObj.Shapes(ShapeIndex)
            If ShapeObj.Type = msoTextBox Then
                If Trim(ShapeObj.TextFrame.TextRange.Text) = "" Then
                    ShapeObj.Delete
                End If
            End If
        Next ShapeIndex
    Next SlideObj
End Sub
```

Be aware that this code loops through all of the slides and deletes all text boxes that don't have any text. The count variable decrements instead of increments because each time the code deletes an object, it removes that object from the collection, which reduces the count.

### Copy a contact from Outlook to Word

```vb
Sub CopyCurrentContact()
   Dim OutlookObj As Object
   Dim InspectorObj As Object
   Dim ItemObj As Object
   Set OutlookObj = CreateObject("Outlook.Application")
   Set InspectorObj = OutlookObj.ActiveInspector
   Set ItemObj = InspectorObj.CurrentItem
   Application.ActiveDocument.Range.InsertAfter (ItemObj.FullName & " from " & ItemObj.CompanyName)
End Sub
```

Be aware that this code copies the currently open contact in Outlook into the open Word document. This code only works if there is a contact currently open for inspection in Outlook.

## æ›´å¤šå†…å®¹

- [Language reference for Visual Basic for Applications (VBA) | Microsoft Learn](https://learn.microsoft.com/en-us/office/vba/api/overview/language-reference?source=recommendations)
- [Visual Basic for Applications (VBA) è¯­è¨€å‚è€ƒ | Microsoft Learn](https://learn.microsoft.com/zh-cn/office/vba/api/overview/language-reference)
- [Visual Basic æ¦‚å¿µä¸»é¢˜ | Microsoft Learn](https://learn.microsoft.com/zh-cn/office/vba/language/reference/user-interface-help/visual-basic-conceptual-topics)
- å‚è€ƒç›¸å…³ä¹¦ç±

### æ¨èçš„ä½¿ç”¨æ–¹æ³•

- å¦‚æœå½•åˆ¶å®å¯ä»¥æ»¡è¶³è¦æ±‚,é‚£ä¹ˆå°±å¯ä»¥é¿å¼€è‡ªå·±å†™VBç¨‹åºçš„ç¯å¢ƒ
- åˆ©ç”¨æœç´¢å¼•æ“æˆ–è€…AIå°è¯•æœç´¢æˆ–ç”Ÿæˆå¯ä»¥å®Œæˆç‰¹å®šä»»åŠ¡çš„VBAå®
- å€ŸåŠ©AIæ¥è§£è¯»å’Œå­¦ä¹ æ‹¿åˆ°æ‰‹çš„VBAä»£ç ,ä¾‹å¦‚æ·»åŠ æ³¨é‡Šæˆ–è€…åŠŸèƒ½æ€»ç»“

