@[toc]

## ç›´æ¥æ˜ å°„

* æˆ‘ä»¬å°†cacheç®€ç§°ä¸ºç¼“å­˜
* `æ¯ä¸ªä¸»å­˜å—`åªä¸ `ä¸€ä¸ªç¼“å­˜å—`ç›¸å¯¹åº”,æ˜ å°„å…³ç³»å¼ä¸º

  * $i = j\ mod\ C$
  * å…¶ä¸­ï¼Œiä¸ºç¼“å­˜å—å·,jä¸ºä¸»å­˜å—å·,Cä¸ºç¼“å­˜å—æ•°ã€‚
    * è®¾ä¸»å­˜å…±æœ‰$M=2^m$ä¸ªå­å—,cacheå«æœ‰$2^c$ä¸ªå­å—($C=2^c)$(åŒºåˆ†C,c;m>c)
    * è‡ªç„¶,åŒºåˆ†ä¸åŒç¼“å­˜å—çš„åœ°å€ç”¨cä½äºŒè¿›åˆ¶æ•°æ¥ç¼–ç åŒºåˆ†,ç”¨mä½æ¥åŒºåˆ†ä¸»å­˜çš„ä¸åŒå—
      * ä¸‹é¢æåˆ°çš„bä½åˆ™æ˜¯å­—å—å†…éƒ¨çš„å­˜å‚¨å•å…ƒçš„åœ°å€
  * æ˜ å°„ç»“æœè¡¨æ˜ `æ¯ä¸ªç¼“å­˜å—`å¯¹åº” `è‹¥å¹²ä¸ªä¸»å­˜å—`
    ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/fa8a625d3e8d438ab1d17f270f88b749.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAeHVjaGFveGluMTM3NQ==,size_20,color_FFFFFF,t_70,g_se,x_16)

- â¤ï¸è¿™ä¸ªè¡¨æ ¼ç¨å¾®æä¸€ä¸‹
  - ä¸Šé¢è¯´åˆ°,$C=2^c$,$M=2^m$;$\frac{M}{C}=m-c$,å½“ç„¶,m,céƒ½æ˜¯æ­£æ•´æ•°(m>c),å®ƒä»¬çš„å·®å€¼ä¹Ÿæ˜¯æ­£æ•´æ•°
  - è¿™æ„å‘³ç€,ä¸»å­˜çš„å—æ•°æ˜¯cacheå—æ•°çš„æ•´å€æ•°;(ä»è¿™ä¸ªè¯­å¢ƒä¸‹çœ‹,ä¸»å­˜çš„æœ€åä¸€å—ä¼šæ°å¥½çš„è¢«æ˜ å°„åˆ°cacheä¸Šçš„æœ€åä¸€å—cacheå—.)
  - åˆå› ä¸º,æˆ‘ä»¬æ˜¯ä»0å¼€å§‹è®¡æ•°çš„,æ‰€ä»¥æœ€åä¸€å—ä¸»å­˜å—$2^m-1$å°†è¢«æ˜ å°„åˆ°cacheå—çš„æœ€åå—$C-1$ä¸Š.
  - æˆ–è€…ä»å‘¨æœŸ(å‡½æ•°)çš„è§’åº¦(å‘¨æœŸä¸ºT=C),å¯ä»¥æ–¹ä¾¿çš„æ ¹æ®å‘¨æœŸ,æŠŠç¼“å­˜å—å·æœ€ä¸ºè¯¥æ˜ å°„ä¸Šç»“æœåºåˆ—ä¸Šçš„ç¬¬ä¸€ä¸ªä¸»å­˜å—å·,å†ä¾æ¬¡+C,å¾—åˆ°æ˜ å°„åˆ°è¯¥cacheå—çš„ä¸»å­˜å—åºåˆ—(æ¯”å¦‚,0,C,2C,3C,...,$2^m-C$)

> è¿™é‡Œéœ€è¦ç¨å¾®çº¦å®šä¸€ä¸‹è§‚ç‚¹.
>
> - è®¡ç®—æœºçš„è¿è¡Œä¸»è¦ä¾èµ–äºcpuå’Œä¸»å­˜
>   - cacheä½œä¸ºä¸€ç§é«˜é€Ÿä¸­é—´è®¾å¤‡ä¸»è¦ç”¨æ¥æå‡æ€§èƒ½(ç„¶è€Œå®ƒä¸æ˜¯è¿è¡Œä¸­çš„å¿…è¦ä¸€ç¯)
>   - cpuæ ¹æ®æ•°æ®(æ¯”å¦‚æ“ä½œæ•°)çš„åœ°å€,åˆ°å¯¹åº”åœ°å€ä½ç½®å»å–æ•°æ®
>     - è¿™æ—¶ç”¨åˆ°çš„ä¸»å­˜åœ°å€å¯ä»¥åˆ†ä¸ºä¸‰éƒ¨åˆ†t+c+b
>     - å‰m=(t+c)ä½å¯ä»¥ç²¾ç¡®åˆ°ä¸»å­˜ä¸­çš„æŸä¸ªå—
>     - åbä½å¯ä»¥è¿›å…¥åˆ°æŒ‡å®šçš„ä¸»å­˜å—ä¸­è¿›è¡Œå­—(èŠ‚)çš„å®šä½
>   - æ²¡æœ‰cacheçš„æ—¶å€™,cpuå°±ç›´æ¥åˆ°ä¸»å­˜çš„æ­£ç¡®çš„ `åœ°å€`å¤„å»å–æ•°æ®
>   - ç°åœ¨æœ‰äº†cache,cpuä¼šå°†è¿™ä¸ªåŸæœ¬è¦åˆ°ä¸»å­˜è®¿é—®çš„(ä¸»å­˜)`åœ°å€`å’Œcacheä¸­åšå¯¹æ¯”(ä¸»è¦æ ¹æ®ä¸Šè¿°ä¸»å­˜åœ°å€åˆ’åˆ†ä¸­çš„ `ä¸­é—´cä½`å­—æ®µè®¡ç®—å¾—åˆ°å¯¹åº”æ˜ å°„çš„cacheè¡Œ(å—);
>     - å†è¿›è¡Œå¯¹æ¯”é«˜tä½çš„å¯¹æ¯”(å¦‚æœå¯¹æ¯”ç»“æœå‘ç°ç›¸åŒ,ä¸”å¯¹åº”çš„cacheå—çš„æ•°æ®éƒ¨åˆ†ä¸­çš„æ•°æ®æ˜¯æœ‰æ•ˆçš„(æ ¹æ®æœ‰æ•ˆä½æ˜¯å¦ä¸º1åˆ¤å®š)(è¿™æ—¶è§†ä¸ºå‘½ä¸­),é‚£ä¹ˆå°±ä¸ç”¨åœ¨è¿›ä¸€æ­¥åˆ°ä¸»å­˜ä¸­å»å–æ•°,ç›´æ¥å°†å‘½ä¸­çš„cacheå—ä¸­çš„æ•°æ®å–å‡ºæ¥ä½¿ç”¨

* 
* åœ¨ç¼“å­˜ä¸­ `ä¸»å­˜åœ°å€é«˜mä½`è¢«åˆ†æˆä¸¤éƒ¨åˆ†:

  * `ä½cä½`æ˜¯æŒ‡Cache çš„å­—å—åœ°å€,
  * `é«˜tä½`$(t = m-c)$æ˜¯æŒ‡ `ä¸»å­˜å­—å—æ ‡è®°tag `,å®ƒè¢«è®°å½•åœ¨ `å»ºç«‹äº†å¯¹åº”å…³ç³»çš„ç¼“å­˜å—`çš„â€œæ ‡è®°"ä½ä¸­ã€‚
    * è¿™é‡Œ$t=m-c$æ˜¯æŒ‡($2^t=\frac{2^m}{2^c})$;ä¸»å­˜å—æ•°æ˜¯cacheå—æ•°çš„$2^t$å€(è¿™ä¸ªå€æ•°ç”¨äºŒè¿›åˆ¶æ•°è¡¨ç¤ºæ°å¥½éœ€è¦tä½)
    * ä½†è¿™ä»…ä»…åªæ˜¯ä¸€ç§é€»è¾‘åˆ’åˆ†(æˆ‘ä»¬åˆšå¥½åœ°ä½¿ç”¨ä¸»å­˜åœ°å€çš„é«˜tä½ä½œä¸ºæ ‡è®°)
  * å½“ `ç¼“å­˜`æ¥åˆ°CPUé€æ¥çš„ `ä¸»å­˜åœ°å€ `å,åªéœ€æ ¹æ® `ä¸­é—´cä¸ªbit `çš„å­—æ®µ(å‡è®¾ä¸º00â€¦01)æ‰¾åˆ° `Cacheå­—å—1(æˆ–è€…è¯´,ä¸‹å›¾æ‰€ç¤ºçš„cacheè¡Œ1) `,ç„¶åæ ¹æ®å­—å—1çš„â€œæ ‡è®°â€`æ˜¯å¦ä¸ä¸»å­˜åœ°å€çš„é«˜tä½ç›¸ç¬¦ `æ¥åˆ¤æ–­(ä¸‹å›¾ä¸­çš„ `tä½æ¯”è¾ƒå™¨`ç¡¬ä»¶åšçš„è¿™ä¸ªäº‹æƒ…)
    * ä¹‹æ‰€ä»¥è¿™ä¹ˆåš,æ˜¯å› ä¸º,ä¸€å—cacheå—,ä¼šè¢«å¤šå—ä¸»å­˜å—æ˜ å°„(è­¬å¦‚ä¸Šè¡¨æ ¼ä¸­æ‰€ç¤º,0å·cacheå—å¯ä»¥è¢«$0å·,Cå·,2C,..2^m$,é‚£ä¹ˆå¦‚ä½•åŒºåˆ†?,å°±ä¾èµ–äºé¢„ä¿ç•™å‡ºæ¥çš„å‰tä½æ¥åšä¸€ä¸ªå—å†…åˆ¤æ–­
  * * è‹¥ç¬¦åˆ,ä¸”æœ‰æ•ˆä½ä¸ºâ€œ1â€(å³æˆåŠŸå‘½ä¸­)(æœ‰æ•ˆä½ `ç”¨æ¥è¯†åˆ«Cacheå­˜å‚¨å—ä¸­çš„æ•°æ®æ˜¯å¦æœ‰æ•ˆ`,å› ä¸ºæœ‰æ—¶Cacheä¸­çš„æ•°æ®æ˜¯æ— æ•ˆçš„,â¤ï¸
      * ä¾‹å¦‚,åœ¨åˆå§‹æ—¶åˆ»Cacheåº”è¯¥æ˜¯â€œç©ºâ€çš„,å…¶ä¸­çš„å†…å®¹æ˜¯æ— æ„ä¹‰çš„(è¿™æ ·,å³ä½¿åˆ¤æ–­æ ‡è®°å’Œä¸»å­˜åœ°å€ä¸€è‡´,å–å‡ºçš„æ•°æ®ä¹Ÿæ˜¯æ— æ„ä¹‰çš„(æ ‡è®°ä¸æ˜¯æ•°æ®æœ¬èº«),
      * æœ‰æ•ˆä½ä¸º1,è¡¨ç¤ºè¯¥Cache å—å·²å’Œä¸»å­˜çš„æŸå—å»ºç«‹äº†å¯¹åº”å…³ç³»(å³å·²å‘½ä¸­),åˆ™å¯æ ¹æ®bä½åœ°å€ä»Cacheä¸­å–å¾—ä¿¡æ¯;
    * è‹¥ä¸ç¬¦åˆ,æˆ–æœ‰æ•ˆä½ä¸ºâ€œ0â€(å³ä¸å‘½ä¸­),åˆ™ `ä»ä¸»å­˜è¯»å…¥æ–°çš„å­—å—`æ¥æ›¿ä»£æ—§çš„å­—å—,åŒæ—¶å°†ä¿¡æ¯é€å¾€CPU,å¹¶ä¿®æ”¹cacheâ€œæ ‡è®°â€ã€‚
      * å¦‚æœåŸæ¥æœ‰æ•ˆä½ä¸ºâ€œ0â€,è¿˜å¾—å°†æœ‰æ•ˆä½ç½®æˆâ€œ1â€ã€‚

### ä¼˜ç‚¹

* å®ç°ç®€å•,åªéœ€ `åˆ©ç”¨ä¸»å­˜åœ°å€çš„æŸäº›ä½`ç›´æ¥åˆ¤æ–­,å³å¯ç¡®å®šæ‰€éœ€å­—å—æ˜¯å¦åœ¨ç¼“å­˜ä¸­

### ç¼ºç‚¹

* ç›´æ¥æ˜ å°„æ–¹å¼çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿçµæ´»,å› æ¯ä¸ªä¸»å­˜å—åªèƒ½å›ºå®šåœ°å¯¹åº”æŸä¸ªç¼“å­˜å—,å³ä½¿ç¼“å­˜å†…è¿˜ç©ºç€è®¸å¤šä½ç½®ä¹Ÿä¸èƒ½å ç”¨,ä½¿ç¼“å­˜çš„å­˜å‚¨ç©ºé—´å¾—ä¸åˆ°å……åˆ†çš„åˆ©ç”¨ã€‚
* æ­¤å¤–,å¦‚æœç¨‹åºæ°å¥½è¦ `é‡å¤è®¿é—®`å¯¹åº” `åŒä¸€ç¼“å­˜å—ä½ç½®`çš„ `ä¸åŒä¸»å­˜å—`,å°±è¦ä¸åœåœ°è¿›è¡Œæ›¿æ¢,ä»è€Œé™ä½å‘½ä¸­ç‡ã€‚
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/17425a5019194c088b71777d0a8dc146.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAeHVjaGFveGluMTM3NQ==,size_15,color_FFFFFF,t_70,g_se,x_16)

### å°ç»“

![ğŸ¥°03/07/2022 20:03:12](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/20220307200306.png)

![ğŸ¥°03/07/2022 20:03:44](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/20220307200343.png)

![1646657005307.png](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/1646657005307.png)

![1646656842434.png](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/1646656842434.png)

## å…¨ç›¸è”æ˜ å°„

* å…¨ç›¸è”æ˜ å°„å…è®¸ä¸»å­˜ä¸­æ¯ä¸€å­—å—æ˜ å°„åˆ°Cacheä¸­çš„ä»»ä½•ä¸€å—ä½ç½®ä¸Šã€‚
* è¿™ç§æ˜ å°„æ–¹å¼å¯ä»¥ä»å·²è¢«å æ»¡çš„Cacheä¸­æ›¿æ¢å‡ºä»»ä¸€æ—§å­—å—ã€‚
* æ˜¾ç„¶,è¿™ç§æ–¹å¼çµæ´»,å‘½ä¸­ç‡ä¹Ÿæ›´é«˜ç¼©å°äº†å—å†²çªç‡ã€‚
* ä¸ç›´æ¥æ˜ å°„ç›¸æ¯”,å®ƒçš„ `ä¸»å­˜å­—å—æ ‡è®°`ä»tä½å¢åŠ åˆ° `t+c`ä½,è¿™å°±ä½¿Cacheâ€œæ ‡è®°â€çš„ä½æ•°å¢å¤š,è€Œä¸”è®¿é—®Cacheæ—¶ä¸»å­˜å­—å—æ ‡è®°éœ€è¦å’ŒCacheçš„å…¨éƒ¨â€œæ ‡è®°â€ä½è¿›è¡Œæ¯”è¾ƒ,æ‰èƒ½åˆ¤æ–­å‡ºæ‰€è®¿é—®ä¸»å­˜åœ°å€çš„å†…å®¹æ˜¯å¦å·²åœ¨Cache å†…ã€‚
* è¿™ç§æ¯”è¾ƒé€šå¸¸é‡‡ç”¨â€œæŒ‰å†…å®¹å¯»å€â€çš„ç›¸è”å­˜å‚¨å™¨æ¥å®Œæˆã€‚
* æ€»ä¹‹,è¿™ç§æ–¹å¼æ‰€éœ€çš„é€»è¾‘ç”µè·¯ç”šå¤š,æˆæœ¬è¾ƒé«˜,å®é™…çš„Cacheè¿˜è¦é‡‡ç”¨å„ç§æªæ–½æ¥å‡å°‘åœ°å€çš„æ¯”è¾ƒæ¬¡æ•°ã€‚

![1646657418935.png](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/1646657418935.png)

![1646657946575.png](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/1646657946575.png)

![1646657998977.png](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/1646657998977.png)

## ç»„ç›¸è”æ˜ å°„

* ç»„ç›¸è”æ˜ å°„æ˜¯å¯¹ç›´æ¥æ˜ å°„å’Œå…¨ç›¸è”æ˜ å°„çš„ä¸€ç§æŠ˜ä¸­ã€‚
  * r->row(row array of cache)
* å®ƒæŠŠCacheåˆ†ä¸ºQ(=$2^q=\frac{2^c}{2^r}=2^{c-r}$)ç»„,`æ¯ç»„æœ‰Rå—`(=C/Q=$2^r$;Q<C),å¹¶æœ‰ä»¥ä¸‹å…³ç³»:
  - $$
    i = j\ mod \ Q
    $$
  - ç”¨qä½(q=c-r)äºŒè¿›åˆ¶æ•°æ¥åŒºåˆ†ä¸åŒçš„cacheç»„(æ¯ä¸ªç»„å†…æœ‰Rå—)
    - ä¸‹å›¾ä¸ºä¾‹ä¾¿äºç†è§£,å°†æ¯ç»„ä¸­çš„å­å—å¹¶æ’ç”»åˆ°åŒä¸€è¡Œ)
    - r=1,å¯¹åº”çš„ç»„å†…cacheå—æ•°$R=2^r=2^1=2$å—
  - å…¶ä¸­,iä¸ºç¼“å­˜çš„ `ç»„å·`,jä¸ºä¸»å­˜çš„å—å·ã€‚
  - æŸä¸€ä¸»å­˜å—æŒ‰ `æ¨¡Q`å°†å…¶æ˜ å°„åˆ°ç¼“å­˜çš„ `ç¬¬iç»„`å†…
  - å¯ä»¥è®¤ä¸º,å°å†™å­—æ¯ä¹Ÿæ˜¯æ•°é‡çš„ä¸€ä¸ªæŒ‡æ ‡(æŒ‡æ•°åº¦é‡$log_2$)
  - $Q<C$,æ¨¡å˜å°äº†,ç›´æ¥ç›¸è”çš„éƒ¨åˆ†å˜å¾—å®¹æ˜“é‡åˆ(æœ‰è¾ƒé«˜çš„ç»„é—´å†²çªç‡,ç»„å†…å†²çªç‰¹ç‚¹ç±»ä¼¼å…¨ç›¸è”),ä½†æ˜¯ç»„å†…é‡‡ç”¨å…¨ç›¸è”,æœ‰è¾ƒé«˜çš„cacheåˆ©ç”¨ç‡

![1646657717835.png](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/1646657717835.png)

![1646657731011.png](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/1646657731011.png)

![1646657753933.png](https://cdn.jsdelivr.net/gh/xuchaoxin1375/pictures@main/images/1646657753933.png)

### summary

ç»„ç›¸è”ä¸‹:

* ç»„é—´ç›´æ¥ç›¸è¿,ç»„å†…å…¨ç›¸è”
* æç«¯æƒ…å†µä½:
  * æ¯ä¸ªç»„åªæœ‰ä¸€ä¸ªcache,(åˆ†ç»„çš„æ•°é‡è¾¾åˆ°æœ€å¤š,ä»…ç›´æ¥ç›¸è”æœ‰ä½œç”¨)
  * åˆ†ç»„æ•°é‡qè¾¾åˆ°æœ€å°‘(ä»…ä¸€ä¸ªåˆ†ç»„,ç»„å†…æ•°é‡è¾¾åˆ°æœ€å¤š,æ­¤æ—¶ä»…å…¨ç›¸è”æœ‰ä½œç”¨))
  *
