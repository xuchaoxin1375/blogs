## abstract

- 概率公理和概率基本性质
- 基本概率公式及其应用

## 概率公理

- 概率函数p(简称概率p)满足三个条件:
  1. 非负性:任意事件$A:P(A)\geqslant 0$
  2. 规范性:必然事件$\Omega:P(\Omega)=1$
  3. 两两互斥事件$A_1,\cdots,A_n,\cdots$之间满足可列可加性:$P(\bigcup\limits_{i=1}^{\infin}A_i)$=$\sum\limits_{i=1}^{\infin}P(A_i)$

## 概率的基本性质

记样本空间为$S$

1. $P(\emptyset)=0$
   - 证明:令$A_i=\emptyset$$(i=1,2,\cdots)$,则$\bigcup\limits_{i=1}^{\infin}A_i$=$\emptyset$,从而$P(A_i)$=$P(\bigcup\limits_{i=1}^{\infin}A_i)$=$P(\emptyset)$`(1)`
   - 将`(1)`代入公理3:$P(\emptyset)$=$\sum_{i=1}^{\infin}P(\emptyset)$,即$\sum_{i=1}^{\infin}P(\emptyset)=0$,$P(\emptyset)=0$
2. 有限可加性:对于两两互斥的$A_1,\cdots,A_n$,满足可列可加性:$P(\bigcup\limits_{i=1}^{n}A_i)$=$\sum\limits_{i=1}^{n}P(A_i)$
   - 证明:令$A_{n+1}=A_{n+2}=\cdots=\emptyset$,即有$A_{i}A_{j}=\emptyset$,$i\neq{j},i,j=1,2,\cdots$(无穷)
   - 由公理3:$P(\bigcup\limits_{i=1}^{\infin}A_i)$=$\sum\limits_{i=1}^{\infin}P(A_i)$=$\sum\limits_{i=1}^{n}P(A_i)+0$=$\sum\limits_{i=1}^{n}P(A_i)$
   - $\bigcup\limits_{i=1}^{\infin}A_i$=$(\bigcup\limits_{i=1}^{n}A_i)\cup{A_{n+1}}\cup{A_{n+2}}\cup{\cdots}$=$\bigcup\limits_{i=1}^{n}A_i$
   - $P(\bigcup\limits_{i=1}^{n}A_i)$=$P(\bigcup\limits_{i=1}^{\infin}A_i)$=$\sum\limits_{i=1}^{n}P(A_i)$
3. 若$A\sub{B}$,$P(B-A)=P(B)-P(A)$,且$P(A)\leqslant{P(B)}$👺
   - 由$A\sub{B}$可知$B=A\cup{(B-A)}$,且$A(B-A)=\emptyset$,再由性质2,$P(B)$=$P(A)+P(B-A)$,从而$P(B-A)$=$P(B)-P(A)$
   - 又由概率的非负性,$P(B-A)\geqslant{0}$从而$P(B)-P(A)\geqslant{0}$
4. 对于任意事件$A$,$P(A)\leqslant{1}$
   - 因为$A\sub{S}$,由性质3,$P(A)\leqslant{P(S)}=1$
5. 逆事件概率:$P(\overline{A})$=$1-P(A)$
   - $A\overline{A}=\emptyset$,由有限可加性:$P(A\cup\overline{A})$=$P(A)+P(\overline{A})$
   - 因为$A\cup{\overline{A}}$=$S$,由概率的规范性:$P(A\cup{\overline{A}})=P(S)=1$
   - 所以$P(A)+P(\overline{A})=1$,即$P(\overline{A})$=$1-P(A)$



## 概率的高级性质



### 减法公式🎈

- $P(B-A)$=$P(B)-P(BA);(\forall A,B)$
  - $B-A=B-BA$,所以$P(B-A)=P(B-BA)$
  - 由概率的基本性质:若$A\sub B$或者$AB=A$,则$P(B-A)=P(B)-P(A)$;
  - 而$BA\sub B$对于任意的$A,B$总是成立的,$P(B-BA)=P(B)-P(AB)$
  - $P(B-A)=P(B-BA)=P(B)-P(AB)$等式成立



#### 例

- $P(A)=\frac{1}{3},P(B)=\frac{1}{2}$
  - $求不同条件下的P(B-A)$
    1. $AB=\varnothing$
       - $P(B-A)=P(B-AB)=P(B)=\frac{1}{2}$
    2. $A\sub B$
       - $P(B-A)=P(B-A)=P(B)-P(A)=\frac{1}{2}-\frac{1}{3}=\frac{1}{6}$
    3. $P(AB)=\frac{1}{8}$
       - $P(B-A)=P(B-BA)=P(B)-P(BA)=\frac{1}{2}-\frac{1}{8}=\frac{3}{8}$

### 加法公式🎈

- $P(A\cup B)=P(A)+P(B)-P(AB)$;$(\forall A,B)$

- 证:

  - 因为$A\cup{B}$=$A\cup{(B-A)}$=$A\cup{(B-AB)}$;且$A(B-AB)$=$\emptyset$,$AB\sub{B}$,
  - $P(A\cup{B})$=$P(A\cup{(B-AB)})$=$P(A)+P(B-AB)$=$P(A)+(P(B)-P(AB))$
  - 所以$P(A\cup B)=P(A)+P(B)-P(AB)$

- 三事件的加法公式:$P(A_1\cup{A_2}\cup{B_3})$=$P(A_1)+P(A_2)+P(A_3)-P(A_1A_2)-P(A_1A_3)-P(A_2A_3)+P(A_1A_2A_3)$

  

#### 推广加法公式

- [概率论_加法公式(基本+推广)(Addition Rule Of Probability)_xuchaoxin1375的博客-CSDN博客](https://blog.csdn.net/xuchaoxin1375/article/details/127407426)



### 除法公式(条件概率)🎈

- CP:conditional probability
  - 条件概率的基本观点是某些已获得的信息(某些事情的发生)改变了原本的样本空间
  - 条件概率也是概率(概率函数),不违背三条概率公理

- 在事件A发生的条件下,事件B发生的概率称为B对A的**条件概率**
  - $CP(B,A)=P(B|A)=\frac{P(AB)}{P(A)}$
  - 从直观上解释,就是样本空间$\Omega$对应到事件A发生时,已经被收缩到$\Omega_A$
    - 然而,根据具体的情况,某些已知发生事件A并不会导致$\Omega$在收缩过程中变小(收缩量为0)
      - 例如,含有20个球的箱子
        - $记A_i=\set{含有残次品数量为i个}$
        - $记B={抽种的产品都是正品}$
        - 假设已知箱子中有1个残次品,那么从中抽取出4件全是正品的可概率?
        - $P(B|A_1)=\frac{\binom{19}{4}}{\binom{20}{4}}$
          - 其中$\Omega_{A_1}=\Omega$

  - 事件AB则一定是落在$\Omega_A$中
  - $因此计算公式为P(B|A)=\frac{N(\Omega_{AB})}{N(\Omega_A)}$
    - 如果我们同时为RHS分子分母同乘以一个$N(\frac{1}{\Omega})$
    - $N(x)表示x中包含的样本电数量$
    - 则:$P(B|A)=\frac{P(AB)}{P(A)}$

#### 条件概率的性质

- $记事件C=B|A,事件C表示的是:$
  - $事件B在事件A已经发生的基础上发生$
  - 或:$事件A已经发生的基础上又发生B$
- 记事件$\overline{C}=\overline{B}|{A}表示事件A发生的情况下,事件B不发生$
  - 如果说样本点$c\in C,那么c的发生必然导致A的发生,B不发生(或者说导致B的对立事件\overline{B}也一定发生)$
  - $P(\overline{C})=1-P(C)$
  - $P(\overline{B}|A)=1-P(B|A)$
- 类似的,从样本空间收缩的角度理解,有:
  - $P(B_1\cup B_2|A)=P(B_1|A)+P(B_2|A)-P(B_1B_2|A)$


#### 小结:

- $P(B|A)=\frac{N(\Omega_{AB})}{N(\Omega_A)}$
- $P(B|A)=\frac{P(AB)}{P(A)}$
  - 可以用未缩小样本空间(原样本空间的概率直接计算)
  - 特别的,当$B\sub A,P(AB)=\frac{P(B)}{P(A)}$
- 在实际问题中,条件概率公式的**两种形式**都有应用
  - 有时,问题中的条件概率是直接给出的

#### 例1

- 取产品(球)问题:
  - 现有3个一等品,2个二等品
  - 现在做不放回抽样,每次抽一件
  - 记A={第一次取得一等品}
    - B={第二次取得二等品}
  - 计算P(B|A)=?
  - 方式1:
    - 从样本空间的缩减角度(利用第一种形式来计算)
      - A发生后,在从剩余的球中抽取一件的样本空间:$\Omega\to \Omega_A$,$N(\Omega_A)=4$
        - 此时事件B的样本点集合元素数:$N(\Omega_{AB})=2$
    - $P(B|A)=\frac{\Omega_{AB}}{\Omega_A}=\frac{1}{2}$
  - 方式2:
    - $P(A)=\frac{3}{5}$
    - $P(AB)=\frac{3\times 2}{5\times4}=\frac{3}{10}$
    - $P(B|A)=\frac{P(AB)}{P(A)}=\frac{1}{2}$

#### 例2

- 某商品每天销售达到10件的概率为0.8;12件的概率为0.56
  - 如果当天已经销售了10件,那么能销售到12件的概率?
  - 记A={销售10件}
  - B={销售12件}
  - 则:$P(A)=0.8;P(B)=0.56$
    - 且:$B\sub A,AB=B$
  - $P(B|A)=\frac{P(BA)}{P(A)}=\frac{P(B)}{P(A)}=$

### 乘法公式(积事件公式)

- 乘法公式或乘法定理:**multiplication rule of probability**

- 从**条件概率公式**变形即可得到**积事件**的条件概率展开计算公式

- 设$P(A)>0$.则$P(AB)=P(B|A)P(A)=P(A|B)P(B)$

#### 推广

- 设$A,B,C$为三个事件,且$P(AB)>0$,则$P(ABC)$=$P(C|AB)P(AB)$=$P(C|AB)P(B|A)P(A)$

  - 因为$AB\sub{A}$总是成立的,所以由$P(AB)>0$也就有$P(A)\geqslant{P(AB)}>0$

- 更一般的,设$A_1,\cdots,A_n$为$n$个事件,$n\geqslant{2}$,且$P(A_1\cdots{A_{n-1}})>0$,则

  - 令$P_i=P(A_i|A_1\cdots{A_{i-1}})$,规定$P_1=P(A_1)$

  - $P(A_1,\cdots{A_n})$=$P(A_n|A_1\cdots{A_{n-1}})P(A_1\cdots{A_{n-1}})$

    - =$P(A_n|A_1\cdots{A_{n-1}})P(A_{n-1}|A_1\cdots{A_{n-2}})\cdots{P(A_2|A_1)}P(A_1)$

    - =$P_n\cdots{P_1}$

- 可由归纳法证明

#### 例

- 设袋中由$r$个红球,$t$个白球
- 每次从袋中取出一只球,观察其颜色$x$**放回**,并在放入$a$只$x$色的球
- 若在袋中连续取球4次后,事件$C$:第1,2次红球,第3,4次白球的概率?
  - 设$A_i(i=1,\cdots,4)$:第$i$次取到红球
  - 事件$C$=$A_1A_2\overline{A_3}\;\overline{A_4}$
  - 由乘法定理:$P(C)$=$P(\overline{A_4}|A_1A_2\overline{A_3})P(\overline{A_3}|A_1A_2)P(A_2|A_1)P(A_1)$
  - 显然第$i$次取球时袋中的球的数量为$r+t+a{(i-1)}$
    - $P_4=\frac{t+a}{r+t+3a}$
    - $P_3=\frac{t}{r+t+2q}$
    - $P_2=\frac{r+a}{r+t+a}$
    - $P_1=\frac{r}{r+t}$
  - 从而$P(C)$=$P_4\cdots{P_1}$=$\frac{t+a}{r+t+3a}\frac{t}{r+t+2q}\frac{r+a}{r+t+a}\frac{r}{r+t}$

#### 例

- 某透镜第一次落下时打破的概率为$\frac{1}{2}$,第二次落下才打破的概率为$\frac{7}{10}$,第3次落下才打破的概率为$\frac{9}{10}$
- 求事件$C$:落下3次后仍然未打破的概率
  - 设$A_i$=第$i$次落下才打破;则$C$=$\overline{A_1}\;\overline{A_2}\;\overline{A_3}$
  - $P(C)$=$P(\overline{A_3}|\overline{A_1}\;\overline{A_2})$ $P(\overline{A_2}|\overline{A_1})$ $P(\overline{A_1})$
    - 由题意可知:$P(A_3|\overline{A_2}\;\overline{A_1})$=$\frac{9}{10}$;$P({A_2}|\overline{A_1})$=$\frac{7}{10}$,$P(A_1)=\frac{1}{2}$
    - $P(C)$=$(1-\frac{9}{10})(1-\frac{7}{10})(1-\frac{1}{2})$=$\frac{3}{200}$
- 也可以通过求$\overline{C}$,再由$P(C)=1-P(\overline{C})$求得,这种方式不够直接



## 补充

### 条件概率的链式法则

- [Chain rule (probability) - Wikipedia](https://en.wikipedia.org/wiki/Chain_rule_(probability))

- In probability theory, the chain rule (also called the general product rule[1][2]) permits the calculation of any member of the joint distribution of a set of random variables <u>using only conditional probabilities</u>. 

- The rule is useful in the study of Bayesian networks, which describe a probability distribution in terms of conditional probabilities.

- 更一般的,如果反复套用上述公式,我们可以得到:

  - 下面得到公式看起来复杂,其实用起来是很自然

- $$
  P(\prod_{i=1}^{n}A_i)=P((\prod_{i=1}^{n-1}A_i)A_n)
  =P(A_n|\prod_{i=1}^{n-1}A_i)P(\prod_{i=1}^{n-1}A_i)
  \\
  设通项P_k=
  P(\prod_{i=1}^{k}A_i)=P((\prod_{i=1}^{k-1}A_i)A_k)
  =P(A_k|\prod_{i=1}^{k-1}A_i)P(\prod_{i=1}^{k-1}A_i)
  \\T(k)=\prod_{i=1}^{k}A_i
  \\k=n,n-1,n-2,\cdots,1
  \\P_k=P(T(k))=P(A_k|T(k-1))P(T(k-1))
  \\\vdots
  $$

- $$
  特别的:P_2=P(A_1A_2)=P(A_2|A_1)P(A_1)
  \\P_3=P(A_1A_2A_3)=P(A_3|A_1A_2)P(A_1A_2)
  \\=P(A_3|A_1A_2)P(A_2|A_1)P(A_1)
  \\类似的:
  \\P_4=P(A_1A_2A_3A_4)=P(A_4|A_1A_2A_3)P(A_1A_2A_3)
  \\=P(A_4|A_1A_2A_3)P(A_3|A_1A_2)P(A_2|A_1)P(A_1)
  \\
  P_n=\prod_{i=1}^{n}P(A_{n-i+1}|\prod_{j=0}^{n-i}A_j)
  \\严格的说,\prod_{j=1}^{n}A_j应该作\bigcap\limits_{j=1}^{n}A_j,表示积事件
  \\定义P(A_0)=1
  $$

- 其他写法
  $$
  P_n=\prod_{i=1}^{n}P(A_{n-i+1}|\bigcap\limits_{j=0}^{n-i}A_j)
  \\根据乘法交换律(积事件调整书写顺序含义不变)\\
  P_n=\prod_{i=1}^{n}P(A_{n-i+1}|\bigcap\limits_{j=0}^{n-i}A_j)
  =\prod_{i=1}^{n}P(A_{i}|\bigcap\limits_{j=1}^{i-1}A_j)
  \\约定\bigcap\limits_{j=1}^{0}A_j时省略该项(作为必然事件)
  $$

- 通常,公式右边的条件概率都是比较容易计算的

  - 通常利用条件概率的样本收缩来得出各个条件概率因子
  - 否则可能要考虑其他的计算积事件的方法

### More than two events

- For more than two events $A_{1},\ldots ,A_{n}$ the chain rule extends to the formula ${\displaystyle \mathrm {P} \left(A_{n}\cap \ldots \cap A_{1}\right)=\mathrm {P} \left(A_{n}|A_{n-1}\cap \ldots \cap A_{1}\right)\cdot \mathrm {P} \left(A_{n-1}\cap \ldots \cap A_{1}\right)}$ which by induction may be turned into ${\displaystyle \mathrm {P} \left(A_{n}\cap \ldots \cap A_{1}\right)=\prod _{k=1}^{n}\mathrm {P} \left(A_{k}\,{\Bigg |}\,\bigcap _{j=1}^{k-1}A_{j}\right).}$ 

#### Example

-  With four events ($n=4$), the chain rule is ${\displaystyle {\begin{aligned}\mathrm {P} (A_{1}\cap A_{2}\cap A_{3}\cap A_{4})&=\mathrm {P} (A_{4}\mid A_{3}\cap A_{2}\cap A_{1})\cdot \mathrm {P} (A_{3}\cap A_{2}\cap A_{1})\\&=\mathrm {P} (A_{4}\mid A_{3}\cap A_{2}\cap A_{1})\cdot \mathrm {P} (A_{3}\mid A_{2}\cap A_{1})\cdot \mathrm {P} (A_{2}\cap A_{1})\\&=\mathrm {P} (A_{4}\mid A_{3}\cap A_{2}\cap A_{1})\cdot \mathrm {P} (A_{3}\mid A_{2}\cap A_{1})\cdot \mathrm {P} (A_{2}\mid A_{1})\cdot \mathrm {P} (A_{1})\end{aligned}}}$

#### 例

- 多次摸多颜色球问题

  - 设有5红,3黑,2白

  - 问,**第三次**才摸到**白球**的概率

    - 即,前两次的摸球结果都不是白色的

    - 为了方便讨论问题,记:$A_i={第i次摸出白球};i=1,2,3$

      - 如果不是白球,则记为$\overline{A_i}$

    - $$
      P=P(\overline{A_1}\ \overline{A_2}A_3)
      =P(A_3|\overline{A_1}\ \overline{A_2})
      P(\overline{A_2}|\overline{A_1})P(\overline{A_1})
      \\=\frac{2}{10-2}\frac{8-1}{10-1}\frac{8}{10}
      =\frac{2}{8}\frac{7}{9}\frac{8}{10}
      =\frac{7}{45}
      $$

      - 其中$P(B_n|B_{n-1}\cdots{B_1})$表示已经有$n-1$个求被摸出,现在再摸出一个球,发生事件$B_n$的概率

      - 例如$P(\overline{A_2}|\overline{A_1})$表示已经摸出一个球(而且不是白球)的情况下,再摸出一个求,而且仍然不是白球的概率

      - 实时上,稍微熟练点的高中生,就可以直接写出$p=\frac{2}{8}\frac{7}{9}\frac{8}{10}$

        

### More than two random variables(多维随机变量下的链式乘法法则)

-  Consider an indexed collection of random variables ${\displaystyle X_{1},\ldots ,X_{n}}$ taking possible values $x_{1},\dots ,x_{n}$ respectively. 

- Then, to find the value of this member of the joint distribution, we can apply the definition of conditional probability to obtain:

-  ${\displaystyle \mathrm {P} \left(X_{n}=x_{n},\cdots ,X_{1}=x_{1}\right)=\mathrm {P} \left(X_{n}=x_{n}|X_{n-1}=x_{n-1},\ldots ,X_{1}=x_{1}\right)\cdot \mathrm {P} \left(X_{n-1}=x_{n-1},\ldots ,X_{1}=x_{1}\right)}$ 

- Repeating this process with each final term and letting $A_{k}$ denote the event ${\displaystyle X_{k}=x_{k}}$ creates the product: 

- $$
  {\displaystyle \mathrm {P} \left(\bigcap _{k=1}^{n}A_{k}\right)=\prod _{k=1}^{n}\mathrm {P} \left(A_{k}\,{\Bigg |}\,\bigcap _{j=1}^{k-1}A_{j}\right)=\prod _{k=1}^{n}\mathrm {P} \left(X_{k}=x_{k}\,|\,X_{1}=x_{1},\dots X_{k-1}=x_{k-1}\right).}
  $$

  

#### Example

-  With four variables ($n=4$), denote ${\displaystyle P(x_{n}\,|\,x_{n-1}\dots ,x_{1}):=P(X_{n}=x_{n}\,|\,X_{n-1}=x_{n-1}\dots ,X_{1}=x_{1})}$ for brevity. 
-  Then, the chain rule produces this product of conditional probabilities: ${\displaystyle {\begin{aligned}\mathrm {P} (x_{4},x_{3},x_{2},x_{1})&=\mathrm {P} (x_{4}\mid x_{3},x_{2},x_{1})\cdot \mathrm {P} (x_{3},x_{2},x_{1})\\&=\mathrm {P} (x_{4}\mid x_{3},x_{2},x_{1})\cdot \mathrm {P} (x_{3}\mid x_{2},x_{1})\cdot \mathrm {P} (x_{2},x_{1})\\&=\mathrm {P} (x_{4}\mid x_{3},x_{2},x_{1})\cdot \mathrm {P} (x_{3}\mid x_{2},x_{1})\cdot \mathrm {P} (x_{2}\mid x_{1})\cdot \mathrm {P} (x_{1})\end{aligned}}}$





## 其他公式



- [PT@全概率公式和贝叶斯公式@后验概率和信念度量](https://editor.csdn.net/md/?articleId=133128913)



