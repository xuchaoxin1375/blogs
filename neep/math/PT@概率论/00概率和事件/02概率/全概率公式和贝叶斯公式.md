[toc]

## abstract

- 全概率公式和bayes公式及其应用
- 后验概率和信念度量



## 完备事件组(划分)

- 设有限集$I=\{1,\cdots,n\}$;试验$E$的样本空间为$\Omega$
- 若$\{B_i;i\in{I}\}$满足:
  - $\bigcup_{i=1}^{n}B_i=\Omega$
  - $B_iB_j=\varnothing;i\neq j$
- 则称$\{B_i;i\in{I}\}$为$\Omega$的一个**完备事件组**,也称为**划分**


### 基本性质

- 完备事件组$\{B_i;i\in{I}\}$,试验的任意一个样本点(任意一次试验结果)都属于且仅属于某一个$B_i$

## 全概率公式

- 设试验E的样本空间为$S$,$A$为$E$的事件

- $\set{B_i|i\in I}$是一个$S$的划分,$P(B_i)>0,i\in{I}$,则$P(A)=\sum_{i=1}^{n}P(A|B_i)P(B_i)$

  - 那么$P(A)=\sum\limits_{i\in I}P(A|B_i)P(B_i)$

- 证明:

  - 显然$AB_i\sub B_i$,又$B_iB_j=\varnothing$,所以$(AB_i)(AB_j)=A(B_iB_j)=A\emptyset=\emptyset$,$(i\neq{j})$

  - $P(A|B_i)P(B_i)=P(AB_i)$

  - 证法1:

    - $\sum\limits_{i\in I}P(A|B_i)P(B_i)=\sum\limits_{i\in I}P(AB_i)$
      - $=P(AB_1\cup{AB_2}\cup\cdots\cup{A{B_n}})$
      - $=P\left(A\cap\left(\bigcup\limits_{i\in I}B_i\right)\right)$
      - $=P(A\Omega)$
      - $=P(A)$

  - 证法2:

    - $A=AS=A(B_1\cup\cdots\cup{B_n})$=$AB_1\cup\cdots\cup{A{B_n}}$
    - $P(A)$=$P(AB_1\cup\cdots\cup{A{B_n}})$=$\sum_{i=1}^{n}P(AB_i)$=$\sum\limits_{i\in I}P(A|B_i)P(B_i)$

    


### 例

- 某个含有20个球的箱子

  - 含有0,1,2只**次品**的概率分别为0.8,0.1,0.1
    - 记:$A_i$={箱子包含的**残次品**数量为$i$个}
      - $P(A_0)=0.8$
      - $P(A_1)=P(A_2)=0.1$


  - 记$B$={抽中的4件产品都是**正品**}


- 那么发生事件$B$的概率?

  - 显然$A_0,A_1,A_2$构成试验E{观察箱子中的全部球的正品数,样本空间为{0,1,2}}的样本空间的一个划分

  - 而事件$B$进行的试验$F${观察取出的4个抽样品的正品数,样本空间为{0,1,2}}

  - 容易根据古典概型公式计算(因为此时的样本空间已知)以下条件概率(这里不是用条件概率公式展开计算,这会绕回来)

    - $P(B|A_0)=\frac{\binom{20}{4}}{\binom{20}{4}}=1$
    - $P(B|A_1)=\frac{\binom{19}{4}}{\binom{20}{4}}=\frac{(19*18*17*16)*(4*3*2*1)}{(20*19*18*17)*(4*3*2*1)}=\frac{4}{5}$
      - 其中$\Omega_{A_1}=\Omega$

    - $P(B|A_2)=\frac{\binom{18}{4}}{\binom{20}{4}}=\frac{12}{19}$

  - 根据全概率公式$P(B)=\sum\limits_{i=1}^{3}P(B|A_i)P(A_i)=0.943$
  - Note:这里试验$F$的样本空间恰好和E的样本空间重复,但如果箱子中的次品高达4个以上,那么$F$的样本空间${0,1,2,3,4}$是包含于$E$的样本空间的

## 贝叶斯公式



- bayes公式基于上述的全概率公式,是一个更加综合的公式,但是原理是简单的
- 设试验E的样本空间为$S$,$A$为$E$的事件
- $\set{B_i|i\in I}$是一个$S$的划分,$P(A)>0,P(B_i)>0,i\in{I}$,则
  - $P(B_i|A)$=$\frac{P(AB_i)}{P(A)}$=$\frac{P(A|B_i)P(B_i)}{\sum_{j=1}^{n}P(A|B_j)P(B_j)}$;$i=1,\cdots,n$;此公式为bayes公式
- 证明:由条件概率,乘法定理,全概率公式,贝叶斯公式显然成立
  - $P(B_i|A)$=$\frac{P(AB_i)}{P(A)}$
  - $P(AB_i)$=$P(A|B_i)P(B_i)$
    - 注意在bayes公式中,我们要求的是$P(B_i|A)$,因而$P(AB_i)$=$P(B_i|A)P(A)$就不合适,否则公式无法有效计算
    - 而因该用$P(AB_i)$=$P(A|B_i)P(B_i)$来算
  - $P(A)=\sum_{i=1}^{n}P(A|B_i)P(B_i)$

### 例

- 次品来源问题:设一批零件来自三个供应商

  - | 供应商 | 次品率 | 进货份额 |
    | ------ | ------ | -------- |
    | 1      | 0.02   | 0.15     |
    | 2      | 0.01   | 0.80     |
    | 3      | 0.03   | 0.05     |

- 试验内容:从零件中抽取一件

  - A={取到的产品是次品}
  - $B_i$={次品零件来自第$i$个厂商}
    - $P(B_1)$=$0.15$;$P(A|B_1)$=0.02
    - $P(B_2)$=0.80;$P(A|B_2)$=0.01
    - $P(B_3)$=0.05;$P(A|B_3)$=0.03

- 求该样品是次品的概率:

  - 由全概率公式:$P(A)=\sum\limits_{i=1}^{3}P(A|B_i)P(B_i)$=$0.02*0.15+0.01*0.80+0.03*0.05=0.0125$

- 从中取出一件,发现是次品,那么来自产商$i$的概率是多少$(i=1,2,3)$

  - 由贝叶斯公式:
    - $P(B_i|A)=\frac{P(B_iA)}{P(A)}=\frac{P(A|B_i)P(B_i)}{P(A)}$
  - 分别可以计算出:
    - $P(B_1|A)=\frac{0.02*0.15}{0.0125}=0.24$
    - $P(B_2|A)$=$0.64$
    - $P(b_3|A)$=$0.12$



## 对立事件下的常用形式

- 全概率公式和beyes公式在$n=2$的时候(事件$B,\overline{B}$构成样本空间的一个划分)最常用
- 此时分别有:
  - $P(A)=P(AB)+P(A\overline{B})$=$P(A|B)P(B)+P(A|\overline{B})P(\overline{B})$
  - $P(B|A)=\frac{P(AB)}{P(A)}$=$\frac{P(A|B)P(B)}{P(A|B)P(B)+P(A|\overline{B})P(\overline{B})}$

### 例

- 设第1个盒子中有2个红球和1个白球;第2个盒子有红球白球各一半
- 若先从两个盒子各取出一个凑成一对,然后再从这两个球中选一个,
  1. 事件$C$:得到红球的概率?
  2. 发生事件$C$的条件下,事件$D$:这个红球来自第1个盒子的概率?
- 解
- (1)
  - 方法1:
    - 令$A_i$:{最终选出的球来自第$i$各盒子},$i=1,2$
    - 由全概率公式可知$P(C)=\sum_{i=1}^{2}P(C|A_i)P(A_i)$=$\frac{2}{3}\times{\frac{1}{2}}+\frac{1}{2}\times{\frac{1}{2}}$=$\frac{7}{12}$
  - 方法2:
    - 令$A_i$:{从第$i$个盒子中摸出的红球},$i=1,2$
    - 令$B_1=A_1A_2$;$B_2=\overline{A_1}A_2$;$B_3=A_1\overline{A_2}$;$B_4=\overline{A_1}\;\overline{A_2}$
      - $P(B_1)=P(A_1)P(A_2)=\frac{2}{3}\times{\frac{1}{2}}$=$\frac{1}{3}$
      - 类似的,$P(B_2)$=$\frac{1}{3}\times{\frac{1}{2}}$=$\frac{1}{6}$;$P(B_3)$=$\frac{2}{3}\times{\frac{1}{2}}$=$\frac{1}{3}$;$P(B_4)=\frac{1}{3}\times{\frac{1}{2}}$=$\frac{1}{6}$
    - 由全概率公式:$P(C)$=$\sum_{i=1}^{4}P(C|B_i)P(B_i)$=$1\times{\frac{1}{3}}+\frac{1}{2}\times{\frac{1}{6}}+\frac{1}{2}\times{\frac{1}{3}}+0\times\frac{1}{6}$=$\frac{7}{12}$
- (2)
  - 令$A_i$:{从第$i$个盒子中摸出的红球},$i=1,2$
  - 方法1:
    - $P(A_1|C)$=$\frac{P(C|A_1)P(A_1)}{P(C)}$
      - $P(C|A_1)$=$P(C|A_1A_2)P(A_1A_2)+P(C|A_1\overline{A_2})P(A_1\overline{A})$=$1\times{\frac{1}{2}}+\frac{1}{2}\times{\frac{1}{2}}$=$\frac{3}{4}$
    - $P(A_1|C)$=$\frac{\frac{3}{4}\times{\frac{2}{3}}}{7/12}$=$\frac{6}{7}$
  - 方法2:
    - $A_1=A_1A_2+A_1\overline{A_2}$
    - $P(A_1|C)$=$P([A_1A_2+A_1\overline{A_2}]|C)$=$P(A_1A_2|C)P(A_1\overline{A_2}|C)$=$P(A_1A_2C)/P(B)+P(A_1\overline{A_2}C)/P(B)$
      - =$P(C|A_1A_2)P(A_1A_2)/P(B)$+$P(C|A_1\overline{A_2})P(A_1\overline{A_2})/P(B)$
      - =$\frac{6}{7}$

### 例

- 有两个箱子,第一个箱子有$n$件一等品,第二个箱子有$m$件产品且仅含1件一等品
- 从两个箱子中选出一个,再从该箱子先后地取出一个产品
  1. 第一次取出零件是一等品的概率?第2次取出的是一等品的概率?
  2. 若已知第一件取出的是一等品,则第二件仍然是一等品的概率?
- (1)
  - 令$A_i$:选中的箱子是第$i$个箱子(或者$A$:选中的是第1个箱子,$\overline{A}$:选中的是第2个箱子)
  - 令$B_i$:第$i$次取出的是一等品,$i=1,2$
    - $P(B_1)$=$\frac{1}{2}\times{1}+\frac{1}{2}\times{\frac{1}{m}}$=$\frac{m+1}{2m}$
    - $P(B_2)$=$P(B_2|A_1)P(A_1)+P(B_2|A_2)P(A_2)$
      - =$P(B_2|A_1B_1)P(A_1B_1)+P(B_2|A_1\overline{B_1})P(A_1\overline{B_1})$+$P(B_2|A_2B_1)P(A_2B_1)+P(B_2|A_2\overline{B_1})P(A_2\overline{B_1})$
      - $P(B_2|A_1)P(A_1)$=$1\times{\frac{1}{2}}$
      - $P(B_2|A_2)P(A_2)$=$P(B_2|A_2B_1)P(A_2B_1)+P(B_2|A_2\overline{B_1})P(A_2\overline{B_1})$=$0+P(B_2|A_2\overline{B_1})P(\overline{B_1}|A_2)P(A_2)$=$\frac{1}{2m}$
      - $P(B_2)$=$\frac{1}{2}+\frac{1}{2m}$=$\frac{1+m}{2m}$
    - 事实上,如果选中的箱子是第一个箱子,那么两次取球都必能取出一等品;若选中的箱子是第2个箱子,由抽签概型,第一次抽中一等品和第二次抽中一等品的概率都是$\frac{1}{m}$,从而第1次和第2次抽中一等品总是相等的
- (2)
  - 方法1:
    - $P(B_2|B_1)$=$\frac{P(B_1|B_2)P(B_2)}{P(B_1)}$
      - $P(B_1|B_2)$=$P(B_1|A_1B_2)P(A_1B_2)$+$P(B_1|A_2B_2)P(A_2B_2)$=$P(B_1|A_1B_2)P(B_2|A_1)P(A_1)$+$P(B_1|A_2B_2)P(B_2|A_2)P(B_2)$=$1\times1\times{\frac{1}{2}}+0$=$\frac{1}{2}$
      - $P(B_2|B_1)=\frac{1}{2}$
    - 这个方法采用的是bayes公式直接计算,但是会发现计算分子的两个概率不是太直接
    - bayes公式是解决这类我问题的一个模型但是不一定是最简便的,构造更恰当的样本空间和事件可能将求解过程变得简洁
  - 方法2:
    - 令事件$D$:发生$B_1$的条件下发生$B_2$
    - 那么由全概率公式:$P(D)$=$P(D|A_1)P(A_1)+P(D|A_2)P(A_2)$=$1\times{\frac{1}{2}}+0\times{\frac{1}{2}}$=$\frac{1}{2}$
    - 也就是说,事件$D$的发生取决于$A_1$还是$A_2$发生,$A_1$发生则$D$必然发生,否则$D$必然不发生,这$m,n$都没有关系
    - 可见方法2简单直接得多
  - 错误解法:
    - $P(B_2|B_1)$=$\frac{P(B_1B_2)}{P(B_1)}$
      - =$\frac{P(B_1B_2|A_1)P(A_1)+P(B_1B_2|A_2)P(A_2)}{P(B_1)}$=$\frac{m}{m+1}$
      - 这个结果是一个关于$m$的式子,当$m$很大时,$P(B_2|B_1)$几乎一定会发生,这显然是错误的
  - 样本空间分析:
    - S={$(a_1,a_2),\cdots,(a_1,a_n),\cdots,(a_{n-1}a_{n})$,$(b_1,b_2),\cdots,(b_1,b_m),\cdots,(b_{m-1}b_{m})$}
      - 其中$a_i,i=1,\cdots,n$表示第一个箱子中的零件;$b_j,j=1,\cdots,m$表示第二个箱子中的零件
      - $(a_{i_1},a_{i_2}),i_1,i_2=1,\cdots,n$共有$A_n^2$个样本点;$(b_{i_1},b_{i_2}),i_1,i_2=1,\cdots,m$共有$A_m^2$个样本点;
      - 这两类样本点不是等概率发生的,但是同类样本点之间是等概率率发生的,分别是$\frac{1}{2}\times\frac{1}{A_n^2}$;$\frac{1}{2}\times{\frac{1}{A_m^2}}$
      - 不过对于本题这些不重要
    - 令事件$D_1$:$B_1,B_2$都发生了,由样本空间可知,$D=D_1=B_1B_2$,所以$P(D)$=$P(D_1)$=$\frac{1}{2}$
- Note:若第2个箱子中的$m$个样品包含$k$个一等品,则事件$D$的概率?
  - $P(D)=P(D|A_1)P(A_1)+P(D|A_2)P(A_2)$=$1\times{\frac{1}{2}}+\frac{k-1}{m-1}\times\frac{1}{2}$=$\frac{m+k-2}{2(m-1)}$

### 例

- 设3个地区各由10,15,25名考生报名表,其中女生的报名表分别是$3,7,5$份
- 现随机抽取一个地区,然后从该地区的报名表中先后取出2份
  1. 第一份是女生表明表的概率?
  2. 已知第2份是男生表,第1分时女生表的概率?
- 令$A_i$:选中的地区时$i$区,$i=1,2,3$;$B_j$:第$j$份报名表是女生表,$j=1,2$
- 显然$P(A_1)=P(A_2)=P(A_3)=\frac{1}{3}$
  - $P(B_1|A_1)=\frac{3}{10}$;$P(B_1|A_2)=\frac{7}{15}$;$P(B_1|A_3)=\frac{5}{25}$
- (1):由全概率公式:$P(B_1)$=$\sum_{i=1}^{3}P(B_1|A_i)P(A_i)$=$\frac{29}{90}$
- (2):令$D$:$B_2$发生时$B_1$发生
  - $P(D)=\sum_{i=1}^{3}P(D|A_i)P(A_i)$=$\frac{3}{9}\times{\frac{1}{3}}+\frac{3}{9}\times{\frac{7}{14}}$+$\frac{3}{9}\times{\frac{5}{24}}$=$\frac{25}{72}$
  - 方法2:$P(D)$=$\sum_{i=1}^{3}P(B_1|A_i)P(A_i)$=$\frac{25}{72}$



## 先验概率和后验概率

### 例

- 机器与产品合格率问题
- 设机器正常时,生产的产品合格率为0.9,否则合格率为0.3

- 如果机器开机后,正常的概率是0.75(**先验概率**)
- 某天该机器第一件产品是合格的,机器正常的概率是多少?
- 分析:

  - A={第一件产品合格}
  - B={机器正常}
  - 所求概率表达式为:$P(B|A)=?$
- 根据假设可知:
  - $P(A|B)=0.9;P(A|\overline{B})=0.3$
  - $P(B)=0.75,P(\overline{B})=0.25$
    - $B,\overline{B}$构成了样本空间的一个划分(即机器要么正常,要么不正常)
  - 由全概率公式$P(A)={P(A|B)P(B)+P(A|\overline{B})P(\overline{B})}$=$0.9*0.75+0.3*0.25=0.75$
  - 那么根据Bayes公式,$P(B|A)=\frac{P(A|B)P(B)}{P(A)}$=$\frac{0.9*0.75}{0.75}=0.9$,
  - 即第一件产品合格的条件下,机器正常的**后验概率**概率为0.9
- 后验概率是对先验概率的一种修正
- 后验概率和先验概率的解释分为两派
  - 客观派:所有第一件产品是合格的日子里,100天内平均由90天机器是正常的
  - 主观派:反映的是试验前后人们主观上对机器状态的不同信念


## 概率作为衡量人们对客观事件的信念度量

- 以伊索寓言狼来了为例
- $A$={孩子说谎};$B$={孩子可信},假设一个**可信**的孩子**相对不容易说谎,**不妨设这个概率为0.1,即$P(A|B)$=0.1;反之,一个不可信的孩子说谎话的概率为0.5,即$P(A|\overline{B})=0.5$
- 设村民遇到一个可信的孩子的概率为0.8,即$P(B)$=0.8
- 那么孩子说慌话的概率为$P(A)$=$P(A|B)P(B)+P(A|\overline{B})P(\overline{B})$=$0.1\times{0.8}+0.5\times{0.2}$=0.18
- 现在假设孩子说了谎话一次后,由bayes公式计算这个孩子是可信的概率
  - $P(B|A)$=$\frac{P(BA)}{P(A)}$=$\frac{P(A|B)P(B)}{P(A|B)P(B)+P(A|\overline{B})P(\overline{B})}$=$\frac{0.1\times{0.8}}{0.18}$=$\frac{4}{9}\approx{0.444}$
  - 即孩子可信的后验概率降低到了0.444
- 如果孩子再次撒谎,,令$P(B)=0.444$按照上述方式再次计算后验概率:
  - $P(B|A)$=$\frac{0.444\times{0.1}}{0.444\times{0.1}+0.566\times{0.5}}$=$0.138$
- 可见,孩子撒了两次慌后,其可信的后验概率已经降低到了0.138,给人的感觉几乎是一个不可信的人

















