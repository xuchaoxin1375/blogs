[toc]

## 实二次型

- 二次型的理论起源于解系几何中的"二次曲线"和"二次曲面"方程的化简问题

### n元实二次型

- 含有n个未知数的实系数二次齐次多项式

  - $$
    x=\begin{pmatrix}
    	x_{1}\\
    	x_{2}\\
    	\vdots		\\
    	x_{n}	\\
    \end{pmatrix}
    \\x^T=(x_1,x_2,\cdots,x_n)
    \\
    A=\begin{pmatrix}
    	a_{11}  &a_{12}  &\cdots  &a_{1n}  	\\
    	a_{21}  &a_{22}  &\cdots  &a_{2n}  	\\
    	\vdots  &\vdots  &        &\vdots  	\\
    	a_{n1}  &a_{n2}  &\cdots  &a_{nn}  	\\
    \end{pmatrix}
    $$
  
  - $$
    S=x^TAx=
    (x_1,x_2,\cdots,x_n)
    \begin{pmatrix}
    	a_{11}  &a_{12}  &\cdots  &a_{1n}  	\\
    	a_{21}  &a_{22}  &\cdots  &a_{2n}  	\\
    	\vdots  &\vdots  &        &\vdots  	\\
    	a_{n1}  &a_{n2}  &\cdots  &a_{nn}  	\\
    \end{pmatrix}
    \begin{pmatrix}
    	x_{1}\\
    	x_{2}\\
    	\vdots		\\
    	x_{n}	\\
    \end{pmatrix}
    \\
    S=(x_1,x_2,\cdots,x_n)
    \begin{pmatrix}
    	\sum\limits_{j}a_{1j}x_j  	\\
    	\sum\limits_{j}a_{2j}x_j    	\\
    	\vdots   	\\
    	\sum\limits_{j}a_{nj}x_j    	\\
    \end{pmatrix}
    \\
    =\sum_{i}(\sum\limits_{j}a_{ij}x_j)x_i
    =\sum_{i}\sum\limits_{j}a_{ij}x_ix_j
    $$
    
    
    
    $$
    X=xx^T=\begin{pmatrix}
    	x_{1}\\
    	x_{2}\\
    	\vdots		\\
    	x_{n}	\\
    \end{pmatrix}
    (x_1,x_2,\cdots,x_n)
    =\begin{pmatrix}
    x_1x_1&x_1x_2&\cdots&x_1x_n	\\
    x_2x_1&x_2x_2&\cdots&x_2x_n	\\
    \vdots&\vdots&&\vdots\\
    x_nx_1&x_nx_2&\cdots&x_nx_n	\\
    \end{pmatrix}_{n\times{n}}
    \\
    S=A\odot X
    =\begin{pmatrix}
    	a_{11}  &a_{12}  &\cdots  &a_{1n}  	\\
    	a_{21}  &a_{22}  &\cdots  &a_{2n}  	\\
    	\vdots  &\vdots  &        &\vdots  	\\
    	a_{n1}  &a_{n2}  &\cdots  &a_{nn}  	\\
    \end{pmatrix}
    \odot
    \begin{pmatrix}
    x_1x_1&x_1x_2&\cdots&x_1x_n	\\
    x_2x_1&x_2x_2&\cdots&x_2x_n	\\
    \vdots&\vdots&&\vdots\\
    x_nx_1&x_nx_2&\cdots&x_nx_n	\\
    \end{pmatrix}
    \\
    =\begin{pmatrix}
    a_{11}x_1x_1&a_{12}x_1x_2&\cdots&a_{1n}x_1x_n	\\
    a_{21}x_2x_1&a_{22}x_2x_2&\cdots&a_{2n}x_2x_n	\\
    \vdots&\vdots&&\vdots\\
    a_{n1}x_nx_1&a_{n2}x_nx_2&\cdots&a_{nn}x_nx_n	\\
    \end{pmatrix}_{n\times{n}}
    \\其中\odot是hadamard乘积
    $$
    
  - $$
    f(x_1,\cdots,x_n)
    =\sum_{i=1}\sum_{j=1}a_{ij}x_ix_j \quad;(x_ix_j=x_jx_i)
    \\
    =\sum\limits_{1\leqslant {i}< {j}\leqslant{n}}^{}2a_{ij}x_ix_j
    +\sum\limits_{i=j}^{}a_{ij}x_ix_j
    \\
    =x^TAx,(A^T=A)结果是一个数(1\times{1})
    \\
    对于二次型,A^T=A\quad(a_{ij}=a_{ji})
    $$
  
  - 二次型的向量矩阵表示法
    $$
    x=\begin{pmatrix}
    	x_{1}\\
    	x_{2}\\
    	\vdots		\\
    	x_{n}	\\
    \end{pmatrix}
    \\则f(x_1,x_2,\cdots,x_n)=f(x)=x^TAx
    \\其中x为列向量
    $$
    

### 二次型和对称阵

- 给定一个二次型,可以唯一确定一个**对称阵A**;
- 对于一个对称阵A,可以唯一确定一个二次型$x^TAx$
- 二次型和对称阵可以确立一 一对应的关系
  - 对称阵$A$称为二次型$f$的矩阵
  - $f$称为对称阵$A$的二次型

#### 二次型的秩

- 对称阵A的秩$r(A)$称为二次型$f$的秩

#### 利用对称阵研究二次型

- 由于二次型和对称阵关系密切,可以通过研究二次型的对称阵来研究二次型本身

### 例

- $$
  f(x_1,\cdots,x_n)=\sum\limits_{1\leqslant {i}< {j}\leqslant{n}}^{}2a_{ij}x_ix_j
  +\sum\limits_{i=j=k}^{}a_{kk}x_k^2
  $$

  - 这个形式有利于我们从给定的二次型$f$中还原出对称阵A

- 例:$f(x_1,x_2,x_3)=x_1^2-3x_3^2-4x_1x_2+2x_2x_3$

  - $$
    \begin{pmatrix}
    	 1 & & 	\\
    	 &  0& 	\\
    	 & &  -3 	\\
    \end{pmatrix}
    $$

  - $2a_{12}=-4;2a_{23}=2$

  - 解上述方程,并且有对称性得到$a_{12}=a_{21}=-2;a_{23}=a_{32}=1$

  - $$
    \begin{pmatrix}
    1 & -2& 	\\
    -2& 0&1 	\\
    &1&  -3 	\\
    \end{pmatrix}
    $$

  - 其余非对角线元素默认补零,因此得到对称阵A
    $$
    A=\begin{pmatrix}
    1 & -2&0 	\\
    -2& 0&1 	\\
    0&1&  -3 	\\
    \end{pmatrix}
    $$

  - $$
    A\to
    \begin{pmatrix}
    1 & -2&0 	\\
    0&1&-3 	\\
    0&0&-11 	\\
    \end{pmatrix}
    \\
    \therefore r(f)=r(A)=3
    $$

  - $$
    f(x_1,x_2,x_3)=x^TAx=
    (x_1,x_2,x_3)
    \begin{pmatrix}
    1 & -2&0 	\\
    -2& 0&1 	\\
    0&1&  -3 	\\
    \end{pmatrix}
    \begin{pmatrix}
    	x_{1}\\
    	x_{2}\\
    	x_{3}	\\
    \end{pmatrix}
    $$

- 根据矩阵A写出对应的二次型$f$是类似的过程,依然使用上述的公式



## 二次型的标准形🎈

- 二次型中最简单的情况是<u>仅含有平方项</u>的二次型

  - $f(y_1,\cdots,y_n)=\sum_{i}^{n}d_iy_i^2$

- 如果二次型只含有变量的平方项,则称之为**二次型的标准形**

  - 如何通过一个可逆线性变换把二次型化为只含有平方项(而不含交叉项)的二次型?

  - $$
    f(y_1,\cdots,y_n)=\sum_{i}^{n}d_iy_i^2
    \\=(y_1,y_2,\cdots,y_n)
    \begin{pmatrix}
    	d_{1}  &0  &\cdots  &0  	\\
    	0  &d_{2}  &\cdots  &0  	\\
    	\vdots  &\vdots  &        &\vdots  	\\
    	0  &0  &\cdots  &d_{n}  	\\
    \end{pmatrix}
    \begin{pmatrix}
    	y_{1}\\
    	y_{2}\\
    	\vdots		\\
    	y_{n}	\\
    \end{pmatrix}
    \\=y^T\Lambda{y}
    $$

  - 可见,标准形的矩阵$\Lambda=diag(d_1,\cdots,d_n)$


### 二次型可以被可逆变换标准化的条件🎈

- 可逆线性变换$x=Cy$
- $x_i=Cy_i,i=1,\cdots,n$
- 对于$f(x_1,\cdots,x_n)=x^TAx$而言,经过可逆矩阵C做可逆线性变换后得到新二次型$f(y_1,\cdots,y_n)=y^TDy$
  - 其中$D=C^TAC$
  - 根据二次型标准形的矩阵的形式(是一个对角阵),可知,只有当$D=\Lambda$才可能被可逆变换位标准型
  - 这个条件等价于$C^TAC\sim{\Lambda}$,即$A\simeq{\Lambda}$
  - 如果存在某个可逆举着P使得$P^TAP\sim{\Lambda}$,则$f$可以通过可逆线性变换进行标准化
    - 同时,线性变换为$x=Py$
    - 即,若可逆矩阵P能使得$P^{T}AP=\Lambda$,二次型$f$可通过可逆线性变换$x=Py$得到标准化的二次型
  - 如果不存在这样的$P$,则$f$不可被标准化

- 并且$r(\Lambda)$等于$d_1,\cdots,d_n$中的非零值个数

  - $r=\sum\limits_{d_i\neq0}1$

## 标准化方法

### 正交变换法🎈

#### 原理

- 对于二次型$f(x_1,\cdots,x_n)=x^TAx$,一定存在一个正交(可逆)线性变换$x=Qy$,使得$f$可以化为标准形

  - $g(y_1,\cdots,y_n)=\sum\limits_{i=1}^{n}\lambda_iy_i^2,\lambda_i是二次型矩阵A的全部特征值$

- 证明:

  - 二次型的矩阵A满足$A^T=A$,因此一定存在$Q,(Q^TQ=E)$使得$Q^TAQ=\Lambda=diag(\lambda_1,\cdots,\lambda_n)$
    - 根据合同的性质和定理.
  - 对$f(x_1,\cdots,x_n)=x^TAx$按$x=Qy$做正交可逆线性变换:
    - $f=x^TAx=y^T(Q^TAQ)y=y^T\Lambda{y}$


#### 步骤

- 该定理同时也给出使用二次型A标准化的步骤(如果$A\simeq{\Lambda}$)

  - <u>该方法通过计算出一个特定的正交矩阵Q,并用Q来进行线性变换实现得到标准形</u>

  - 求出n元二次型矩阵A的全部特征值$\lambda_i$,它们分别是$n_i$重根(而且对应$n_i$个线性无关的(互异)特征向量)

    - $\sum_{i}^{s}n_i=n$,$i=1,2,\cdots,s$(表示A有s个互异的特征根)

  - 对每个$\lambda_i$求出对应的齐次线性方程组$(\lambda_i{E}-A)x=0$的基础解系$\Phi_i$(包含$n_i$个线性无关向量)

    - $\Phi_{i}=\alpha_1^{(i)},\cdots,\alpha_{n_i}^{(i)}$,$i$表示向量(组)属于特征值$\lambda_i$,包含$n_i$个线性无关的向量

    - 对$\Phi_1,\cdots,\Phi_{s}$**正交化**得到向量组$\Psi=\phi_1,\cdots,\phi_{s}$($\phi_i是\Phi_i$正交化后的向量)

    - 矩阵$Q=(\Psi)$,则$Q$能使$Q^TAQ=\Lambda=diag(\lambda_i,\cdots,\lambda_n)$

    - 做正交线性变换$x=Qy$,$y=(y_1,\cdots,y_n)^T$

      - $$
        f(x_1,\cdots,x_n)\xrightarrow{x=Qy}g(y_1,\cdots,y_n)=\sum\limits_{i=1}^{n}\lambda_iy_i^2
        $$

  



### 配方法

- 标准化不一定要用正交变换法(找到一个特定的正交矩阵),可以用一个一般的可逆矩阵来标准化
- 若二次型$f(x_1,\cdots,x_n)=x^TAx$中含有平方项$x_i^2$(系数$a_{ii}\neq{0}$),$i\in{1,2\cdots,n}$

  - 归并所有含有$x_i$的项

    - $$
      \eta_i=a_{ii}x_{i}^2+\sum_{j=1,j\neq{i}}^{n}2a_{ij}x_ix_j
      \\=a_{ii}x_i^2+2(\sum_{{j=1,j\neq{i}}}a_{ij}x_j)x_i
      $$

  - 然后进行配方

    - $$
      \eta_{i}=a_{ii}(x_i^2+\frac{1}{a_{ii}}2(\sum_{{j=1,j\neq{i}}}a_{ij}x_j)x_i)
      \\=a_{ii}(x_i+\frac{1}{a_{ii}}
      (\sum\limits_{{j=1,j\neq{i}}}a_{ij}x_j))^2
      -a_{ii}(\sum\limits_{{j=1,j\neq{i}}}a_{ij}x_j))^2
      \\
      $$
    - 

- 若二次型f中不含平方项$x_i^2,i=1,2,\cdots,n$的系数都为0

  - 执行可逆变换T:

    - $$
      T:\begin{cases}
      x_i=y_i-y_j\\
      x_j=y_i+y_j\\
      x_k=y_k
      \end{cases}
      \\
      k=1,2,\cdots,n,k\neq{i,j}
      \\这使得:x_ix_j=(y_i-y_j)(y_i+y_j)=y_i^2-y_j^2
      $$


- 任何二次型都可以用配方法找到可逆线性变换,将其化为标准形
- 标准形种含有的项数等于二次型(矩阵)的秩(前面讨论过)

### 例

- $f(x_1,x_2,x_3)=4(x_1^2+x_2^2+x^3+x_1x_2+x_1x_3+x_2x_3)$

- $$
  f(x_1,x_2,x_3)=4(x_1^2+x_1(x_2+x_3)+x_2^2+x_3^2+x_2x_3)
  \\=4[(x_1+\frac{1}{2}x_1(x_2+x_3))^2-\frac{1}{4}(x_2+x_3)^2+x_2^2+x_3^2+x_2x_3]
  \\=4(x_1+\frac{1}{2}(x_2+x_3))^2-(x_2^2+2x_2x_3+x_3^2)+4(x_2^2+x_3^2+x_2x_3)
  \\=4(x_1+\frac{1}{2}(x_2+x_3))^2+3x_2^2+3x_3^2+2x_2x_3
  \\=4(x_1+\frac{1}{2}(x_2+x_3))^2+3(x_2^2+\frac{2}{3}x_2x_3)+3x_3^2
  \\=4(x_1+\frac{1}{2}(x_2+x_3))^2+3[(x_2+\frac{1}{3}x_3)^2-\frac{1}{9}x_3^2]+3x_3^2
  \\=4(x_1+\frac{1}{2}(x_2+x_3))^2+3(x_2+\frac{1}{3}x_3)^2)-\frac{1}{3}x_3^2+3x_3^2
  \\=4(x_1+\frac{1}{2}(x_2+x_3))^2+3(x_2+\frac{1}{3}x_3)^2+\frac{8}{3}x_3^2
  $$

- $$
  令
  \begin{aligned}
  y_1=&x_1+\frac{1}{2}(x_2+x_3)
  \\
  y_2=&x_2+\frac{1}{3}x_3
  \\
  y_3=&x_3
  \end{aligned}
  \\
  f=g(y_1,y_2,y_3)=4y_1^2+3y_2^2+\frac{8}{3}y_3^2
  \\反解出x,即可得f\to{g}所用的线性变换x=Qy
  \\
  \begin{aligned}
  x_1=&y_1-\frac{1}{2}(x_2+x_3)\\
  =&y_1-\frac{1}{2}(y_2-\frac{1}{3}y_3+y_3)\\
  =&y_1-\frac{1}{2}y_2-\frac{1}{3}y_3
  \\
  x_2=&y_2-\frac{1}{3}y_3
  \\
  x_3=&y_3
  \end{aligned}
  \\
  Q=\begin{pmatrix}
  1&-\frac{1}{2}&-\frac{1}{3}\\
  0&1&-\frac{1}{3}\\
  0&0&1
  \end{pmatrix}
  \\
  |Q|=1
  $$

#### 例

- $f(x_1,x_2,x_3)=x_1x_2+x_1x_3+2x_2x_3$

  - 对于$x_1x_2$

    - $$
      T:\begin{cases}
      x_1=y_1-y_2\\
      x_2=y_1+y_2\\
      x_3=y_3
      \end{cases}
      \\
      T=\begin{pmatrix}
      1&1&0\\
      1&-1&0\\
      0&0&1
      \end{pmatrix}
      $$

    - 把T带入$f$;

      - $$
        f=(y_1-y_2)(y_1+y_2)+(y_1-y_2)y_3+2(y_1+y_2)(y_3)
        \\=y_1^2-y_2^2+y_1y_3-y_2y_3+2y_1y_3+2y_2y_3
        \\=y_1^2-y_2^2+3y_1y_3+y_2y_3
        $$

      - 问题转换为第一种类型

      - $$
        g(y_1,y_2,y_3)=(y_1+\frac{3}{2}y_3)^2-(y_2+\frac{1}{2}y_3)^2-2y_3^2
        $$

      - 令
        $$
        \\
        \begin{cases}
        z_1=y_1+\frac{3}{2}y_3\\
        z_2=y_1+\frac{1}{2}y_3\\
        z_3=y_3
        \end{cases}
        \\
        f=z_1^2-z_2^2-2z_3^2
        \\
        \\
        反解:
        \begin{cases}
        y_1=z_1-\frac{3}{2}z_3\\
        y_2=z_2-\frac{1}{2}z_3\\
        y_3=z_3
        \end{cases}
        \\
        Q=\begin{pmatrix}
        1&0&-\frac{3}{2}\\
        0&1&-\frac{1}{2}\\
        0&0&1
        \end{pmatrix}
        $$

      - $$
        C=TQ
        =\begin{pmatrix}
        1&1&0\\
        1&-1&0\\
        0&0&1
        \end{pmatrix}
        \begin{pmatrix}
        1&0&-\frac{3}{2}\\
        0&1&-\frac{1}{2}\\
        0&0&1
        \end{pmatrix}
        =\begin{pmatrix}
        1&1&-{2}\\
        1&-1&-1\\
        0&0&1
        \end{pmatrix}
        \\
        x=Cz
        $$

        

### 初等变换法

- 任意实对称阵A都合同于对角阵
  - 存在可逆矩阵$P$,使得$P^TAP=\Lambda$
    - (事实上一定存在可逆正交矩阵Q),使得$Q^TAQ=\Lambda$,当然也就存在可逆矩阵能使$P^TAP=\Lambda$
  - 由于P可逆,所以可以记$P=P_1P_2\cdots{P_s}$,其中$P_i,i=1,2,\cdots,s$为初等矩阵
    - 而初等矩阵的转置也是初等矩阵,从而$P_1^T,\cdots,P_s^T$也都是初等矩阵
  - 从而$(P_1P_2\cdots,P_s)^TA(P_1P_2\cdots,P_s)=\Lambda$
    - $P_s^T\cdots P_2^TP_1^T A P_1P_2\cdots P_s=\Lambda$
      - 这个式子表明,我们可以通过**成对**的行列变换将对称阵A变换为一个对角阵$\Lambda$
        - 初等变换包括:交换,倍乘,倍加,不妨将它们分别记为$u_1,u_2,u_3$操作
          - 对于行变换,则具体为$Ru_1,Ru_2,Ru_3$,等价于左乘某个初等矩阵$P_j$
          - 对于行变换,则具体为$Cu_1,Cu_2,Cu_3$,等价于右乘初等矩阵$P_j^T$
        - 那么成对的行列变换可以理解为,对方阵A执行一次$Ru_i$操作,就要跟上一个$Cu_i$操作,$i=1,2,3$
    - $P=EP_1P_2\cdots{P_s}$
      - 由$P=P_1P_2\cdots{P_s}$,可知,我们可通过一个单位阵E,把上述$A\to\Lambda$变换所执行的所有右乘初等矩阵$P_i$单独记录下来($EP_1P_2\cdots{P_s}=EP=P$)
- 总结初等变换法的步骤:
  - 构造松散分块矩阵$\binom{A}{E}$
    - 之所以称为松散,因为我们在将$A$变换为$\Lambda$时,E只需要接收列变换$P_1P_2\cdots{P_s}$,而不需要做行变换
  - 当$A$被一系列成对的初等行列变换转为对角阵$\Lambda$,则下方的$E$也就变成了$P=P_1P_2\cdots{P_s}$
  - 因此P和$\Lambda$是同时被求解出来:
  - 得到的P就是能够满足$P^{T}AP=\Lambda$(即,使二次型标准化)的可逆矩阵,对应的线性变换为$x=Py$



















