# 线性方程组解的结构

- n元线性方程组是包含n个位置量的线性方程组,它的解是一个n为向量,称为线性方程组的**解向量**
- 当线性方程组的解不唯一时(,同一个)线性方程组的解向量之间具有一定关系(规律)

## 齐次线性方程🎈

- $Ax=0$,如果$\eta_1,\eta_2$都是线性方程组$Ax=0$的解向量,那么对于$\eta_3=k_1\eta_1+k_2\eta_2$也是方程组$Ax=0$的解
  - 因为$A\eta_i=0,i=1,2$
    - $A\eta_3=A(\sum\limits_{i=1}^{2}k_i\eta_i)=\sum\limits_{i=1}^{2}k_iA\eta_i$
      - $k_iA\eta_i=0$
      - $A\eta_3=0$
  - 类似的,可以得到,齐次线性方程组的解的线性组合还是方程组的解
- 事实上,齐次线性方程组的全部解可以由有限个解向量(的线性组合)表示

### 基础解系@通解

- **齐次**线性方程组$Ax=0$的一组解$\Phi=\eta_1,⋯,\eta_s$在满足:
  - $\Phi$线性无关
  - $Ax=0$任意解均可被$\Phi$线性表示($\Phi$中的向量当然也可以用$\Phi$线性表示)
    - 这个条件的另外2中等价描述:
      - 加入任意解向量$\eta$使得$\Psi=\Phi∪\eta$线性相关
      - 设$r(A)=r$,则$\Phi$中包含的向量个数是$n-r$个

#### 换句话说

- 把$Ax=0$**全体解**所构成的集合记为$S$,设$\Phi=\eta_1,\cdots,\eta_s$是S的一个极大无关组,$r(A)=r,s=n-r$
  - A的任何一个极大无关组都是$Ax=0$的**基础解系**
  - $Ax=0$的任意解都可以由全解集S的任何一个最大无关组线性表示
- **通解**:最大无关组$\Phi$的任意向量$x=\Phi(k_1,\cdots,k_s)^T=\sum\limits_{i=1}^{s}k_i\eta_i$性组合都是方程$Ax=0$的解
  - **通解**(是$\Phi$的生成子空间)
  - 齐次线性方程组的通解可以描述(表出)方程组的任意一个解
- 齐次线性方程组$Ax=0$的解集的极大无关组称为该齐次方程组的**基础解系**,要求<u>齐次线性方程</u>的通解,只需要求它的基础解系

#### 不唯一性

- 一个齐次方程的基础解系不是唯一的
  - 齐次线性方程的任意一个极大无关组都是该方程的基础解系
  - (基础解系之间相互等价,它们可以相互表出)

### 定理

- 如果$Ax=0$有非零解的情况下,一定存在基础解系$\Phi$,且$\Phi$所含的向量的个数为$s=n-r$

  - $r$表示系数矩阵的秩

  - n表示方程含有的未知量个数

  - 证明

    - 若$r(A)=n$,$Ax=0$只有零解,不存在基础解系

    - 若$r(A)<n$,$Ax=0$存在非零解

      - 解的表达式结构可以参考上一节的内容

      - $$
        x_i=-\sum\limits_{k=1}^{s} c_{i,r+k}\times x_{r+k};
        (i=1,2,\cdots,r)
        \\
        p=\begin{pmatrix}
        	x_{1}  	\\
        	\vdots \\
        	x_{i}  	\\
        	\vdots	\\
        	x_{r}  	\\
        \end{pmatrix}
        =\begin{pmatrix}
        	-\sum\limits_{k=1}^{s} c_{1,r+k}\times x_{r+k}   	\\
        	\vdots \\
        	-\sum\limits_{k=1}^{s} c_{i,r+k}\times x_{r+k}  	\\
        	\vdots	\\
        	-\sum\limits_{k=1}^{s} c_{r,r+k}\times x_{r+k}  	\\
        \end{pmatrix}
        $$

        

    - 向量$x_1,\cdots,x_r$称为**非自由变量**

    - 向量$x_{r+1},\cdots,x_{n}$称为**自由变量**(共有n-r个)

    - 非自由变量有自由变量线性组合表出

      - s=n-r描述了方程组$Ax=0$的自由度(基础解系包含的线性无关向量的多样性)

    - $Ax=0$特解(为了形式上简单)可以取自由变量为s维单位向量(向量中只含有一个0,1两种元素,且只有一个元素是1)

      - $$
        \\
        q=\begin{pmatrix}
        	x_{r+1}  	\\
        	\vdots	\\
        	x_{n}  	\\
        \end{pmatrix}
        \\
        q_1=\begin{pmatrix}
        	1  	\\
        	0	\\
        	\vdots	\\
        	0  	\\
        \end{pmatrix};
        q_2=\begin{pmatrix}
        	0 	\\
        	1	\\
        	\vdots	\\
        	0  	\\
        \end{pmatrix};
        \cdots;
        q_s=\begin{pmatrix}
        	0 	\\
        	0\\
        	\vdots	\\
        	1 	\\
        \end{pmatrix}
        \\则p_1=\begin{pmatrix}
        -c_{1,r+1}\\
        -c_{2,r+1}\\
        \cdots\\
        -c_{r,r+1}
        \end{pmatrix};
        p_2=\begin{pmatrix}
        -c_{1,r+2}\\
        -c_{2,r+2}\\
        \cdots\\
        -c_{r,r+2}
        \end{pmatrix};
        \cdots;
        p_s=\begin{pmatrix}
        -c_{1,n}\\
        -c_{2,n}\\
        \cdots\\
        -c_{r,n}
        \end{pmatrix};(n=r+s)
        $$

      - $$
        x=\binom{p}{q}
        \\
        \eta_1=\begin{pmatrix}
            -c_{1,r+1}\\
            -c_{2,r+1}\\
            \cdots\\
            -c_{r,r+1}\\
        	1  	\\
        	0	\\
        	\vdots	\\
        	0  	\\
        \end{pmatrix};
        \eta_2=\begin{pmatrix}
            -c_{1,r+2}\\
            -c_{2,r+2}\\
            \cdots\\
            -c_{r,r+2}\\
        	0  	\\
        	1	\\
        	\vdots	\\
        	0  	\\
        \end{pmatrix};
        \cdots;
        \eta_s=\begin{pmatrix}
            -c_{1,n}\\
            -c_{2,n}\\
            \cdots\\
            -c_{r,n}\\
        	0  	\\
        	0	\\
        	\vdots	\\
        	1  	\\
        \end{pmatrix};
        $$

      - $\Phi=\eta_1,\cdots,\eta_s$是方程$Ax=0$**全解集S**的形式最简单的一个极大无关组)

        - 注意是非零解,否则不是极大无关组

      - 证明极大无关性;

        - 由$\eta_i$的结构可以看出,$\eta_i$的后s维是构成的向量之间是线性无关的(单位向量)
        - 而线性无关组的延伸组依然线性无关
        - 设向量$\eta=(k_1,\cdots,k_r,k_{r+1},\cdots,k_n)$是$Ax=0$的一个解,
          - 同时构造向量$\eta^*=\sum\limits_{i=1}^{s}k_i\eta_i$根据性质可知,$\eta^*$也是$Ax=0$的解
          - 容易发现,$\eta^{*}$和$\eta$在第$r+1,\cdots,n$维是相同的
          - 又根据前面的分析,$Ax=0$的解向量拒绝与自由变量的取值(非自由变量由自由变量唯一决定)
          - 所以后s维相同的解向量,前r维也相同,即$\eta^*=\eta$
        - 可见,$\Phi=\eta_1,\cdots,\eta_s$可以表出任意一个$Ax=0$的解向量
          - 这等价于$\Phi$是关于S的一个极大无关组
            - 因为$\Phi$和$S$可以相互表出,($\Phi$是S的部分组,同时它们等价)
            - 所以$r(\Phi)=r(S)=r$,$\Phi$是S的一个极大无关组

### 小结

- 可以从$Ax=0$的系数矩阵A通过初等变换转化为(包含r阶单位子阵,r=r(A))的**强化行简化矩阵**U,

  - 明确$r=r(A),s=n-r$

  - $$
    U=\begin{pmatrix}
    E_{r\times{r}}&T_{r\times{s}}\\
    0_{t\times{r}}&0_{t\times{s}}
    \end{pmatrix}
    \\
    r+s=n
    \\
    (\eta)=\begin{pmatrix}
    -T_{r\times{s}}
    \\
    E_{s\times{s}}
    \end{pmatrix},其中\eta=\eta_1,\eta_2,\cdots,\eta_s
    \\(\eta)就是由解向量构成的矩阵
    $$

    - 我们把注意力集中在分块$P_{r\times{s}}=-T_{r\times{s}}$上即可,在此基础上,追加一个s阶的单位阵;最终该矩阵的每个列向量就是基础解系的一个解向量成员

    - $$
      (\eta)^T=
      \begin{pmatrix}
      -T\\
      E
      \end{pmatrix}^T
      =(-T^T,E^T)
      \\
      (\eta)=(-T^T,E^T)^T=(-T^T,E)^T,这是另一种书写方式
      $$

  - 将行简化矩阵进一步调整为$U$的形式可能要做列交换,这会使得解向量中的元素不在和$x_1,\cdots,x_n$一一对应,需要注意这一点

    - 记录列交换的情况,然后调整顺序使之对应$x_1,\cdots,x_n$
    - 或者用高斯消元法(初等行变化)化简到行简化矩阵后,直接开始用代入法求解)


## 非齐次线性方程组解的结构

### 导出组

- 将非齐次线性方程组$Ax=b$改写为$Ax=0$构成的同系数矩阵的齐次线性方程组称为$Ax=b$的导出组

- 导出组的解和被导出组的解由密切关系

- 设$\eta_1,\eta_2$是$Ax=b$的两个解;$\eta$是$Ax=0$的解,则

  - $\eta_1-\eta_2$是$Ax=0$的解
  - $\eta_1+\eta$是$Ax=b$的解

  - 证明
    - $A\eta_1=b;A\eta_2=b$
      - 显然,$A\eta_1-A\eta_2=0$
      - 所以$A(\eta_1-\eta_2)=0,\eta_1-\eta_2$是$Ax=0$的解
      - $A(\eta_1+\eta)=b+0$,因此$\eta_1+\eta$是$Ax=b$的解(同理,$\eta_2+\eta$也是是$Ax=b$的解)



- 设$\eta^*$是方程$Ax=b$的一个解,$\Phi=\eta_1,\eta_2,\cdots,\eta_s$是$Ax=0$的基础解系,则
  - $\eta^*+\sum\limits_{i}^{s}k_i\eta_i$是方程$Ax=b$的通解
    - 其中$k_1,\cdots,k_s$为任意常数
  - 证明:
    - 设$Ax=b$的任意一个解为$x$,则$x,\eta^*$都是$Ax=b$的解
    - 从而$\eta=x-\eta^*$是$Ax=0$的一个解,它可以用$\Phi$线性表示:$\eta=\sum\limits_{i}^{s}k_i\eta_i$
    - $Ax=b$的任意解$x$可以表示为$x=\eta+\eta^*=\sum\limits_{i}^{s}k_i\eta_i+\eta^*$
    - 也即是说$\eta^*+\sum\limits_{i}^{s}k_i\eta_i$,是$Ax=b$的通解
- 推论:当$Ax=b$有解时,"$Ax=b$只有唯一解"是"$Ax=0$只有唯一零解"的充要条件.
  - 该命题的逆否命题为:当$Ax=b$有解时,"$Ax=0$具有非零解"是"$Ax=b$具有多解"的充要条件
  - 原命题证明:
    - 充分性
      - 如果$Ax=b$具有多解$\eta_1,\eta_2,\cdots$,则$\eta=\eta_1-\eta_2$是$Ax=0$的解,
      - 因为$\eta_1\neq\eta_2$,所以$\eta\neq{0}$,因此$Ax=0$具有非零解
      - 也就是说,若$Ax=b$具有多解,则$Ax=0$具有非零解
      - 其逆否命题为"$Ax=0$只有零解"则"$Ax=b$"只有唯一解
    - 必要性:$Ax=0$只有零解$\Rightarrow{Ax=b}$有唯一解
      - 反证:如果$Ax=0$有非零解$\eta_0$,则由$Ax=b$有解$\eta_1$可知,$\eta=\eta_0+\eta_1$也是$Ax=b$的解
      - 因此,当$Ax=b$有解时,若$Ax=0$有非零解,则$Ax=b$一定有多解
      - 由逆否命题可知,所以必要性得证

### 小结

- 求非齐次线性方程组$Ax=b$的工作包含了求导出组的通解(基础解系)的工作

  - 设A是$m\times{n}$的矩阵

- 首先,$Ax=b$的一个特解可以通过高斯消元法求得.

- 再计算$Ax=0$的通解

  - 其中A的增广矩阵$\overline{A}=(A|b)$在化简为行简化矩阵后结果的前n列与单独对A化简为行简化矩阵的结果一样,因此不需要对A再次化简,直接计算$Ax=0$的通解
  - 上述规律是由行接替矩阵的性质决定的

- 然后加上$Ax=0$的通解得到$Ax=b$的通解


## 例

- $$
  \\
  A=\begin{pmatrix}
  	1&	-1&	0&	1&	-1	\\
  	2&	0&	1&	0&	-1	\\
  	3&	-1&	-1&	-1&	-1	\\
  \end{pmatrix}
  \\
  b=
  \begin{pmatrix}
  	1	\\
  	2	\\
  	0	\\
  \end{pmatrix}
  \\
  Ax=b
  增广矩阵为:
  \\
  \overline{A}=\begin{pmatrix}
  	1&	-1&	0&	1&	-1&	1	\\
  	2&	0&	1&	0&	-1&	2	\\
  	3&	-1&	-1&	-1&	-1&	0	\\
  \end{pmatrix}
  \rightarrow
  U=U(\overline{A})=\begin{pmatrix}
  	1&	0&	0&	-\frac{1}{2}&	-\frac{1}{4}&	\frac{1}{4}	\\
  	0&	1&	0&	-\frac{3}{2}&	\frac{3}{4}&	-\frac{3}{4}	\\
  	0&	0&	1&	1&	-\frac{1}{2}&	\frac{3}{2}	\\
  \end{pmatrix}
  \\
  容易看出,非自由变量由r=3个,由n-r=5-3=2个自由变量决定
  \\为例简单起见,我们将自由变量x_4,x_5全部取0
  \\从而该非齐次线性方程Ax=b的一个最简单特解就是
  \eta^*=\begin{pmatrix}
  \frac{1}{4}\\
  -\frac{3}{4}\\
  \frac{3}{2}\\
  0\\
  0
  \end{pmatrix}
  \\
  \\记U=U(\overline{A})是矩阵\overline{A}化简为行简化矩阵后的等价形式(包含r阶单位子阵)
  \\那么U的最后一列再添补s=n-r个0所构成的向量就是Ax=b的一个解向量(特解)
  $$

- 再求$Ax=0$的一个基础解系

  - 从矩阵$U(\overline{A})$可以看出$U(A)$,

    - $$
      U(A)=U=U(\overline{A})=\begin{pmatrix}
      	1&	0&	0&	-\frac{1}{2}&	-\frac{1}{4}	 	\\
      	0&	1&	0&	-\frac{3}{2}&	\frac{3}{4}	 	\\
      	0&	0&	1&	1&	-\frac{1}{2}	\\
      \end{pmatrix}
      =(E_3,T_{3\times{2}})
      $$

  - 因此可以立即得到$Ax=0$的通解,($r=3,s=n-r=5-3=2$)

    - $$
      (\eta)=\begin{pmatrix}
      \frac{1}{2}&\frac{1}{4}\\
      \frac{3}{2}&-\frac{3}{4}\\
      -1			&\frac{1}{2}\\
      1&0\\
      0&1
      \end{pmatrix}
      $$

    - 实际上为例书写紧凑,可以写成行向量转置的形式:

      - $$
        (\eta)=(-T^T,E)^T=
        \begin{pmatrix}
        \frac{1}{2}&\frac{3}{2}&-1	&1&0			\\
        \frac{1}{4}&-\frac{3}{4}&\frac{1}{2}	&0&1
        \end{pmatrix}^T
        \\
        \eta_1=(\frac{1}{2},\frac{3}{2},-1,1,0)^T
        \\
        \eta_{2}=(\frac{1}{4},-\frac{3}{4},\frac{1}{2},0,1)^T
        $$

        

  - 因此$Ax=b$的通解为:

    - $$
      \eta=\eta^*+\sum\limits_{i=1}^{2}k_i\eta_i
      \\k_i(i=1,2)为任意常数
      $$

      