[toc]

## 线性方程组一般情况的讨论

一般的线性方程组可以记为

- $$
  A=(a_{ij})_{m\times{n}}(i=1,2,\cdots,m,j=1,2,\cdots{n})
  \\x=(x_j)_{n\times{1}}(j=1,2,\cdots,n)
  \\B=(b_j)_{m\times{1}}(j=1,2,\cdots,m)
  \\对于方程:
  Ax=B
  \\a_{ij}是系数(i表示它是第i个方程,j表示他是x_j的系数);
  \\b_j是常数项;m和n不一定相等
  $$

- 对线性方程组执行初等行变换(高斯消元),可以用阶梯形的增广矩阵表示$\overline{A}=(A|B)$
  $$
  \overline{A}=\begin{pmatrix}
  a_{11} & a_{12} & \cdots  & a_{1 n}&b_1 \\
  a_{12} & a_{22} & \cdots & a_{2 n}&b_2 \\
  \vdots & \vdots & &\vdots  &\vdots\\
  a_{m1} & a_{m2} & \cdots & a_{mn}&b_m \\
  \end{pmatrix}
  $$

- 将增广矩阵$\overline{A}$通过初等行变换,可以得到等价的阶梯形矩阵$D=REF(\overline{A})$

  - $$
    C=REF(\overline {A})=
    \begin{pmatrix}
    c_{11} & c_{12} & \cdots & c_{1 r} & c_{1 r+1} & \cdots & c_{1 n}&d_1 \\
    0 & c_{22} & \cdots & c_{2 r} & c_{2 r+1} & \cdots & c_{2 n}&d_2 \\
    \vdots & \vdots & & \vdots & \vdots & & \vdots &\vdots\\
    0 & 0 & \cdots & c_{r r} & c_{r r+1} & \cdots & c_{rn}&d_r \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0  & d_{r+1}\\
    \vdots & \vdots & & \vdots & \vdots & & \vdots& \vdots \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0& 0
    \end{pmatrix}
    $$

  - C中的$c_{ii}(i=1,2,\cdots,r)$可能是0元素

  - 在$1\sim{n}$列间做一定的**列交换**,可以得到同解等价的矩阵,且可以使得$c'_{ii}(i=1,2,\cdots,r)\neq{0}$,将此时的矩阵记为D

  - $$
    D=REF(\overline {A})=
    \begin{pmatrix}
    c'_{11} & c'_{12} & \cdots & c'_{1 r} & c'_{1 r+1} & \cdots & c'_{1 n}&d_1 \\
    0 & c'_{22} & \cdots & c'_{2 r} & c'_{2 r+1} & \cdots & c'_{2 n}&d_2 \\
    \vdots & \vdots & & \vdots & \vdots & & \vdots &\vdots\\
    0 & 0 & \cdots & c'_{r r} & c'_{r r+1} & \cdots & c'_{rn}&d_r \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0  & d_{r+1}\\
    \vdots & \vdots & & \vdots & \vdots & & \vdots& \vdots \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0& 0
    \end{pmatrix}
    $$

    

- 一般的,可以将D分为两个部分(分块矩阵)

  - $$
    D=
    \begin{pmatrix}
        D_1\\
        D_2
    \end{pmatrix}
    $$

    - $D_1$是$k\times{n}$的矩阵,是D中的非零行部分
    - $D_2$是$s\times{n}$的矩阵,$D_2=\bold{0}_{s\times{n}}$
    - 其中:$k+s=m$,如果方程组有解,那么$k=r$,否则$k=r+1$



### 强化行简化矩阵🎈

- 记U=U(A)是矩阵A通过初等变换化简为"<u>(包含r阶单位子阵)**行简化矩阵**</u>"后的等价形式

  - $$
    U=U(A)=\begin{pmatrix}
    E_{r},X_{r\times{s}}\\
    Y_{t\times{r}},Z_{t\times{s}}
    \end{pmatrix}
    =\begin{pmatrix}
    E_{r},X_{r\times{s}}\\
    0_{t\times{r}},0_{t\times{s}}
    \end{pmatrix}
    \\非零行的前r列构成一个r阶单位方阵,r=r(A),是矩阵A的秩
    \\r+s=n是矩阵A的列数;r+t=m是矩阵的行数
    \\
    并且,X的内容可以是任意的
    \\
    而Y,Z构成非零行,它们所有元素都为0
    $$

- 这种形式很有用

  - 值得注意的是,不是所有矩阵都能够只通过初等行变换就能够得到强化行简化矩阵

  - 有时还需要借助列变换中的**列交换**操作

  - 而做**列交换**的第$i,j$列,意味着它们的系数发生交换,从线性方程组的角度不会影响方程组的解(因为加法满足交换律)

    - $$
      a_{11}x_1+a_{12}x_2=b_1
      \\
      a_{21}x_1+a_{22}x_2=b_2
      \\
      \\
      a_{12}x_2+a_{11}x_1=b_1
      \\
      a_{22}x_2+a_{21}x_1=b_2
      $$

    - 上述两个方程组的解是一样的

    - 但是它们的系数矩阵却不一样(列的顺序颠倒了)

  - 而从系数矩阵角度会未知数的解对应关系出现错位问题


### 对2大类情况的讨论🎈

- cases1:$d_{r+1}\neq{0}$

  - 该行方程无解,即整个方程组无解

- cases2:$d_{r+1}=0$

  - 方程组有解

  - case2.1:非零行数r与未知数个数n相等:$r=n$,则方程组有唯一解

  - case2.2:非零行数r小于未知数个数n:$r<n$,方程组有多解

  - 行阶梯形矩阵D再执行一系列的行变换得到Q(形式上更有规律的行简化阶梯矩阵):

  - $$
    Q_{m\times{n}}=\begin{pmatrix}
    1 & 0 & \cdots & 0 & c'_{1,r+1} & \cdots & c'_{1 n} &d'_1\\
    0 & 1 & \cdots & 0 & c'_{2,r+1} & \cdots & c'_{2 n} &d'_2\\
    \vdots & \vdots & & \vdots & \vdots & & \vdots &\vdots\\
    0 & 0 & \cdots & 1 & c'_{r,r+1} & \cdots & c'_{rn}&d'_r \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0 &0\\
    \vdots & \vdots & & \vdots & \vdots & & \vdots&\vdots \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0&0
    \end{pmatrix}
    =\begin{pmatrix}
    E_{r\times{r}}&T_{r\times{t}}\\
    0_{s\times{r}}&0_{s\times{t}}
    \end{pmatrix}
    \\r+s=m;r+t=n
    $$

  - $Ax=0$和$Qx=0$是同解的,可以通过分析Q对应的方程组的解的情况

    - 此处的同解是忽略了解向量顺序的情况,例如$(x_1,x_2)$和$(x_2,x_1)$
    - 或者说,通过排列6Q的解向量,可以得到A相同的解向量

#### 自由未知量和通解形式🎈

- $$
  \\
  x_i=d'_i-\sum\limits_{k=1}^{s} c'_{i,r+k}\times x_{r+k} 	\\
  \\
  \begin{pmatrix}
  	x_{1}  	\\
  	\vdots \\
  	x_{i}  	\\
  	\vdots	\\
  	x_{r}  	\\
  \end{pmatrix}
  =\begin{pmatrix}
  	d'_1-\sum\limits_{k=1}^{s} c'_{1,r+k}\times x_{r+k}   	\\
  	\vdots \\
  	d'_i-\sum\limits_{k=1}^{s} c'_{i,r+k}\times x_{r+k}  	\\
  	\vdots	\\
  	d'_r-\sum\limits_{k=1}^{s} c'_{r,r+k}\times x_{r+k}  	\\
  \end{pmatrix}
  $$

- 由此可见,任意给定一组$(x_i)_{1\times{s}},i=r+1,r+2,\cdots{n=r+s}$,将$x_{r+1},x_{r+2},\cdots,x_{n}$称为**自由未知量**,可以唯一确定$(x_i)_{1\times{r}}=x_1,x_2,\cdots,x_r$的值,这样的一组表达式称为方程组的**通解**或**一般解**

#### 不可能的情况🎈

- Note:$r>n$这种情况是不可能出现的
  - 对于阶梯形矩阵而言,其非零行的行数r不超过矩阵的行数和列数最小值$min(m,n)$
    - 阶梯形矩阵的第i行包含的零元素至少为$i-1$个
    - 则当r=n时,第r行至少包含$r-1=n-1$个零元素
    - 当$r\geqslant{n+1}$时,第r行包含n个元素,也就是说第r=n+1行必定是一个全0行,而不是非零行
    - 所以对于$m\times{n}$的行阶梯形矩阵,非零行数r(也就是秩)满足$r\leqslant{n}$

### 另一个描述版本🎈

这个版本参考自同济版教材

- 无解:

  1. 无解的充分必要条件是$R(A)<R(A,\boldsymbol{b})$

- 有解

  1. 有唯一解的充要条件是$R(A)=R(A,\boldsymbol{b})=n$
  2. 有无限多解的充分条件是$R(A)=R(A,\boldsymbol{b})<n$

- 证明:

  - 只需要证明**条件**的**充分性**

  - 设$R(A)=r$,$B=(A,\boldsymbol{b})$的行最简形矩阵为$\widetilde{B}$:

    - $$
      \widetilde{B}=
      \begin{pmatrix}
      1&0&\cdots &0&b_{11}&\cdots&b_{1,n-r}&d_{1}\\
      0&1&\cdots&0&b_{21}&\cdots&b_{2,n-r}&d_{2}\\
      \vdots&\vdots&&\vdots&\vdots&&\vdots&\vdots\\
      0&0&\cdots&1&b_{r1}&\cdots&b_{r,n-r}&d_{r}\\
      0&0&\cdots&0&0&\cdots&0&d_{r+1}\\
      0&0&\cdots&0&0&\cdots&0&0\\
      \vdots&\vdots&&\vdots&\vdots&&\vdots&\vdots\\
      0&0&\cdots&0&0&\cdots&0&0\\
      \end{pmatrix}
      $$

      

  - 若$R(A)<R(B)$,则$\widetilde{B}$中的$d_{r+1}\neq{0}$(由于是行最简矩阵,所以$d_{r+1}=1$)

    - 于是$\widetilde{B}$的第$r+1$行对应矛盾方程$0=1$,所以方程组无解

  - 若$R(A)=R(B)=k$,方程组有解

    - 若$k=n$,则方程组有唯一解,并且可以确定唯一解的计算公式

      - $$
        x_{i}=d_{i}-\sum_{j=1}^{n-r}b_{ij}x_{i,r+j}
        $$

    - 若$k=r$,把行最简形中r个非0行的收非0元素所对应的未知数取作**非自由未知数**

      - 其余$n-r$个未知数作**自由未知数**

      - 令自由未知数分别等于$c_{1},\cdots,c_{n-r}$

      - 由$B$是最简形矩阵,可以得到$n-r$个参数的通解

#### $R(B)\geqslant{R(A)}$

- 由于$B=(A,\boldsymbol{b})$,根据矩阵秩的性质,$R(B)\geqslant{R(A)}$
  - 明确这一点有利于讨论带参数的线性方程组的解的情况

#### 例

- 假设某个3方程3未知数的线性方程组的增广矩阵表示为:

- $$
  B=\begin{pmatrix}
  1+\lambda&1&1&0\\
  1&1+\lambda&1&3\\
  1&1&1+\lambda&\lambda
  \end{pmatrix}
  $$

- 经过一系列的初等行变换后,得到:
  $$
  \begin{pmatrix}
      1&1&1+\lambda&\lambda\\
      0&\lambda&-\lambda&3-\lambda\\
      0&0&-\lambda(3+\lambda)&(1-\lambda)(3+\lambda)
  \end{pmatrix}
  $$

- case1:$R(A)=3$,则$R(A)=R(B)=3$,方程组有唯一解

  - 此时$-\lambda(3+\lambda)\neq{0}$
    - 即$\lambda\neq{0}$且$\lambda\neq{-3}$
    - 注意,我们不需要计算:~~而$(1-\lambda)(3+\lambda)\neq{0}$:$\lambda\neq{1}$且$\lambda\neq{-3}$~~
    - 因为,增广矩阵的秩一定大等于被增广的矩阵的秩

- cases2:$R(A)=2$,则

  - 此时A的第三行为全0,即$-\lambda(3+\lambda)=0$
    - $\lambda=0$时,$R(A)=1,R(B)=3$,显然$R(A)\neq R(B)$方程组无解
    - $\lambda=-3$时$R(A)=R(B)=2<n=3$,方程组有无穷多解

- case3:$R(A)=1$:

  - 注意到第二行不可能是0行,因为$\lambda=-\lambda=3-\lambda$无解,所以这种情况不可能出现
  - note,假设能够出现,则需要考虑:
    - $R(B)=1$
    - $R(B)=2$
    - $R(B)=3$

#### 带参数线性方程组解的分析思路小结

- 由于线性方程组是否有解(解的情况)取决于$R(A)$和$R(B)$
- 为方便讨论,假设方程组含有m个方程,n个未知数
- 首先将矩阵化为行简化行阶梯形矩阵
- 因此,可以分析$R(A)$的所有可能取值(假设有m种),那么将m个值作为m种情况进行讨论
  - 这其中某些情况可能会被直接否定例如带有常数(非参数)的行肯定对R(B)的大小作正贡献(也可能对R(A)作正贡献),那么可以适当的分析后减小m的值
  - 对于前n列部分(若某行可能是全0行,将每个带参数元素令为0,计算出所有的参数值(具体的值)
  - 分别根据这些具体的参数值计算**R(B)**
  - 比较$R(A),R(B),n$判断方程组的解的情况

#### 对于方程个数和未知数格式相等的情况

- 这类情况$A$系数矩阵是方阵,可以考虑使用行列式来求解
- 因为行列式$|A|\neq{0}$表示方程仅有唯一解(此时保证有$R(A)=R(B)=n$)
  - 虽然我们方阵系数行列式只能确定这一种情况,但是依然可以求解出所有其他情况
  - 先求出该情况下的具体参数值(例如得到有限个具体值$\lambda_1,\lambda_2,\cdots$)
  - 分别将这些具体的参数带入到矩阵中,得到无参数的参数矩阵,依次求解这些矩阵,所得到的结果即包含了所有可能的情况(唯一解情况和非唯一解情况(无解和多解))

### 带参数的矩阵的初等变换要点

- 假设$f(\lambda)$是关于$\lambda$的表达式,那么形如$r_i\times{\frac{1}{f(\lambda)}}$这类变换有一个前提(假设):$f(\lambda)\neq{0}$
- 但是$f(\lambda)$往往是可以等于0的,这时还需要额外讨论$f(\lambda)=0$的情形以免漏解

## 归纳:线性方程组秩和解的定理🎈

- **非齐次**线性方程组$Ax=B$有解的**充分必要条件**是它的系数矩阵A和增广矩阵$\overline{A}=(A|B)$具有相同的秩$r(A)=r(\overline{A})=r$,且:
  - 若$r=n$有方程组有唯一解
  - 若$r<{n}$方程组有多解

- **齐次**线性方程组$Ax=0$;A为系数矩阵

  - 齐次方程组的情况可以理解为B中元素全为0,那么总有$r(A)=r(\overline{A})$

    - 对一个矩阵A添加一列零向量,不会得到的增广矩阵$B=\overline{A}$的秩和原矩阵一致(新增的零向量列在B做初等行变换时不会影响非零行的数量)

  - 可见,齐次线性方程组总是有解

  - 若$r(A)<n$方程组有非零解

    - 换句话说,齐次线性方程组中方程个数m小于未知量个数n(即$m<n$)时,方程组有非零解
      - 此时矩阵A的列向量一定线性相关
      - 可见,任何由m维向量构成的线性无关组包含k个向量,则$k\leqslant{m}$
        - 换句话说,由m维向量构成的线性无关组至多含有m个向量
    - 根据系数行列式和秩的关系,A是个方阵且有非零解的充要条件是$|A|=0$或$r<m=n$
      - A是方阵的含义是:A的行数m(方程个数)和未知量个数n相等(即m=n)

  - 若$r(A)=n$则方程组只有零解

    - A是满秩矩阵$r(A)=n$
    - 如果A是**方阵**,则${|A|\ne0}$



