[toc]

# 分块矩阵

- 分块矩阵中的重点是分块矩阵的乘法,分块对角矩阵的求逆,求行列式他，转置

## 乘法运算

- 设$A$为$m\times{l}$矩阵,$B$为$l\times{n}$矩阵:

  - 将$A$分块为$s\times{t}$

  - $$
    A=\begin{pmatrix}
    a_{11}&\cdots&a_{1l}\\
    \vdots&&\vdots\\
    a_{m1}&\cdots&a_{ml}
    \end{pmatrix}
    =\begin{pmatrix}
    A_{11}&\cdots&A_{1t}\\
    \vdots&&\vdots\\
    A_{s1}&\cdots&A_{st}
    \end{pmatrix}
    $$

  - 将$B$分块为$t\times{r}$

  - $$
    B=\begin{pmatrix}
    b_{11}&\cdots&b_{1n}\\
    \vdots&&\vdots\\
    b_{l1}&\cdots&b_{ln}
    \end{pmatrix}
    =\begin{pmatrix}
    B_{11}&\cdots&B_{1r}\\
    \vdots&&\vdots\\
    B_{t1}&\cdots&B_{tr}
    \end{pmatrix}
    $$

  - 将$C=AB$,分块为$s\times{r}$

  - $$
    C=\begin{pmatrix}
        c_{11}&\cdots&c_{1n}\\
        \vdots&&\vdots\\
        c_{m1}&\cdots&c_{mn}
    \end{pmatrix}
    =\begin{pmatrix}
        C_{11}&\cdots&C_{1r}\\
        \vdots&&\vdots\\
        C_{s1}&\cdots&C_{sr}
    \end{pmatrix}
    $$

    

- 设函数$nrow(A_{ij})$表示矩阵A的子块$A_{ij}$的行数,$ncol(A_{ij})$表示列数

- $ncol(A_{ik})=nrow(B_{kj})$=$l_k$,$k=1,2,\cdots,t$;$i=1,2,\cdots,s$;$j=1,2,\cdots,r$

  - 这个条件保证了每个对应的子块可以进行子块乘法运算
  - 从而分块矩阵乘法$C=AB$能够执行

- $$
  C=\begin{pmatrix}
  A_{11}&\cdots&A_{1t}\\
  \vdots&&\vdots\\
  A_{s1}&\cdots&A_{st}
  \end{pmatrix}
  \begin{pmatrix}
  B_{11}&\cdots&B_{1r}\\
  \vdots&&\vdots\\
  B_{t1}&\cdots&B_{tr}
  \end{pmatrix}
  $$

- Note:对矩阵分块时,同一个矩阵内,同一行的分块矩阵有相同的**行数**,同一列的分块矩阵有相同的**列数**
  - 否则就不算是标准的分块矩阵,下列讨论的性质也就不再适用

### 分块乘法的行数和列数分析

- 再定义:
  - $m_{i}=nrow(A_{ik})$,表示矩阵A的第$i$行的分块矩阵具有的行数
  - $n_{j}=ncol(B_{kj})$,表示矩阵B的第$j$列的分块矩阵具有的列数
  - 这两个值将会决定$A_{ik}B_{kj}$的行数和列数,同时也是$C_{ij}$的行数和列数(同型矩阵才能相加,且相加的结果与加数矩阵是同型):

- $$
  C_{ij}=\sum_{k=1}^{t}A_{ik}B_{kj},
  \\A_{ik}B_{kj},C_{ij}\in\mathbb{R}^{m_{i}\times{n_j}},
  A_{ik}\in\mathbb{R}^{m_i\times{l_k}},
  B_{kj}\in\mathbb{R}^{l_k\times{n_j}}
  \\
  (i=1,\cdots,s;j=1,\cdots,r)
  \\
  c_{ij}=\sum_{k=1}^{l}a_{ik}b_{kj}
  $$

- $m=\sum_{i=1}^{s}nrow(A_{ij})=\sum_{i=1}^{s}nrow(C_{ij})$
- $l=\sum_{j=1}^{t}ncol(A_{ij})=\sum_{i=1}^{t}nrow(B_{ij})$
- $n=\sum_{j=1}^{r}ncol(B_{ij})=\sum_{j=1}^{r}ncol(C_{ij})$

### 证明分块乘法公式

- 定义矩阵$H_{k}=A_{ik}B_{kj}$;则$C_{ij}=\sum_{k=1}^{t}H_k$,即,一般情况下,计算一个$C$的分块矩阵$C_{ij}$需要执行$t$次普通矩阵乘法
- $H_{k},k=1,2\cdots,t$都是同型的$(m_i\times{n_i})$,(否则$H_k,k=1,2,\cdots,t$)之间无法相加
- $c_{ij}=\sum_{k=1}^{l}a_{ik}b_{kj}$=$\sum_{k=1}^{t}h_{k}$,$h_k$表示$c_{ij}$被分块乘法后的第$k$个部分



#### 例

- $$
  A=\begin{pmatrix}
  	 1&  0 &  0 &  0	\\
  	 0&   1& 0 &0  	\\
  	  -1&  2&  1      &  0	\\
  	 1& 1 & 0 &1  	\\
  \end{pmatrix}
  B=\begin{pmatrix}
  	 1&  0&  1&0  \\
  	 -1&  2&  0& 1 	\\
   	1 &  0&  4& 1 	\\
  	-1 & -1 & 2 &0  	\\
  \end{pmatrix}
  $$

- 容易观察到矩阵A左上角有一个二阶单位阵,右上角有一个二阶零矩阵,因此可以考虑将$A$分块为4个二阶矩阵

  - 矩阵B对应的可以划分为4个二阶矩阵,(由于矩阵B没有零矩阵也没有单位阵分块,所以划分方法不唯一,其他分法也是存在的,只要保证各个分块能够执行矩阵乘法即可)

  - $$
    A=\begin{pmatrix}
    	E&\bold{0}\\
    	A_1&E
    \end{pmatrix}
    B=\begin{pmatrix}
    	B_{11}&E\\
    	B_{21}&B_{22}
    \end{pmatrix}
    \\
    AB=\begin{pmatrix}
    	B_{11}&E\\
    	A_1B_{11}+B_{21}&A_1+B_{22}
    \end{pmatrix}
    =\begin{pmatrix}
    	 1&  0&  1&0  \\
    	 -1&  2&  0& 1 	\\
     	-2&  4&  3& 3 	\\
    	-1 & 1 & 3 &1  	\\
    \end{pmatrix}
    $$

    可以看到,AB的分块中,每个分块都是2阶的矩阵乘法或加法,前两个($B_{11},E$)还不用算,大大简化计算

### 矩阵的向量分块👺

- 设$A\in\mathbb{R}^{m\times{n}}$,$B\in\mathbb{R}^{n\times{s}}$

- 对$B$按列分块:$B=(\beta_1,\beta_2,\cdots,\beta_s)$

  - $$
    B_j=\begin{pmatrix}
    b_{1j}\\
    b_{2j}\\
    \vdots\\
    b_{nj}
    \end{pmatrix}
    =(b_{1j},b_{2j},\cdots,b_{nj})^T
    $$

    - 向量默认是列向量
    - 行向量通常带上转置符号$T$,表示列向量的转置
    - 有时为了书写方便,展开列向量内容时,常表示为行向量的转置


#### 半矩阵半向量分块乘法

- $AB$=$A(\beta_1,\beta_2,\cdots,\beta_s)$=$(A\beta_1,A\beta_2,\cdots,A\beta_s)$

  - 矩阵乘的结果被表示为列向量分块

  - 这种划分是允许的,因为$A$的列数和$\beta_i,(i=1,2,\cdots,s)$的行数相等,都是$n$

  - 同时将A视为一个元的时候也能类似数乘和$(\beta_1,\beta_2,\cdots,\beta_s)$做乘法

- $AB=(\alpha_1^T,\cdots,\alpha_{m}^T)^TB$=$(\alpha_1^TB,\cdots,\alpha_{m}^TB)^T$

  - 矩阵乘的结果被表示为行向量分块

- 小结

  - $$
    AB
    =(A\beta_1,A\beta_2,\cdots,A\beta_s)
    =\begin{pmatrix}
    \alpha_1^{T}B\\
    \vdots\\
    \alpha_m^{T}B
    \end{pmatrix}
    $$

  - 例如,$AX=B$,写作$\bold{A(x_1,\cdots,x_s)}$=$(\bold{Ax_1,\cdots{Ax_n}})$=$\bold{(b_1,\cdots,b_s)}$可以分解为$\bold{Ax_i=b_i}$,$i=1,\cdots,s$共$s$个线性方程

Notes:

- $AB=A(\beta_1^T,\cdots,\beta_n^T)^T\neq(A\beta_1^T,\cdots,A\beta_n^T)^T$

- $AB=(\alpha_1,\cdots,\alpha_n)B\neq(\alpha_1{B},\cdots,\alpha_n{B})$

  

#### 方案一:列分块乘以行分块

- 定义分块矩阵:

  - 
    $$
    A=\begin{pmatrix}
    \alpha_1&\alpha_2&\cdots&\alpha_n
    \end{pmatrix};
    B=\begin{pmatrix}
        \beta_{1}^T\\
        \beta_{2}^T\\
        \vdots\\
        \beta_{n}^T
    \end{pmatrix}
    \\
    $$


- 分块矩阵乘法
  $$
  \begin{aligned}
  AB=&\begin{pmatrix}
     a_{11}&  a_{12}&  \cdots&a_{1n} \\
      a_{21}&  a_{22}&  \cdots&a_{2n} \\
      \vdots&  \vdots&  &\vdots \\
      a_{m1}&  a_{m2}&  \cdots&a_{mn} \\
  \end{pmatrix}
  \begin{pmatrix}
     b_{11}&  b_{12}&  \cdots&b_{1s} \\
      b_{21}&  b_{22}&  \cdots&b_{2s} \\
      \vdots&  \vdots&  &\vdots \\
      b_{n1}&  b_{n2}&  \cdots&b_{ns} \\
  \end{pmatrix}\\
  =&\begin{pmatrix}
  \alpha_1&\alpha_2&\cdots&\alpha_n
  \end{pmatrix}
  \begin{pmatrix}
      \beta_{1}^T\\
      \beta_{2}^T\\
      \vdots\\
      \beta_{n}^T
  \end{pmatrix}
  \\
  =&\sum_{k=1}^{n}\alpha_{k}\beta_k^T
  \end{aligned}
  $$

  

  - 其中$\alpha_{k}\beta_i^T\in\mathbb{R}^{m\times{s}}$

#### 方案二:行分块乘以列分块

- 定义分块矩阵
  $$
  A=\begin{pmatrix}
  \alpha_1^T\\
  \alpha_2^T\\
  \vdots\\
  \alpha_m^T
  \end{pmatrix}
  \\
  B=\begin{pmatrix}
  \beta_1&\beta_2&\cdots&\beta_s
  \end{pmatrix}
  $$
  
- 分块矩阵乘法

- $$
  AB=\begin{pmatrix}
  \alpha_1^T\\
  \alpha_2^T\\
  \vdots\\
  \alpha_m^T
  \end{pmatrix}
  \begin{pmatrix}
  \beta_1&\beta_2&\cdots&\beta_s
  \end{pmatrix}
  =\begin{pmatrix}
     \alpha_1^T\beta_1&  \alpha_1^T\beta_2&  \cdots&\alpha_1^T\beta_s \\
      \alpha_2^T\beta_1& \alpha_2^T\beta_2&  \cdots&\alpha_2^T\beta_s \\
      \vdots&  \vdots&  &\vdots \\
     \alpha_m^T\beta_1&  \alpha_m^T\beta_2&  \cdots&\alpha_m^T\beta_s \\
  \end{pmatrix}
  $$

#### $A^TA$

- $$
  A^TA=\begin{pmatrix}
  \alpha_1^T\\
  \alpha_2^T\\
  \vdots\\
  \alpha_n^T
  \end{pmatrix}
  \begin{pmatrix}
  \beta_1&\beta_2&\cdots&\beta_s
  \end{pmatrix}
  =\begin{pmatrix}
     \alpha_1^T\beta_1&  \alpha_1^T\beta_2&  \cdots&\alpha_1^T\beta_s \\
      \alpha_2^T\beta_1& \alpha_2^T\beta_2&  \cdots&\alpha_2^T\beta_s \\
      \vdots&  \vdots&  &\vdots \\
     \alpha_n^T\beta_1&  \alpha_n^T\beta_2&  \cdots&\alpha_n^T\beta_s \\
  \end{pmatrix}
  $$

- 此时:$s=n$,$\beta_i=(\alpha_i^T)^
  T=\alpha_i,i=1,2,\cdots,n$

- $$
  A^TA
  =\begin{pmatrix}
     \alpha_1^T\beta_1&  \alpha_1^T\beta_2&  \cdots&\alpha_1^T\beta_n \\
      \alpha_2^T\beta_1& \alpha_2^T\beta_2&  \cdots&\alpha_2^T\beta_n \\
      \vdots&  \vdots&  &\vdots \\
     \alpha_n^T\beta_1&  \alpha_n^T\beta_2&  \cdots&\alpha_n^T\beta_n \\
  \end{pmatrix}
  =\begin{pmatrix}
     \alpha_1^T\alpha_1&  \alpha_1^T\alpha_2&  \cdots&\alpha_1^T\alpha_n \\
      \alpha_2^T\alpha_1& \alpha_2^T\alpha_2&  \cdots&\alpha_2^T\alpha_n \\
      \vdots&  \vdots&  &\vdots \\
     \alpha_n^T\alpha_1&  \alpha_n^T\alpha_2&  \cdots&\alpha_n^T\alpha_n \\
  \end{pmatrix}
  $$

- 若$A^TA=O$,则$\alpha_{i}^T\alpha_j=0,i,j=1,2,\cdots,n$

  - 特别的,$\alpha_{j}^T\alpha_{j}=0,j=1,2,\cdots,n$可知

  - $$
    (a_{1j},a_{2j},\cdots,a_{mj})
    (a_{1j},a_{2j},\cdots,a_{mj})^T=\sum_{k=1}^{m}a_{kj}^2=0
    $$

  - 所以$a_{ij}=0,i=1,2,\cdots,m;j=1,2,\cdots,n$

  - 即$A=O$

#### 小结

- 矩阵分块可以按行分块也可以按列分块,可以统称为向量分块
- 如果$AB=C$,则向量分块方案有两种
  - A,B分别按列向量分块和行向量分块
  - A,B分别按行向量分块和列向量分块



## 转置运算

- $$
  A_{p\times{q}}=\begin{pmatrix}  
    A_{11}& A_{12}& \cdots  & A_{1q} \\  
    A_{21}& A_{22}& \cdots  & A_{2q} \\  
    \vdots & \vdots & \ddots & \vdots \\  
    A_{p1}& A_{p2}& \cdots  & A_{pq}  
  \end{pmatrix}
  \\
  A^T_{q\times{p}}=\begin{pmatrix}  
    A_{11}^T& A_{21}^T& \cdots  & A_{p1}^T \\  
    A_{12}^T& A_{22}^T& \cdots  & A_{p2}^T \\  
    \vdots & \vdots & \ddots & \vdots \\  
    A_{1q}^T& A_{2q}^T& \cdots  & A_{pq}^T  
  \end{pmatrix}
  $$





## 准三角阵(分块三角矩阵)求逆

- 借助分块乘法,可以将高阶矩阵求逆转为低阶矩阵求逆
- 利用待定系数法可以求解部分相关问题

#### 例

- n阶矩阵:$D=\begin{pmatrix}A&\bold{0}\\C&B\end{pmatrix}$,A,B均可逆

  - 待定系数法:$D^{-1}=\begin{pmatrix}X_{11}&{X_{12}}\\X_{21}&X_{22}\end{pmatrix}$

  - $$
    DD^{-1}=\begin{pmatrix}A&\bold{0}\\C&B\end{pmatrix}
    \begin{pmatrix}X_{11}&{X_{12}}\\X_{21}&X_{22}\end{pmatrix}
    =\begin{pmatrix}E_k&{\bold{0}}\\\bold{0}&E_r\end{pmatrix}=E_{n=k+r}
    $$

  - $$
    AX_{11}=E_k\\
    AX_{12}=\bold{0}\\
    CX_{11}+BX_{21}=0\\
    CX_{12}+BX_{22}=E_r
    \\
    对前两个式子两边左乘A^{-1},得到X_{11}=A^{-1};X_{12}=\bold{0}
    \\分别带入第3,4式中,得到:
    \\X_{21}=-B^{-1}CA^{-1}
    \\BX_{22}=E_r,左乘B^{-1},X_{22}=B^{-1}
    \\得:
    \\D^{-1}=\begin{pmatrix}A^{-1}&\bold{0}\\
    -B^{-1}CA^{-1}&B^{-1}\end{pmatrix}
    $$

#### 准对角阵求逆性质

- 特别的,当$C=\bold{0}$

  - $$
    D=\begin{pmatrix}A&\bold{0}\\\bold{0}&B\end{pmatrix}
    \\
    D^{-1}=\begin{pmatrix}A^{-1}&\bold{0}\\
    \bold{0}&B^{-1}\end{pmatrix}
    $$

#### 准三角阵求逆

- $$
  \\
  \begin{pmatrix}
      A&C\\
      \bold{0}&B
  \end{pmatrix}^{-1}
  =\begin{pmatrix}
      A^{-1}&-A^{-1}CB^{-1}\\
      \bold0&B^{-1}
  \end{pmatrix}
  \\
  \begin{pmatrix}
      \bold{0}&A\\
      B&\bold{0}
  \end{pmatrix}^{-1}
  =\begin{pmatrix}
      \bold{0}&B^{-1}\\
      A^{-1}&\bold{0}
  \end{pmatrix}
  $$

- 注意区分行列式中的拉普拉斯展开

- 从验证的角度:

  - $$
    \begin{pmatrix}
        \bold{0}&A\\
        B&\bold{0}
    \end{pmatrix}
    \begin{pmatrix}
        \bold{0}&B^{-1}\\
        A^{-1}&\bold{0}
    \end{pmatrix}=
    \begin{pmatrix}
        E&\bold{0}\\
        \bold{0}&E
    \end{pmatrix}
    $$



# 常见分块矩阵划分



## 分块对角阵(准对角阵)

- $$
  A=\begin{pmatrix}  
    A_{1}& 0& \cdots  & 0 \\  
    0& A_{2}& \cdots  & 0 \\  
    \vdots & \vdots & \ddots & \vdots \\  
    0& 0& \cdots  & A_{s}  
  \end{pmatrix}
  $$

- 其中$A_{i},i=1,2,\cdots,s$都是**方阵**



### 行列式性质

- 设矩阵$A$可以被分块为分块对角阵,对角元素分别是$A_i,i=1,2,\cdots,s$,则$|A|=\prod_{i=1}^{s}|A_i|$

- 证明思路:
  - 不妨将$A$记为$A=D(A_{i}),i=1,2,\cdots,s$
  - 将每个$A_i$都利用行(列)倍增变换(等值),使其转换为三角阵$A_i'$,则有$|A_{i}|=|A_{i}'|$=$\prod_{k=1}^{n_i}a_k^{[i]}$,$[i]$表示$a_{k}$是相对于分块矩阵$A_i$的第$k$个对角元
  - 则$A'=D(A_i'),i=1,2,\cdots,s$也是三角阵,并且$|A|=|A'|=\prod_{i=1}^{s}|A_i'|$=$\prod_{i=1}^{s}|A_i|$

### 分块矩阵的可逆性

- 若$A_i,i=1,2,\cdots,s$可逆($|A_i|\neq{0}$,则$\prod_{i=1}^{n}|A_i|\neq{0}$,从而$A=D(A_{i}),i=1,2,\cdots,s$的行列式$|A|\neq{0}$,即$A$可逆

### 分块对角阵求逆

- 若$A$可逆,且分块$A_{i},i=1,2,\cdots,n$可逆,则

  - $$
    A^{-1}=\begin{pmatrix}  
      A_{1}^{-1}& 0& \cdots  & 0 \\  
      0& A_{2}^{-1}& \cdots  & 0 \\  
      \vdots & \vdots & \ddots & \vdots \\  
      0& 0& \cdots  & A_{s}^{-1}  
    \end{pmatrix}
    $$

- 使用分块矩阵乘法性质即可验证





### 二阶分块矩阵乘法

- $C_{ij}=\sum_{k=1}^{l}A_{ik}B_{kj},(i=1,2,\cdots,t;j=1,2,\cdots,{r})$

- $$
  C=\begin{pmatrix}
  	A&B\\
  	C&D
  \end{pmatrix}
  \begin{pmatrix}
  	X&Y\\
  	Z&W
  \end{pmatrix}
  \\
  C=\begin{pmatrix}
  	C_{11}&C_{12}\\
  	C_{21}&C_{22}
  \end{pmatrix}
  =\begin{pmatrix}
  	AX+BZ&AY+BW\\
  	CX+DZ&CY+DW
  \end{pmatrix}
  $$


### 分块对角阵的幂运算

- 分块对角阵的乘法性质和普通对角阵相仿

- 设矩阵A,B可以被分块为可以相乘的两个分块对角阵

- $$
  \begin{pmatrix}
  	A_1&&&\\
  	&A_2&&\\
  	&&\ddots&\\
  	&&&A_s
  \end{pmatrix}
  \begin{pmatrix}
  	B_1&&&\\
  	&B_2&&\\
  	&&\ddots&\\
  	&&&B_s
  \end{pmatrix}
  =\begin{pmatrix}
  	A_1B_1&&&\\
  	&A_2B_2&&\\
  	&&\ddots&\\
  	&&&A_sB_s
  \end{pmatrix}
  $$

- $$
  \begin{pmatrix}
  	A_1&&&\\
  	&A_2&&\\
  	&&\ddots&\\
  	&&&A_s
  \end{pmatrix}^n
  =\begin{pmatrix}
  	A_1^n&&&\\
  	&A_2^n&&\\
  	&&\ddots&\\
  	&&&A_s^n
  \end{pmatrix}
  $$

- 特别的

  - $$
    \begin{pmatrix}
    	A_1&\bold{0}\\
    	\bold{0}&A_2
    \end{pmatrix}^{n}
    =\begin{pmatrix}
    	A_{1}^{n}&\bold{0}\\
    	\bold{0}&A_{2}^{n}
    \end{pmatrix}
    $$

    

## 特殊分块矩阵

### 最小分块矩阵

- $$
  A=\begin{pmatrix}
  a_{11}&\cdots&a_{1l}\\
  \vdots&&\vdots\\
  a_{m1}&\cdots&a_{ml}
  \end{pmatrix}
  $$

- 矩阵A的每个分块只包含一个元素,这种分块方法称为**最小分块法**

- 矩阵A最小分块矩阵形式和$A$相同,$A_{ij}=a_{ij}$

- 最小分块矩阵和其他分块矩阵做矩阵乘法时,和普通分块矩阵乘法类似,判断可行性:

- 两个分块矩阵$A,B$满足:

  - $A$的列数等于$B$的行数;
  - $A_{ik}$的列数等于$B_{kj}$的行数





