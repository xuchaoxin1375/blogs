[toc]

## 分块矩阵

- 设$A$为$m\times{l}$矩阵,$B$为$l\times{n}$矩阵:

  - 将$A$分块为$s\times{t}$

  - $$
    A=\begin{pmatrix}
    a_{11}&\cdots&a_{1l}\\
    \vdots&&\vdots\\
    a_{m1}&\cdots&a_{ml}
    \end{pmatrix}
    =\begin{pmatrix}
    A_{11}&\cdots&A_{1t}\\
    \vdots&&\vdots\\
    A_{s1}&\cdots&A_{st}
    \end{pmatrix}
    $$

  - 将$B$分块为$t\times{r}$

  - $$
    B=\begin{pmatrix}
    b_{11}&\cdots&b_{1n}\\
    \vdots&&\vdots\\
    b_{l1}&\cdots&b_{ln}
    \end{pmatrix}
    =\begin{pmatrix}
    B_{11}&\cdots&B_{1r}\\
    \vdots&&\vdots\\
    B_{t1}&\cdots&B_{tr}
    \end{pmatrix}
    $$

  - $C=AB$,分块为$s\times{r}$

    - 设函数$nrow(A_{ij})$表示矩阵A的子块$A_{ij}$的行数,$ncol(A_{ij})$表示列数,则:
      - $l_k=ncol(A_{ik})=nrow(B_{kj})$
      - $m_{i}=nrow(A_{ij})=nrow(A_{ik})$
      - $n_{j}=ncol(B_{ij})=ncol(B_{kj})$

### 乘法

- $$
  C_{ij}=\sum_{k=1}^{t}A_{ik}B_{kj},
  \\C_{ij}\in\mathbb{R}^{m_{i}\times{n_j}},
  A_{ik}\in\mathbb{R}^{m_i\times{l_k}},
  B_{kj}\in\mathbb{R}^{l_k\times{n_j}}
  \\
  (i=1,\cdots,s;j=1,\cdots,r)
  \\
  c_{ij}=\sum_{k=1}^{l}a_{ik}b_{kj}
  \\
  C=\begin{pmatrix}
  c_{11}&\cdots&c_{1n}\\
  \vdots&&\vdots\\
  c_{m1}&\cdots&c_{mn}
  \end{pmatrix}
  =\begin{pmatrix}
  C_{11}&\cdots&C_{1r}\\
  \vdots&&\vdots\\
  C_{s1}&\cdots&C_{sr}
  \end{pmatrix}
  $$

- $$
  C=\begin{pmatrix}
  A_{11}&\cdots&A_{1t}\\
  \vdots&&\vdots\\
  A_{s1}&\cdots&A_{st}
  \end{pmatrix}
  \begin{pmatrix}
  B_{11}&\cdots&B_{1r}\\
  \vdots&&\vdots\\
  B_{t1}&\cdots&B_{tr}
  \end{pmatrix}
  $$

  

- $m=\sum_{i=1}^{s}nrow(A_{ij})=\sum_{i=1}^{s}nrow(C_{ij})$

- $l=\sum_{j=1}^{t}ncol(A_{ij})=\sum_{i=1}^{t}nrow(B_{ij})$

- $n=\sum_{j=1}^{r}ncol(B_{ij})=\sum_{j=1}^{r}ncol(C_{ij})$

- 令$sl(k)=\sum_{i=1}^{k}l_i$

  - $sm(i)=\sum_{k=1}^{i}m_{k}$

  - $sn(j)=\sum_{k=1}^{i}n_{k}$

  - $$
    {C_{ij}=(c_{i^{'}j^{'}}^{'})_{m_i\times{n_j}}}
    \\
    H_{k}=A_{ik}B_{kj}\\
    %h_{i^{'}j^{'}}=
    [i]=sm(i-1)+i'
    \\
    [j]=sn(j-1)+j'
    \\
    \large{
    h_{i^{'}j^{'}}=\sum_{\theta=sl(k-1)+1}^{sl(k)}a_{[i]\theta}b_{\theta{[j]}}
    }
    \\
    c_{i^{'}j^{'}}=\sum_{k=1}^{t}h_{i^{'}j^{'}}
    =\sum_{k=1}^{t}\sum_{\theta=sl(k-1)+1}^{sl(k)}a_{[i]\theta}b_{\theta{[j]}}
    \\
    =\sum_{k=1}^{l}a_{[i]k}b_{k[j]}
    $$

  - 若记$C=(c_{pq})_{m\times{n}}$,则$c_{pq}=c_{[i][j]}$

    - $[i],p=1,2,\cdots,m$;
    - $[j],q=1,2,\cdots,n$



-  注意对相乘的两个高阶矩阵的划分方法,子矩阵之间要能够相乘

  - $C_{ij}=\sum_{k=1}^{l}A_{ik}B_{kj},(i=1,2,\cdots,t;j=1,2,\cdots,{r})$

- $$
  \begin{pmatrix}
  	A&B\\
  	C&D
  \end{pmatrix}
  \begin{pmatrix}
  	X&Y\\
  	Z&W
  \end{pmatrix}
  =\begin{pmatrix}
  	AX+BZ&AY+BW\\
  	CX+DZ&CY+DW
  \end{pmatrix}
  $$

- $$
  \begin{pmatrix}
  	B&\bold{0}\\
  	\bold{0}&C
  \end{pmatrix}^{n}
  =\begin{pmatrix}
  	B^{n}&\bold{0}\\
  	\bold{0}&C^{n}
  \end{pmatrix}
  $$

  - $$
    \\公式\alpha:
    \begin{pmatrix}
    	A&\bold{0}\\
    	\bold{0}&B
    \end{pmatrix}
    \begin{pmatrix}
    	C&\bold{0}\\
    	\bold{0}&D
    \end{pmatrix}
    =\begin{pmatrix}
    	AB&\bold{0}\\
    	\bold{0}&CD
    \end{pmatrix}
    \\\\
    令C=A,D=B,则
    \\
    \begin{pmatrix}
    	B&\bold{0}\\
    	\bold{0}&C
    \end{pmatrix}^{2}
    =\begin{pmatrix}
    	B^2&\bold{0}\\
    	\bold{0}&C^2
    \end{pmatrix}
    \\\begin{pmatrix}
    	B&\bold{0}\\
    	\bold{0}&C
    \end{pmatrix}^{3}
    =\begin{pmatrix}
    	B^2&\bold{0}\\
    	\bold{0}&C^2
    \end{pmatrix}
    \begin{pmatrix}
    	B&\bold{0}\\
    	\bold{0}&C
    \end{pmatrix}
    =\begin{pmatrix}
    	B^3&\bold{0}\\
    	\bold{0}&C^3
    \end{pmatrix}
    \\
    利用公式\alpha不断迭代,可知
    \begin{pmatrix}
    	B&\bold{0}\\
    	\bold{0}&C
    \end{pmatrix}^{n}
    =\begin{pmatrix}
    	B^{n}&\bold{0}\\
    	\bold{0}&C^{n}
    \end{pmatrix}
    $$

    

### 逆

- 借助分块乘法,可以将高阶矩阵求逆转为低阶矩阵求逆

#### 例

- n阶矩阵:$D=\begin{pmatrix}A&\bold{0}\\C&B\end{pmatrix}$,A,B均可逆

  - 待定系数法:$D^{-1}=\begin{pmatrix}X_{11}&{X_{12}}\\X_{21}&X_{22}\end{pmatrix}$

  - $$
    DD^{-1}=\begin{pmatrix}A&\bold{0}\\C&B\end{pmatrix}
    \begin{pmatrix}X_{11}&{X_{12}}\\X_{21}&X_{22}\end{pmatrix}
    =\begin{pmatrix}E_k&{\bold{0}}\\\bold{0}&E_r\end{pmatrix}=E_{n=k+r}
    $$

  - $$
    AX_{11}=E_k\\
    AX_{12}=\bold{0}\\
    CX_{11}+BX_{21}=0\\
    CX_{12}+BX_{22}=E_r
    \\
    对前两个式子两边左乘A^{-1},得到X_{11}=A^{-1};X_{12}=\bold{0}
    \\分别带入第3,4式中,得到:
    \\X_{21}=-B^{-1}CA^{-1}
    \\BX_{22}=E_r,左乘B^{-1},X_{22}=B^{-1}
    \\得:
    \\D^{-1}=\begin{pmatrix}A^{-1}&\bold{0}\\
    -B^{-1}CA^{-1}&B^{-1}\end{pmatrix}
    $$


#### 准对角阵求逆性质

- 特别的,当$C=\bold{0}$

  - $$
    D=\begin{pmatrix}A&\bold{0}\\\bold{0}&B\end{pmatrix}
    \\
    D^{-1}=\begin{pmatrix}A^{-1}&\bold{0}\\
    \bold{0}&B^{-1}\end{pmatrix}
    $$

- 类似的:

  - $$
    \\
    \begin{pmatrix}
        A&C\\
        \bold{0}&B
    \end{pmatrix}^{-1}
    =\begin{pmatrix}
        A^{-1}&-A^{-1}CB^{-1}\\
        \bold0&B^{-1}
    \end{pmatrix}
    \\
    \begin{pmatrix}
        \bold{0}&A\\
        B&\bold{0}
    \end{pmatrix}^{-1}
    =\begin{pmatrix}
        \bold{0}&B^{-1}\\
        A^{-1}&\bold{0}
    \end{pmatrix}
    $$

- 注意区分行列式中的拉普拉斯展开

- 从验证的角度:

  - $$
    \begin{pmatrix}
        \bold{0}&A\\
        B&\bold{0}
    \end{pmatrix}
    \begin{pmatrix}
        \bold{0}&B^{-1}\\
        A^{-1}&\bold{0}
    \end{pmatrix}=
    \begin{pmatrix}
        E&\bold{0}\\
        \bold{0}&E
    \end{pmatrix}
    $$


#### 矩阵的向量分块

- 设$A\in\mathbb{R}^{m\times{n}}$,$B\in\mathbb{R}^{n\times{s}}$

- 对B按列分块:$B=(B_1,B_2,\cdots,B_s)$

  - 则$AB=A(B_1,\cdots,B_s)=(AB_1,\cdots,AB_s)$
  - 这里A一整个矩阵被视为一个子块(将整个A视为作为一个元素),则$A(B_1,\cdots,B_s)$该操作类似于向量的数乘
  - 这种划分是允许的,因为$A$的列数和$B_i,(i=1,2,\cdots,s)$的行数相等

- 对B按行分块:

- $$
  B=\begin{pmatrix}
      \beta_{1}\\
      \beta_{2}\\
      \vdots\\
      \beta_{n}
  \end{pmatrix}
  \\
  AB=\begin{pmatrix}
     a_{11}&  a_{12}&  \cdots&a_{1n} \\
      a_{21}&  a_{22}&  \cdots&a_{2n} \\
      \vdots&  \vdots&  &\vdots \\
      a_{m1}&  a_{m2}&  \cdots&a_{mn} \\
  \end{pmatrix}
  \begin{pmatrix}
      \beta_{1}\\
      \beta_{2}\\
      \vdots\\
      \beta_{n}
  \end{pmatrix}
  $$

- 若$AB=C$,再对C按行分块

- 矩阵$C$的行向量$\gamma_{i}$可以由$B$的行向量组线性标出,标出系数矩阵为$A$
  $$
  C=\begin{pmatrix}
      \gamma_{1}\\
      \gamma_{2}\\
      \vdots\\
      \gamma_{n}
  \end{pmatrix}
  \\
  \sum_{k=1}^{n}a_{ik}\beta_{k}=\gamma_{i}
  \\
  i=1,2,\cdots,m
  $$

- 类似的:对A,C按列分块
  $$
  A=(\theta_{1},\cdots,\theta_{n})
  \\
  C=(\delta_{1},\cdots,\delta_{s})
  \\
  B=\begin{pmatrix}
     b_{11}&  b_{12}&  \cdots&b_{1s} \\
      b_{21}&  b_{22}&  \cdots&b_{2s} \\
      \vdots&  \vdots&  &\vdots \\
      b_{n1}&  b_{n2}&  \cdots&b_{ns} \\
  \end{pmatrix}
  \\
  AB=C
  \\
  (\theta_{1},\cdots,\theta_{n})
  \begin{pmatrix}
     b_{11}&  b_{12}&  \cdots&b_{1s} \\
      b_{21}&  b_{22}&  \cdots&b_{2s} \\
      \vdots&  \vdots&  &\vdots \\
      b_{n1}&  b_{n2}&  \cdots&b_{ns} \\
  \end{pmatrix}
  =(\delta_{1},\cdots,\delta_{s})
  \\
  \delta_{j}=\sum_{k=1}^{n}b_{kj}\theta_{k}
  $$
  
- 矩阵C的列向量可以由A的列向量线性标出,表出系数矩阵为B

- 类似线性表出的形式,列向量$\delta_j$被列向量组$\theta_1,\cdots,\theta_n$线性表出,表出系数为$b_{1j},\cdots,b_{nj}$



### 准对角矩阵

- $$
  A=\begin{pmatrix}  
    A_{11}& 0& \cdots  & 0 \\  
    0& A_{22}& \cdots  & 0 \\  
    \vdots & \vdots & \ddots & \vdots \\  
    0& 0& \cdots  & A_{nn}  
  \end{pmatrix}
  \\
  A^{-1}=\begin{pmatrix}  
    A_{11}^{-1}& 0& \cdots  & 0 \\  
    0& A_{22}^{-1}& \cdots  & 0 \\  
    \vdots & \vdots & \ddots & \vdots \\  
    0& 0& \cdots  & A_{nn}^{-1}  
  \end{pmatrix}
  \\将两个矩阵相乘,容易验证
  $$

  

### 转置

- $$
  A_{p\times{q}}=\begin{pmatrix}  
    A_{11}& A_{12}& \cdots  & A_{1q} \\  
    A_{21}& A_{22}& \cdots  & A_{2q} \\  
    \vdots & \vdots & \ddots & \vdots \\  
    A_{p1}& A_{p2}& \cdots  & A_{pq}  
  \end{pmatrix}
  \\
  A^T_{q\times{p}}=\begin{pmatrix}  
    A_{11}^T& A_{21}^T& \cdots  & A_{p1}^T \\  
    A_{12}^T& A_{22}^T& \cdots  & A_{p2}^T \\  
    \vdots & \vdots & \ddots & \vdots \\  
    A_{1q}^T& A_{2q}^T& \cdots  & A_{pq}^T  
  \end{pmatrix}
  $$





