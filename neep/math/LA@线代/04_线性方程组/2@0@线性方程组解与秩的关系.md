[toc]

## 线性方程组一般情况的讨论



- 对线性方程组执行初等行变换(高斯消元),可以用方程组的**增广矩阵**表示,将增广矩阵记为$\overline{A}=(A|\bold{b})$,为了书写方便,进一步可以将$\overline{A}$记为$B$
  $$
  B=\begin{pmatrix}
  a_{11} & a_{12} & \cdots  & a_{1 n}&b_1 \\
  a_{12} & a_{22} & \cdots & a_{2 n}&b_2 \\
  \vdots & \vdots & &\vdots  &\vdots\\
  a_{m1} & a_{m2} & \cdots & a_{mn}&b_m \\
  \end{pmatrix}
  $$

### 增广矩阵的一般形式

- 将增广矩阵$B$通过**初等行变换**,可以得到等价的**行阶梯形矩阵**$\widetilde{B}$

- 线性方程组的增广矩阵$B$可以一般地设为如下形式(为书写方便,将$\widetilde{B}$作$C$)

- $$
  C=\widetilde{B}=
  \begin{pmatrix}
  c_{11} & c_{12} & \cdots & c_{1 r} & c_{1 r+1} & \cdots & c_{1 n}&d_1 \\
  0 & c_{22} & \cdots & c_{2 r} & c_{2 r+1} & \cdots & c_{2 n}&d_2 \\
  \vdots & \vdots & & \vdots & \vdots & & \vdots &\vdots\\
  0 & 0 & \cdots & c_{r r} & c_{r r+1} & \cdots & c_{rn}&d_r \\
  0 & 0 & \cdots & 0 & 0 & \cdots & 0  & d_{r+1}\\
  \vdots & \vdots & & \vdots & \vdots & & \vdots& \vdots \\
  0 & 0 & \cdots & 0 & 0 & \cdots & 0& 0
  \end{pmatrix}
  $$

- C中的$c_{ii}(i=1,2,\cdots,r)$可能是0元素,若$A$是列满秩的(字母$a,b$被$A,\bold{b}$占用,这里用$c$表示)

- $d_{r+1}$=0表示方程组有解;否则方程组无解

### 系数矩阵和增广矩阵秩的关系

- 设线性方程组的方程个数为$m$,未知数个数为$n$:即矩阵$A$是$m\times{n}$的,矩阵$B=(A,\bold{b})$是$m\times{n+1}$的
  - $R(A)\leqslant{R(B)}\leqslant{R(A)}+1\leqslant{n+1}$
  - $R(A)\leqslant{R(B)}\leqslant{m}$
    - 若$R(A)=m$,由夹逼原理,$R(B)=R(A)=m$,
    - 这就是说,如果$A$是**行满秩矩阵**,则增广矩阵$B$也是行满秩矩阵,且$R(A)=R(B)=m$

### 推理方式0

- 若$\bold{b}$是非零向量,则$R(\bold{b})=1$;
  - 利用第一行(第一个元素)倍增到其他行第$2,\cdots,m$元素为0,可得$R(\bold{b})=1$
  - 利用秩的定义也容易判定,$R(b)=1$,因为至少$\bold{b}$有一个非零元素,即$R(\bold{b})\geqslant{1}$;又因为$R(\bold{b})\leqslant{\min(1,m)}$,所以$R(\bold{b})=1$

- 行阶梯形矩阵的每一个级阶梯的高度为1可知,$\widetilde{B}$的最后一列**主元至多有一个**;
- 设$A$的秩为$r$,则$\widetilde{B}$因为包含A所以秩至少为$r$
  - 若最后一列存在主元,则一定是最后一个非零行的主元,此时$R(\widetilde{B})=r+1$
  - 若最后一列没有主元,那么$R(\widetilde{B})=r$
- 由此可得出$\widetilde{B}$的一般形式

### 推理方式1

- 在讨论分块矩阵秩的性质中,有$R(A_1),R(A_2)\leqslant R(A_1,A_2)\leqslant{R(A_1)+R(A_2)}$
- 对于增广矩阵$B=(A_{m\times{n}},\bold{b}_{m\times{1}})$,有${R(A),R(\bold{b})}\leqslant R(B)\leqslant{R(A)+R(\bold{b})}$
  - 其中$\bold{b}$只有一列,所以$R(b)\leqslant{1}$,若$A$是非零矩阵,则结论作$R(\bold{b})\leqslant R(A)\leqslant R(B)\leqslant{R(A)+R(\bold{b})}$ $\leqslant{R(A)+1}$
  - 即$R(A)\leqslant{R(B)}\leqslant{R(A)}+1$
- 结合行阶梯形矩阵的秩和非零行数的相等关系可得出$\widetilde{B}$的一般形式

### 对角非零行阶梯形矩阵

- 对$\widetilde{B}$的$1,\cdots,n$列间作一定的**列交换**,可以得到$\widetilde{B}$的**列等价的矩阵**,

  - $$
    C_1=
    \begin{pmatrix}
    c'_{11} & c'_{12} & \cdots & c'_{1 r} & c'_{1 r+1} & \cdots & c'_{1 n}&d_1 \\
    0 & c'_{22} & \cdots & c'_{2 r} & c'_{2 r+1} & \cdots & c'_{2 n}&d_2 \\
    \vdots & \vdots & & \vdots & \vdots & & \vdots &\vdots\\
    0 & 0 & \cdots & c'_{r r} & c'_{r r+1} & \cdots & c'_{rn}&d_r \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0  & d_{r+1}\\
    \vdots & \vdots & & \vdots & \vdots & & \vdots& \vdots \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0& 0
    \end{pmatrix}
    $$

  - 可以使得$c'_{ii}(i=1,2,\cdots,r)\neq{0}$,将此时的矩阵记为D



### 强化行最简形矩阵🎈

- 矩阵A通过**初等变换**化简为"包含$r$阶单位子阵**行简化矩阵**"后的等价矩阵称为强化行最简形矩阵,或简称**解形矩阵**

  - 先将行阶梯形矩阵$C$化为**非零对角行阶梯形矩阵**(记为$C_1$)

  - 再将$C_1$的第$i$行非零行除以第$i$行的主元使得$C_1$转换为$C_2$,此时$C_2$的非零对角线元素全部被化为1;

  - 再通过有限步的**行倍增**,使得$r$个主元所在列的所有非主元被化为0,即前$r$行$r$列构成一个**单位阵**,将此时的矩阵记为$D$

  - $$
    D=\begin{pmatrix}
    E_{r},X_{r\times{s}}\\
    0_{t\times{r}},0_{t\times{s}}
    \end{pmatrix}
    $$

  - 非零行的前$r$列构成一个$r$阶单位阵,记矩阵A的秩$r=r(A)$

  - $r+s=n$是矩阵A的列数;$r+t=m$是矩阵的行数

  - 矩阵$X$的内容可以是任意的

- Note:在从线性方程组的增广矩阵$C$得到矩阵$D$的过程中,所施加的初等变换包括初等行变换和列交换,都是**同解变换**

- 矩阵$D$接近但不同于标准形矩阵($X=O$时才是标准形),而是介于行最简形矩阵和标准形矩阵之间的状态

- 这种形式很有用,我们很容易从中读出矩阵对应的线性方程组的解的情况

#### 补充:列变换的同解性

- 值得注意的是,不是所有矩阵都能够只通过初等行变换就能够得到强化行简化矩阵,有时还需要借助列变换中的**列交换**操作

- 而做**列交换**的第$i,j$列,意味着它们的系数发生交换,从线性方程组的角度不会影响方程组的解(因为加法满足交换律)

  - $$
    \\
    \begin{cases}
    a_{11}x_1+a_{12}x_2=b_1
    \\
    a_{21}x_1+a_{22}x_2=b_2
    \end{cases}
    \\
    \begin{cases}
    a_{12}x_2+a_{11}x_1=b_1
    \\
    a_{22}x_2+a_{21}x_1=b_2
    \end{cases}
    $$
    
  - 上述两个方程组的解是一样的,虽然它们的系数矩阵却不一样

  - 如果以$x_i=a_i,i=1,2,\cdots,n$的形式表示方程组的解,则可认为解的形式也是完全一致的,可以认为是通解

  - Note:唯一要注意的是,列的顺序颠倒了,两个方程组的解向量通过调调整元素顺序可以相等;

### 线性方程组有解无解的讨论🎈

- 有了上述讨论作为铺垫,就容易理解以下对线性方程组解的讨论

- 我们借助线性方程组的增广矩阵的秩来分析解的情况,在有解的情况下,可以进一步化简为强化行最简形矩阵,可以读出解

- $$
  D=\begin{pmatrix}
  1 & 0 & \cdots & 0 & c_{1,r+1} & \cdots & c_{1,n} &d_1\\
  0 & 1 & \cdots & 0 & c_{2,r+1} & \cdots & c_{2,n} &d_2\\
  \vdots & \vdots & & \vdots & \vdots & & \vdots &\vdots\\
  0 & 0 & \cdots & 1 & c_{r,r+1} & \cdots & c_{r,n}&d_r \\
  0 & 0 & \cdots & 0 & 0 & \cdots & 0 &d_{r+1}\\
  \vdots & \vdots & & \vdots & \vdots & & \vdots&\vdots \\
  0 & 0 & \cdots & 0 & 0 & \cdots & 0&0
  \end{pmatrix}
  $$

  - 可将$T$用另一种写法代替(从$1$开始计数,共有$n-r$列):

  - $$
    \begin{pmatrix}
    1 & 0 & \cdots & 0 & c_{1,1} & \cdots & c_{1,n-r} &d_1\\
    0 & 1 & \cdots & 0 & c_{2,1} & \cdots & c_{2,n-r} &d_2\\
    \vdots & \vdots & & \vdots & \vdots & & \vdots &\vdots\\
    0 & 0 & \cdots & 1 & c_{r,1} & \cdots & c_{r,n-r}&d_r \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0 &d_{r+1}\\
    \vdots & \vdots & & \vdots & \vdots & & \vdots&\vdots \\
    0 & 0 & \cdots & 0 & 0 & \cdots & 0&0
    \end{pmatrix}
    $$

- 矩阵$D$是行阶梯形矩阵的一种,因此非零行数(秩)和最元素的行阶梯形矩阵$C$的秩相等;

- 矩阵$D$相比于矩阵$C$在有解的情况下更容易看出解;由矩阵$C$也可以判定矩阵是否有解

- cases1:$d_{r+1}\neq{0}$

  - 第$r+1$行对应于一个矛盾方程,无解,即整个方程组无解
- cases2:$d_{r+1}=0$

  - case2.1:$r=n$,则方程组有唯一解:$x_i=d_i$,$i=1,2,\cdots,n$
  - case2.2:$r<n$,方程组有多解,下一节展开介绍
    - $x_i=d_i-\sum\limits_{k=1}^{s} c_{i,k}\times x_{r+k}$,$i=1,2,\cdots,n$;其中自由未知量为$x_{r+1},x_{r+2},\cdots,{x_{n}}$



#### 补充:自由未知量和通解形式🎈

- $$
  \begin{pmatrix}
      x_{1}   \\
      \vdots \\
      x_{i}   \\
      \vdots  \\
      x_{r}   \\
  \end{pmatrix}
  =\begin{pmatrix}
      d_1-\sum\limits_{k=1}^{n-r} c_{1,k}\times x_{r+k}     \\
      \vdots \\
      d_i-\sum\limits_{k=1}^{s} c_{i,k}\times x_{r+k}     \\
      \vdots  \\
      d_r-\sum\limits_{k=1}^{s} c_{r,k}\times x_{r+k}     \\
  \end{pmatrix}
  $$
  
- 这里$r$是系数矩阵$A$的秩

- 任意给定一组$(x_i)_{1\times{s}},i=r+1,r+2,\cdots{n=r+s}$,将$x_{r+1},x_{r+2},\cdots,x_{n}$称为**自由未知量**,可以唯一确定$(x_i)_{1\times{r}}=x_1,x_2,\cdots,x_r$的值,这样的一组表达式称为方程组的**通解**或**一般解**

## 归纳:线性方程组有解判定定理



### 无解:

1. 无解的充分必要条件是$R(A)<R(A,\boldsymbol{b})$

### 有解

1. 有唯一解的充要条件是$R(A)=R(A,\boldsymbol{b})=n$
2. 有无限多解的充要条件是$R(A)=R(A,\boldsymbol{b})<n$

## 线性方程组的解的案例

- 直接来一个硬题

- 假设某个3方程3元线性方程的线性方程组的增广矩阵表示为$B$,讨论解的情况

- $$
  B=\begin{pmatrix}
  1+\lambda&1&1&0\\
  1&1+\lambda&1&3\\
  1&1&1+\lambda&\lambda
  \end{pmatrix}
  $$

### 分类讨论法(通法)

#### 分析

- $B$经过一系列的初等行变换后,得到:

- $$
  \widetilde{B}=(\widetilde{A},{\bold{b}_1})
  =\begin{pmatrix}
      1&1&1+\lambda&\lambda\\
      0&\lambda&-\lambda&3-\lambda\\
      0&0&-\lambda(3+\lambda)&(1-\lambda)(3+\lambda)
  \end{pmatrix}
  $$

- $$
  \widetilde{A}
  =\begin{pmatrix}
      1&1&1+\lambda\\
      0&\lambda&-\lambda\\
      0&0&-\lambda(3+\lambda)
  \end{pmatrix}
  $$

- 以下将$A$的秩作为分类讨论的标准,用完全归纳法求解
  - 基本原理是线性方程组有解判定定理,其重点是比较$R(A)$,$R(B)$和$n=3$的大小
  - 本例子中包含一个参数$\lambda$,当$\lambda$被赋予一个确定值,$R(A),R(B)$就会被确定,从而方程组解的情况就被确定
  - 如果按照$R(A)<R(B)$,$R(A)=R(B)<n$,$R(A)=R(B)=n$(无解,有唯一解,有多解)作为讨论标准是很直接的想法
    - 然而例如$R(A)<R(B)$包含了较多更细分的可能,比如$R(A)=1,R(B)=2$或$R(A)=2,R(B)=3$

  - 更具体的,可以将$R(A)$的取值作为分类讨论的标准,因为本例$R(A)$的取值范围是$1,2,3$,能够规避前一种分类方式中的重复试探$R(A)$的值的工作,提高归纳讨论效率;最后根据需要,可能要将结果换一种顺序组织并表达出来


#### 分类讨论

- case1:$R(A)=3$
  - 此时系数矩阵A是行满秩矩阵,因此可以直接确定$R(A)=R(B)=3$,方程组**有唯一解**
  - 条件是$-\lambda(3+\lambda)\neq{0}$得:$\lambda\neq{0}$且$\lambda\neq{-3}$

- case2:$R(A)=2$
  - $\widetilde{A}$的第2行非零且第三行为0,即:
    - $\lambda或-\lambda\neq{0}$,即$\lambda\neq{0}$且$-\lambda(3+\lambda)=0$即$\lambda=0$或$\lambda=-3$

  - 综上,$\lambda=-3$
  - 此时$(1-\lambda)(3+\lambda)=0$,$R(A)=R(B)=2<n=3$,方程组**有无穷多解**

- case3:$R(A)=1$:

  - 此时$\widetilde{A}$的第$2,3$行全为0,即:
    - $\lambda=-\lambda=0$,解得$\lambda=0$
    - $-\lambda(3+\lambda)$=0,解得:$\lambda=0$或$\lambda=-3$
    - 综上$\lambda=0$
  - 代入$\lambda=0$到$\widetilde{B}$可知$\widetilde{B}$第$2,3$行不是零行,因此,$R(B)=3$,即$R(A)<R(B)$,方程组**无解**

#### 组织讨论的结果并总结

- 当$\lambda\neq{0}$且$\lambda\neq{-3}$,方程组有唯一解
- 当$\lambda=-3$,方程组有无穷多解
- 当$\lambda=0$,方程组无解

### 行列式判别法(技法)

- 本例中的系数矩阵恰好是个方阵,优先考虑利用Cramer's Rule讨论方程组的解

- Cramer法则给出唯一解的条件是$|A|\neq{0}$,即

  - $$
    |A|=\begin{vmatrix}
    1+\lambda&1&1\\
    1&1+\lambda&1\\
    1&1&1+\lambda
    \end{vmatrix}
    =\begin{vmatrix}
    3+\lambda&3+\lambda&3+\lambda\\
    1&1+\lambda&1\\
    1&1&1+\lambda
    \end{vmatrix}
    =(3+\lambda)
    \begin{vmatrix}
    1&1&1\\
    1&1+\lambda&1\\
    1&1&1+\lambda
    \end{vmatrix}\\
    =(3+\lambda)
    \begin{vmatrix}
    1&1&1\\
    0&\lambda&0\\
    0&0&\lambda
    \end{vmatrix}=(3+\lambda)\lambda^2
    $$

  - 可见$\lambda\neq{0}$且$\lambda\neq{-3}$时,方程组有唯一解

- 当$|A|=0$时,即$\lambda=0$或$\lambda=-3$时方程组可能无穷多解或者无解;分别对$\lambda=0,-3$代入增广矩阵中讨论,此时问题转换为无参数线性方程组,依然采用初等变换法,将增广矩阵化为行阶梯形矩阵判断

  - 当$\lambda=0$时,$R(A)=1,R(B)=2$,此时方程组无解
  - 当$\lambda=-3$时,$R(A)=R(B)=2$,此时方程组有无穷多解



### Cramer法则求解带参数系数矩阵线性方程组讨论问题👺

- 这类情况$A$系数矩阵是方阵,可以考虑使用Cramer法则通过计算**行列式**来求解
- 因为行列式$|A|\neq{0}$表示方程仅有唯一解($R(A)=R(B)=n$)
- 虽然我们方阵系数行列式只能确定这一种情况,但是依然可以求解出所有其他情况:
  - $|A|=0$对应于方程组可能有无穷多解和无解两种可能
  - 先求出$|A|=0$下所有的(有限个)$\lambda$值:$\lambda_1,\lambda_2,\cdots$)
  - 分别将这些具体的参数带入到增广矩阵中,得到无参数的参数矩阵
  - 依次利用初等变换法变形矩阵得到行阶梯行矩阵
  - 分别分析这些情况,所得到的结果即包含了所有可能的情况(无解和多解)

### 带参数的矩阵的初等变换过程中的倍增问题

- 假设$f(\lambda)$是关于$\lambda$的表达式,那么形如$r_i\times{\frac{1}{f(\lambda)}}$这类变换有一个前提(假设):$f(\lambda)\neq{0}$
- 但是$f(\lambda)$是可能等于0的,这时还需要**额外讨论**$f(\lambda)=0$的情形以免漏解
- 总之,如果做了上述类型的变换,就需要额外讨论,否则不需要额外讨论

