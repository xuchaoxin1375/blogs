[toc]



## 二次型的标准形🎈



- 如果二次型只含有变量的平方项,则称之为**二次型的标准形**或**法式**,即$f(y_1,\cdots,y_n)$=$\sum_{i=1}^{n}k_iy_i^2$

### 标准形的矩阵式



- $$
  \begin{aligned}
      f(y_1,\cdots,y_n)
      &=\sum_{i}^{n}k_iy_i^2\\
      &=(y_1,y_2,\cdots,y_n)
      \begin{pmatrix}
          k_{1}  &0  &\cdots  &0  	\\
          0  &k_{2}  &\cdots  &0  	\\
          \vdots  &\vdots  &        &\vdots  	\\
          0  &0  &\cdots  &k_{n}  	\\
      \end{pmatrix}
      \begin{pmatrix}
          y_{1}\\
          y_{2}\\
          \vdots		\\
          y_{n}	\\
      \end{pmatrix}
      \\&=\bold{{y}^{T}\Lambda{{y}}}
  \end{aligned}
  $$

- 可见,标准形的矩阵是**对角阵**$\Lambda=\text{diag}(k_1,\cdots,k_n)$

- 对角阵的秩$R(\bold\Lambda)$等于$k_1,\cdots,k_n$中的非零值个数,$r(\bold\Lambda)=\sum\limits_{k_i\neq0}1$

### 标准化问题(合同对角化)

- 结合标准形的矩阵式可知,"二次型$f=\bold{x^{T}Ax}$经过某个可逆变换$\bold{x=Cy}$变成标准形",就是要使线性变换后的二次型$g=\bold{y^{T}Dy}$中的$\bold{D=C^{T}AC}$变成一个**对角阵**$\bold{\Lambda}=\text{diag}(k_1,\cdots,k_n)$,也就是将$\bold{A}$**合同对角化**
- 更进一步地,将$\bold\Lambda$地元素$k_i,i=1,\cdots,n$处理成$-1,0,1$中的元素,称为**规范化**,详见规范化一文
- Note:合同对角化不是相似对角化



### 二次型标准化分析🎈

- 如果存在某个可逆阵$\bold P$使得$\bold{P^{T}AP={\Lambda}}=\text{diag}(k_1,\cdots,k_n)$即$\bold{A}$可以合同于某个对角阵$\bold\Lambda$,则$f=\bold{x^{T}Ax}$可以通过可逆线性变换进行标准化
- 或者说,能够找到可逆矩阵$\bold{P}$,使得线性变换$\bold{x=Py}$,能够将二次型$f=\bold{x^{T}Ax}$标准化为$g=\bold{y^{T}\Lambda{y}}$,其中$\bold\Lambda$=$\bold{P^{T}AP}$

## 二次型可标准化定理

### 正交相似角度证明

- 由于任意对称阵都合同于某个对角阵,又二次型$f$的矩阵一定对称阵,所以**任何二次型都可以标准化**
- 总结为定理:任意二次型$f=\bold{x^{T}A{x}}$总有**正交变换**$\bold{x=Py}$使得$f$化为标准形$f=\sum_{i=1}^{n}\lambda_iy_{i}^{2}$,且$\lambda_1,\cdots,\lambda_n$是$\bold{A}$的**特征值**
  - 因为$\bold{P}$是正交阵$(\bold{P^{T}=P^{-1}})$,所以相似对角化等价于合同对角化:若$\bold{P^{-1}AP=\Lambda}$,则$\bold{P^{T}AP=\Lambda}$
  - 因此,掌握了对称阵的相似对角化,也就能够通过求解使$\bold{A}$相似对角化的可逆矩阵$\bold{P}$来求得使$\bold{A}$合同对角化的$\bold{P}$



### 配方角度证明

- 数域$P$上任意一个二次型都可以经过非退化(可逆的)线性替换变成平方和形式(标准形)



- 以下证明给出来了一个具体地把二次型化为平方和的方法,和中学里的配方法一样

- 对变量的个数$k$作数学归纳法

- 对于$k=1$,二次型$f=a_{11}x_1^2$,其已经是标准形了

- 现假设$k=n-1$元的二次型定理成立;并设$k=n$元的二次型为$f(x_1,\cdots,x_n)$=$\sum_{i=1}^{n}\sum_{j=1}^{n}a_{ij}x_{i}x_{j}$,$(a_{ij}=a_{ji})$

  - $$
    f=\begin{pmatrix}
    	1&1&\cdots&1
    \end{pmatrix}
    \begin{pmatrix}
        a_{11}x_1x_1&a_{12}x_1x_2&\cdots&a_{1n}x_1x_n	\\
        a_{21}x_2x_1&a_{22}x_2x_2&\cdots&a_{2n}x_2x_n	\\
        \vdots&\vdots&&\vdots\\
        a_{n1}x_nx_1&a_{n2}x_nx_2&\cdots&a_{nn}x_nx_n	\\
    \end{pmatrix}
    \begin{pmatrix}
    	1\\1\\\vdots\\1
    \end{pmatrix}
    $$

- 以下分情况讨论



#### case1

- $f$中至少含有一个平方项:$\exist{\;a_{ii}\neq{0}}$,$i\in{1,2\cdots,n}$

  - 归并所有含有$x_i$的项

    - $$
      \eta_i
      =a_{ii}x_{i}^2+\sum_{j=1,j\neq{i}}^{n}a_{ij}x_ix_j
      +\sum_{j=1,j\neq{i}}^{n}a_{ji}x_jx_i
      \\
      =a_{ii}x_{i}^2+\sum_{j=1,j\neq{i}}^{n}2a_{ij}x_ix_j
      \\=a_{ii}x_i^2+2(\sum_{{j=1,j\neq{i}}}a_{ij}x_j)x_i
      $$

    - 显然$\eta_i$包含$1+(n-1)=n$个不可合并项

    - $f=\eta_i+\sum_{r,j\neq{i}}^{n}a_{rj}x_rx_j$

  - 然后进行配方

    - $$
      \begin{aligned}
      \eta_{i}
      &=a_{ii}(x_i^2+2\frac{1}{a_{ii}}(\sum_{{j=1,j\neq{i}}}a_{ij}x_j)x_i)
      \\&=a_{ii}
      \left(
          [x_i+\frac{1}{a_{ii}}
          (\sum\limits_{{j=1,j\neq{i}}}a_{ij}x_j)
          ]^2
          -[\frac{1}{a_{ii}}(\sum\limits_{{j=1,j\neq{i}}}a_{ij}x_j)]^2
      \right)\\
      \end{aligned}
      $$

    - 令$\alpha_i=a_{ii}[x_i+\frac{1}{a_{ii}}
          (\sum\limits_{{j=1,j\neq{i}}}a_{ij}x_j)]^2$,$\beta_i=a_{ii}[\frac{1}{a_{ii}}(\sum\limits_{{j=1,j\neq{i}}}a_{ij}x_j)]^2$;$\gamma_i=\sum_{r,j\neq{i}}^{n}a_{rj}x_rx_j$
    - 则$\eta_i=\alpha_i+\beta_i$
    - 这就将$\eta_i$改写为仅含平方项的形式,并且$\alpha_i,\beta_i$都是关于$\{x_1,\cdots,x_n\}-\{x_i\}$的$n-1$元二次型,且$\beta_i$包含了所有$x_i^2$之外的所有平方项
      - 由归纳假设可知$\beta_i+\gamma_i$可以被标准化
      - $f=\eta_i+\gamma_i=\alpha_i+\beta_i+\gamma_i$也可以被标准化

  - 为了讨论和书写方便,不妨设$a_{11}\neq{0}$,代表这一类情况

    - $$
      f(x_1,\cdots,x_n)=a_{11}x_1^{2}+\sum_{j=2}^{n}a_{ij}x_1x_j
      +\sum_{j=2}^{n}a_{ji}x_jx_1
      +\sum_{i=2}^{n}\sum_{j=2}^{n}a_{ij}x_{i}x_{j}
      $$

  - 配方

    - $$
      f=a_{11}x_1^2+2\sum_{j=2}^{n}a_{1j}x_1x_j
      +\sum_{i=2}^{n}\sum_{j=2}^{n}a_{ij}x_{i}x_{j}
      \\=a_{11}(x_1^2+2a_{11}^{-1}\sum_{j=2}^{n}a_{1j}x_{1}x_{j})
      +\sum_{i=2}^{n}\sum_{j=2}^{n}a_{ij}x_{i}x_{j}
      \\=a_{11}(x_1+a_{11}^{-1}\sum_{j=2}^{n}a_{1j}x_{j})^2-
      a_{11}(a_{11}^{-1}\sum_{j=2}^{n}a_{1j}x_j)^2
      +\sum_{i=2}^{n}\sum_{j=2}^{n}a_{ij}x_{i}x_{j}
      \\=a_{11}(x_1+a_{11}^{-1}\sum_{j=2}^{n}a_{1j}x_{j})^2
      +[-a_{11}^{-1}(\sum_{j=2}^{n}a_{1j}x_j)^2
      +\sum_{i=2}^{n}\sum_{j=2}^{n}a_{ij}x_{i}x_{j}]
      $$

    - 令$g(x_2,\cdots,x_n)=-a_{11}^{-1}(\sum_{j=2}^{n}a_{1j}x_j)^2
      +\sum_{i=2}^{n}\sum_{j=2}^{n}a_{ij}x_{i}x_{j}$

      - 其中$h_1(x_2,\cdots,x_n)=-a_{11}^{-1}(\sum_{j=2}^{n}a_{1j}x_j)^2$,$h_2(x_2,\cdots,x_n)=\sum_{i=2}^{n}\sum_{j=2}^{n}a_{ij}x_{i}x_{j}$是关于$x_2,\cdots,x_n$的$n-1$元二次型
      - 从而$g(x_2,\cdots,x_n)$也是关于$x_2,\cdots,x_n$的$n-1$元二次型

    - 构造线性变换$\bold{y=Px}$

      - $y_1=x_1+\sum_{j=2}^{n}a_{11}^{-1}a_{1j}x_j$

      - $y_2=x_2$

      - $\vdots$

      - $y_n=x_n$

      - 变换矩阵:

      - $$
        \bold P=\begin{pmatrix}
        1&a_{11}^{-1}a_{11}x_1&\cdots&a_{11}^{-1}a_{1n}x_n\\
        0&1&\cdots&0\\
        0&\vdots&&\vdots\\
        0&0&\cdots&1
        \end{pmatrix}
        $$

      - 显然$|\bold{P}|=1\neq{0}$,是个可逆变换

    - 其逆变换$\bold{x=P^{-1}y}$(将后$n-1$个方程回代到第$1$个方程即得)

      - $x_1=y_1-\sum_{j=2}^{n}a_{11}^{-1}a_{1j}x_j$
      - $x_2=y_2$
      - $\vdots$
      - $x_n=y_n$

    - 则该变换能使$f=a_{11}y_1^{2}+g({y_2,\cdots,y_n})$

    - 根据归纳假设,$g(y_2,\cdots,y_n)$可以被标准化,即存在可逆线性变换`(1)`:

      - $$
        \begin{pmatrix}y_2\\y_3\\\vdots\\y_n\end{pmatrix}
        =\begin{pmatrix}  
          c_{22}& c_{23}& \cdots  & c_{2n} \\  
          c_{32}& c_{33}& \cdots  & c_{3n} \\ 
          \vdots & \vdots & \ddots & \vdots \\  
          c_{n2}& c_{n3}& \cdots  & c_{nn}  
        \end{pmatrix}
        \begin{pmatrix}z_2\\z_3\\\vdots\\z_n\end{pmatrix}
        $$

      - $$
        \begin{aligned}
            y_{2}&=c_{22} z_{2}+\cdots+c_{2 n} z_{n}, \\
            y_{3}&=c_{32} z_{2}+\cdots+c_{3 n} z_{n}, \\
            \vdots\\
            y_{n}&=c_{n 2} z_{2}+\cdots+c_{n n} z_{n}
        \end{aligned}
        $$

      - 此变化能使$g(y_2,\cdots,y_n)$=$t(z_2,\cdots,z_n)$=$\sum_{j=2}^{n}d_jz_{j}^{2}$

      - 此时$f=a_{11}y_1^2+\sum_{j=2}^{n}d_jz_{j}^{2}$

    - 基于`(1)`追加一条变换:$y_1=z_1$,得到$n$元变换`(2)`:

      - $$
        \begin{aligned}
        	y_{1}&=z_1\\
            y_{2}&=c_{22} z_{2}+\cdots+c_{2 n} z_{n}, \\
            y_{3}&=c_{32} z_{2}+\cdots+c_{3 n} z_{n}, \\
            \vdots\\
            y_{n}&=c_{n 2} z_{2}+\cdots+c_{n n} z_{n}
        \end{aligned}
        $$

      - $$
        \begin{pmatrix}y_1\\y_2\\\vdots\\y_n\end{pmatrix}
        =\begin{pmatrix}  
        1&0&\cdots&0\\
        0& c_{22}& \cdots  & c_{2n} \\  
        0& c_{32}& \cdots  & c_{3n} \\ 
          \vdots & \vdots & \ddots & \vdots \\  
        0& c_{n2}& \cdots  & c_{nn}  
        \end{pmatrix}
        \begin{pmatrix}z_1\\z_2\\\vdots\\z_n\end{pmatrix}
        $$

    - 线性变换`(2)`能将$f$化为标准形$f=\sum_{j=1}^{n}d_jz_{j}^{2}$

    - 由归纳法原理,定理在case1成立

####  方法1:

##### case2

- 若$f$中不含**平方项**($x_i^2$的系数$a_{ii}=0$,$i=1,\cdots,n$),但至少存在一个$a_{ij}\neq{0}$,$i\neq{j}$
- 则构造关于$y_1,\cdots,y_n$的线性变换$x_1=y_i+y_j$,$x_2=y_i-y_j$,$x_r=y_r,r\neq{i,j}$
  - 易知该变换矩阵是一个上三角形,其对角线元素之积为1,从而可逆
  - 变换{T}能使:$x_ix_j=(y_i-y_j)(y_i+y_j)=y_i^2-y_j^2$,即非平方二次项化为平方项组合
    - 从而$x_ix_j=(z_i+z_j)(z_i-z_j)$=$z_i^2-z_j^2$
      - $a_{ij}x_{i}x_j$=$a_{ij}(z_i^2-z_j^2)$=$a_{ij}z_i^2-a_{ij}z_j^2$
    - 所以:$f(x_i,\cdots,x_n)$=$2a_{ij}x_{i}x_j+\cdots$=$2a_{ij}z_i^2-2a_{ij}z_j^2+\cdots$

- 这种变换的意义在于将无平方项二次型转换为有平方项二次型,从而将问题转换为第一类情况(case1),即这类二次型仍然可以标准化,即定理在case2也成立

#### 方法2

##### case2

- 为了方便讨论,不妨再细分为两种子情况,cases2研究第一种,第2种放到caes3中讨论

- 若$a_{1j}\neq{0},(j>1)$,更进一步地,可以设$a_{12}\neq{0}$,这种假设仍然不失一般性

  - 执行可逆变换{T}:

    - $$
      T:\begin{cases}
          x_1=y_1-y_2\\
          x_2=y_1+y_2\\
          x_3=y_3\\
          \vdots\\
          x_n=y_n
      \end{cases}
      $$

    - 易知该变换矩阵是一个上三角形,其对角线元素之积为1,从而可逆

      - 变换{T}能使:$x_ix_j=(y_i-y_j)(y_i+y_j)=y_i^2-y_j^2$,即非平方二次项化为平方项组合
        - 从而$x_1x_2=(z_1+z_2)(z_1-z_2)$=$z_1^2-z_2^2$
          - $a_{12}x_{1}x_2$=$a_{12}(z_1^2-z_2^2)$=$a_{12}z_1^2-a_{12}z_2^2$
        - 所以:$f(x_1,\cdots,x_n)$=$2a_{12}x_{1}x_2+\cdots$=$2a_{12}z_1^2-2a_{12}z_2^2+\cdots$



##### case3

- 延续cases2中假设$a_{1j}\neq{0}$,cases3研究其互斥的情况:

- 若$a_{1j}=0$,$j=1,\cdots,n$

- 根据二次型矩阵的对称性,$a_{j1}=0$,$j=1,\cdots,n$

- 从而$f(x_1,\cdots,x_n)$=$\sum_{i=2}^{n}\sum_{j=2}^{n}a_{ij}x_ix_j$,这是一个$n-1$元的二次型,根据归纳假设,它能够标准化

  



















