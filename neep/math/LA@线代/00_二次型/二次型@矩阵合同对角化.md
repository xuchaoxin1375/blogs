[toc]

## 二次型引言

- 二次型的理论起源于解系几何中的"二次曲线"和"二次曲面"方程的化简问题

- 在解析几何中,为了便于研究二次曲线$ax^2+bxy+cy^2=1$`(1)`(或$\sum_{i=0}^{2}a_ix_1^{2-i}x_2^{i}=1$)的**几何性质**,可以选择**适当**的**坐标旋转变换**

  - 旋转前后曲线"形状"不变,只是位置可能发生改变;

  - 图形旋转$\theta$角,等价于图形上所有点作同样角度的旋转;

  - 假设$\theta$就是满足需求的旋转角度,能够使得曲线方程仅包含平方项的标准形

  - 还可以理解为,曲线`(1)`可以通过对标准形方程$mx'^2+ny'^2=1$`(1.1)`对应的曲线旋转$\theta$后得到

  - 变换公式`(2)`
    - $$
      x=x'\cos{\theta}-y'\sin{\theta}\\
      y=x'\sin{\theta}+y'\cos{\theta}
      $$

    - 变换矩阵为$\begin{pmatrix}\cos\theta&-\sin\theta\\\sin\theta&\cos\theta\end{pmatrix}$

  - 若曲线`(1.1)`上的任意一点在极坐标系上表示为$P'(r,\phi)$,则$P$的直角坐标系坐标表示为$P'(r\cos\phi,r\sin{\phi})$
  - `(1.1)`经过线性变换`(2)`(即逆时针旋转$\theta$角)后的曲线`(1)`上的任意点$P(x,y)$=$(r\cos(\phi+\theta),r\sin(\phi+\theta))$,由于$P(x,y)$在曲线`(1)`上,所以$a(r^2\cos^2(\phi+\theta))+b(r^2\cos(\phi+\theta)\sin(\phi+\theta))+c(r^2\sin(\phi+\theta))$=1
    - 若想要其中的非平方项消去,需要满足$\cos(\phi+\theta)=0$或$\sin(\phi+\theta)=0$,例如$\theta=\frac{1}{2}\pi-\phi$或$-\phi$
    - 此时$ax'^2+cy'^2=1$

- 从代数学的观点看,化标准形的过程就是通过**变量的线性变换**化简一个**二次齐次多项式**,使得它**仅含有平方项**

- 将这个问题一般化,即讨论$n$个变量的**二次齐次多项式的化简问题**,由此引出**二次型**

### n元二次型定义

- 含有$n$个未知数(变量)$x_1,\cdots,x_n$的**二次齐次多项式**$f(x_1,\cdots,x_n)$=$\sum_{i=1}^{n}a_{ii}x_i^2$+$2(\sum_{i,j}^{n}a_{ij}x_ix_j)$
  - $\sum_{i,j}$表示所有可能的不超过$n$的正整数组合,因为$x_ix_j$=$x_jx_i$,所以$i,j$和$j,i$视为同一种组合
  - 不妨设$0<i\leqslant {j}\leqslant{n}$
  - 这个二次多项式包含的(不可合并)二次项数目为$n+\binom{n}{2}$=$\frac{(n+1)n}{2}$=$n+\frac{n(n-1)}{2}$


#### 实二次型和复二次型

- $a_{ij}$是实数的二次型称为实二次型
- $a_{ij}$是复数的二次型称为复二次型
- 显然实二次型是复二次型的子集,这里仅讨论实二次型

#### 二重求和表示

- 不妨将$f$的非平方二次项的部分拆成两部分(不合并):$2(\sum_{i,j}^{n}a_{ij}x_ix_j)$=$\sum_{i,j}^{n}a_{ij}x_ix_j$+$\sum_{i,j}^{n}a_{ji}x_jx_i$
  - 其中$a_{ji}=a_{ij}$;$x_{j}x_{i}=x_{i}x_{j}$

- 那么$f$的展开项有$n+2\binom{n}{2}$=$n^2$;从而:$f$=$\sum\limits_{i=1}^{n}\sum\limits_{j=1}^{n}a_{ij}x_ix_j$

#### 内积表示

- 熟悉向量内积的同学可以想到求和可以用内积简洁的表达

- 如果是多重求和,那么可以用内积链表达

  - $\sum_{k=1}^{n}a_kx_k$=$(a_1,\cdots,a_n)(x_1,\cdots,x_n)^{T}$

  - $$
    \begin{aligned}
        \sum_{i=1}^{n}\sum_{j=1}^{n}a_{ij}x_{j}
        &=(1,\cdots,1)
        \begin{pmatrix}
            \sum_{j=1}^{n}a_{1j}x_j\\
            \vdots\\
            \sum_{j=1}^{n}a_{nj}x_j
            \end{pmatrix}
        \\&=(1,\cdots,1)
        \begin{pmatrix}
            (a_{i1},\cdots,a_{in})(x_1,\cdots,x_n)^T\\
            \vdots\\
            (a_{n1},\cdots,a_{nn})(x_1,\cdots,x_n)^T
        \end{pmatrix}\\
        &=(1,\cdots,1)((a_{11},\cdots,a_{1n})(x_1,\cdots,x_n)^T,\cdots,(a_{n1},\cdots,a_{nn})(x_1,\cdots,x_n)^T)^T
    \end{aligned}
    $$

  - 定义矩阵
    $$
    \bold{P}=\begin{pmatrix}
        \sum_{j=1}^{n}a_{1j}x_j\\
        \vdots\\
        \sum_{j=1}^{n}a_{nj}x_j
    \end{pmatrix}
    $$

    - 这个矩阵是我们数系的形式,即线性方程组等号左边的表达式矩阵,它可以用矩阵乘法进行分解:

    - $$
      \bold{P=Ax}
      =\begin{pmatrix}
              a_{11}  &a_{12}  &\cdots  &a_{1n}  	\\
              a_{21}  &a_{22}  &\cdots  &a_{2n}  	\\
              \vdots  &\vdots  &        &\vdots  	\\
              a_{n1}  &a_{n2}  &\cdots  &a_{nn}  	\\
          \end{pmatrix}
          \begin{pmatrix}
              x_{1}\\
              x_{2}\\
              \vdots		\\
              x_{n}	\\
          \end{pmatrix}
      $$

- 对于$f=\sum\limits_{i=1}^{n}\sum\limits_{j=1}^{n}a_{ij}x_ix_j$=$\sum\limits_{i=1}^{n}x_i (\sum\limits_{j=1}^{n}a_{ij}x_j)$

  - $$
    f=(x_1,\cdots,x_n)
    (
    	(a_{11},\cdots,a_{1n})(x_1,\cdots,x_n)^T,
    	\cdots,(a_{n1},\cdots,a_{nn})	
    	(x_1,\cdots,x_n)^T
    )^T
    $$

#### 矩阵表示式👺

- $$
  \begin{aligned}
  f&=\sum\limits_{i=1}^{n}x_i (\sum\limits_{j=1}^{n}a_{ij}x_j)\\
      &=(x_1,x_2,\cdots,x_n)
          \begin{pmatrix}
              \sum\limits_{j}a_{1j}x_j  	\\
              \sum\limits_{j}a_{2j}x_j    	\\
              \vdots   	\\
              \sum\limits_{j}a_{nj}x_j    	\\
          \end{pmatrix}\\
      &=(x_1,x_2,\cdots,x_n)
          \begin{pmatrix}
              a_{11}  &a_{12}  &\cdots  &a_{1n}  	\\
              a_{21}  &a_{22}  &\cdots  &a_{2n}  	\\
              \vdots  &\vdots  &        &\vdots  	\\
              a_{n1}  &a_{n2}  &\cdots  &a_{nn}  	\\
          \end{pmatrix}
          \begin{pmatrix}
              x_{1}\\
              x_{2}\\
              \vdots		\\
              x_{n}	\\
          \end{pmatrix}
  \end{aligned}
  $$

  

- 定义如下矩阵
  $$
  \bold{x}=\begin{pmatrix}
  	x_{1}\\
  	x_{2}\\
  	\vdots		\\
  	x_{n}	\\
  \end{pmatrix}
  \\\bold{x}^T=(x_1,x_2,\cdots,x_n)
  \\
  \bold A=\begin{pmatrix}
  	a_{11}  &a_{12}  &\cdots  &a_{1n}  	\\
  	a_{21}  &a_{22}  &\cdots  &a_{2n}  	\\
  	\vdots  &\vdots  &        &\vdots  	\\
  	a_{n1}  &a_{n2}  &\cdots  &a_{nn}  	\\
  \end{pmatrix}
  $$

- 则二次型$f=\bold{x^{T}Ax}$



#### 小结

- $$
  \begin{aligned}
      f(x_1,\cdots,x_n)
      &=\sum_{i=1}\sum_{j=1}a_{ij}x_ix_j 
      \\
      &=\sum\limits_{1\leqslant {i}< {j}\leqslant{n}}^{}2a_{ij}x_ix_j
      	+\sum\limits_{i=j}^{}a_{ij}x_ix_j
      \\
      &=\bold{x^{T}Ax}
  \end{aligned}
  $$

- 对于二次型矩阵$\bold{A}$,$(\bold{A^{T}=A})$,因为$a_{ij}=a_{ji}$

#### hadamard乘积表示

$$
X=xx^T=\begin{pmatrix}
	x_{1}\\
	x_{2}\\
	\vdots		\\
	x_{n}	\\
\end{pmatrix}
(x_1,x_2,\cdots,x_n)
=\begin{pmatrix}
    x_1x_1&x_1x_2&\cdots&x_1x_n	\\
    x_2x_1&x_2x_2&\cdots&x_2x_n	\\
    \vdots&\vdots&&\vdots\\
    x_nx_1&x_nx_2&\cdots&x_nx_n	\\
\end{pmatrix}_{n\times{n}}
\\
S=A\odot X
=\begin{pmatrix}
	a_{11}  &a_{12}  &\cdots  &a_{1n}  	\\
	a_{21}  &a_{22}  &\cdots  &a_{2n}  	\\
	\vdots  &\vdots  &        &\vdots  	\\
	a_{n1}  &a_{n2}  &\cdots  &a_{nn}  	\\
\end{pmatrix}
\odot
\begin{pmatrix}
    x_1x_1&x_1x_2&\cdots&x_1x_n	\\
    x_2x_1&x_2x_2&\cdots&x_2x_n	\\
    \vdots&\vdots&&\vdots\\
    x_nx_1&x_nx_2&\cdots&x_nx_n	\\
\end{pmatrix}
\\
=\begin{pmatrix}
    a_{11}x_1x_1&a_{12}x_1x_2&\cdots&a_{1n}x_1x_n	\\
    a_{21}x_2x_1&a_{22}x_2x_2&\cdots&a_{2n}x_2x_n	\\
    \vdots&\vdots&&\vdots\\
    a_{n1}x_nx_1&a_{n2}x_nx_2&\cdots&a_{nn}x_nx_n	\\
\end{pmatrix}_{n\times{n}}
\\其中\odot是hadamard乘积
$$

## 二次型的主要问题

- 二次型的主要问题是化简问题,即:寻找一可逆的线性变换$\bold{x=Cy}$`(1)`,使得二次型$f(\bold{x})$`(2)`仅包含**平方项**
- 即,将`(1)`代入`(2)`,得到简化的形式$f(\bold{y})$=$\sum_{k=1}^{n}k_iy_{i}^{2}$,这种简单的形式成为标准形(法式)

### 线性变换和二次型

- 设可逆矩阵$\bold{C}=(c_{ij})$,对应可逆线性变换$\bold{x=Cy}$`(1)`,代入二次型$f(\bold{x})=\bold{x^{T}Ax}$`(2)`可得$f=\bold{(Cy)^{T}A(Cy)}$=$\bold{y^{T}C^{T}ACy}$=$\bold{y^{T}(C^{T}AC)y}$

- 经过可逆变换$\bold{x=Cy}$后,二次型$f$的矩阵由$\bold{A}$变为$\bold{A}$合同的矩阵$\bold{D=C^{T}AC}$


## 方阵合同

- 设$\bold{A,B,C}\in\mathbb{R}^{n\times{n}}$,如果存在**可逆矩阵**$\bold{C}$,使得$\bold{B={C}^{T}A{C}}$,则称$\bold{A}$和$\bold B$是合同的,记为$\bold{A\simeq{B}}$
  - 形式上类似于方阵相似$\bold{P^{-1}AP=B,A\sim{B}}$
- 经过**可逆变换**,新二次型和原二次型的矩阵是合同的

### 合同的性质

- $\bold{A\simeq{A}}$
- $\bold{A\sim{B}\Rightarrow{B\simeq{A}}}$
- $\bold{A\simeq{B},B\simeq{\bold{C}}\Rightarrow{A\simeq{\bold{C}}}}$


#### 对称阵合同

- 若$\bold{A}$是对称阵,则与$\bold{A}$合同的$\bold{B=C^{T}A{C}}$,则
  - $\bold{B}$也是对称的:$\bold{B}^{T}$=$\bold{C^{T}A^{T}{C}}$,又因为$\bold{A}$对称,即$\bold{A^{T}=A}$,所以$\bold{B^{T}=B}$,从而$\bold{B}$是对称阵
  - $R(\bold{B})=R(\bold{A})$,因为$\bold{C}$是可逆矩阵,$\bold{C^{T}}$也可逆,$\bold{B}$相当于由$\bold{A}$通过初等变换若干次得到的,因此$\bold{A,B}$有相同的秩

#### 合同与相似

- 若$\bold{Q^{T}AQ={B}}$且$\bold{Q}$是**正交矩阵**($\bold{Q^{-1}=Q^{T}}$),此时合同与相似等价:$\bold{A\simeq{B}\Leftrightarrow{A\sim{B}}}$
  - 因为$\bold{Q^{-1}=Q^{T}}$,所以$\bold{Q^{T}AQ={B}}$ $\Leftrightarrow$ $\bold{Q^{-1}AQ={B}}$


#### 推论:实对称阵必定是合同于对角阵的

- 任意**实对称阵**$\bold A$**合同**于对角阵$\bold\Lambda$,
- 符号描述:$\forall \bold{A^{T}=A,A\simeq{\Lambda}}$
  - 因为:$\bold{\forall{A},A^{T}=A}$, $\bold{\exist{Q},Q^{-1}={Q^{T}}}$,s.t.$\bold{Q^{-1}AQ=\Lambda}$,即$\bold{Q^{-1}AQ={B}}$
  - 即$\bold{\forall{A},A^{T}=A\Rightarrow{A\simeq{\Lambda}}}$



### 二次型的矩阵

- 给定一个二次型,可以唯一确定一个**矩阵$\bold{A}$**,且$\bold{A}$是对称阵
- 对于一个对称阵$\bold A$,可以唯一确定一个二次型$\bold{x^{{T}}Ax}$
- 二次型和对称阵可以确立一 一对应的关系
  - 对称阵$A$称为二次型$f$的矩阵
  - $f$称为对称阵$A$的二次型

### 二次型的秩

- 二次型的对称阵$\bold{A}$的秩$R(\bold A)$称为**二次型$f$的秩**$R(f)=R(\bold{A})$
- 及你给过线性变换后,二次型的矩阵变为原二次型矩阵的合同阵,因此**秩**不变

### 利用对称阵研究二次型

- 由于二次型和对称阵关系密切,可以通过研究二次型的对称阵来研究二次型本身

#### 例:计算给定二次型的对称阵

- 参考二次型的以下形式,方便我们从给定的二次型$f$中还原出对称阵A
  $$
  f(x_1,\cdots,x_n)
  =\sum\limits_{i=j=k}^{n}a_{kk}x_k^2
  +2\sum\limits_{1\leqslant {i}< {j}\leqslant{n}}^{}a_{ij}x_ix_j
  $$

  
  
- 例:$f(x_1,x_2,x_3)=x_1^2-3x_3^2-4x_1x_2+2x_2x_3$=$x_1^2+0x^2-3x_3^2$+$2(-2x_1x_2+0x_1x_3+1x_2x_3)$

  - 容易读出$a_{12}=-2;a_{13}=0;a_{23}=1$并且有对称性得到$a_{12}=a_{21}=-2;a_{31}=a_{13}=0;a_{23}=a_{32}=1$
  
  - 事实上,我们不需要关心系数为0的项,只需要将非零的项的系数求出即可,其余的全部用0补满整个对称阵即可
  
  - $$
    \begin{pmatrix}
    1 & -2& 	\\
    -2& &1 	\\
    &1&  -3 	\\
    \end{pmatrix}
    $$

  - 其余非对角线元素默认补零,因此得到对称阵A
    $$
    A=\begin{pmatrix}
    1 & -2&0 	\\
    -2& 0&1 	\\
    0&1&  -3 	\\
    \end{pmatrix}
    $$
  
  - $$
    A\to
    \begin{pmatrix}
    1 & -2&0 	\\
    0&1&-3 	\\
    0&0&-11 	\\
    \end{pmatrix}
    \\
    \therefore r(f)=r(A)=3
    $$
  
  - $$
    f(x_1,x_2,x_3)
    =\bold{x^{T}Ax}
    =(x_1,x_2,x_3)
    \begin{pmatrix}
    1 & -2&0 	\\
    -2& 0&1 	\\
    0&1&  -3 	\\
    \end{pmatrix}
    \begin{pmatrix}
    	x_{1}\\
    	x_{2}\\
    	x_{3}	\\
    \end{pmatrix}
    $$
  
- 根据矩阵$\bold A$写出对应的二次型$f$是类似的过程,依然使用上述的公式

  - 根据矩阵$\bold{A}$的对角线元素确定平方项的系数
  - 根据$\bold{A}$的上三角确定出非平方项的系数
  - $f=x_1^2-3x_3^2$+$2(-2x_1x_2+1x_2x_3)$

