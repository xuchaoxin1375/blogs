[toc]

## abstract

- 命题公式@
  - 主范式的性质和应用
  - @数理逻辑解决数字电路全加器问题

## 主合取范式与主析取范式间的关系👺

- 同一个$n$元命题公式$A$的主合取范式$A_1$与主析取范式$A_2$间的关系:
  - 构造整数集合$S=\{0,\cdots,2^{n}-1\}$,以及主析取式的所有最小项编号构成的集合$m=(i_1,\cdots,i_t)$,其中$t$是主取析范式包含的极小项数目
  - 作整数下标集合$M=S-m$=$\{j_1,\cdots,j_{s}\}$,其中$s=2^{n}-t$,则主合取范式就是$M_{j_1}\wedge{M_{j_2}}\cdots{M_{j_{s}}}$
  - 总之,$A_1,A_2$的下标相对于$S$集合是互补的
- 证明:参考主范式的性质一节(根据主析取范式直接得到主合取范式)



## 主范式存在及唯一性定理

- 任何命题公式都存在与之**等值**的**主析取范式**和**主合取范式**
- 存在性
  - 按照命题公式主范式化一节给出的方法可以将所有析取范式(合取范式)主规范化
  - 又因为任意命题都可以规范化为析取范式和合取范式
  - 所以存在性成立
- 唯一性(以析取范式为例,用反证法证明)
  - 即证明任意公式的主析取范式都式一致的,又即任意两个析取范式包含的最小项一致(最小项编号序列一致)
  - 不妨设$B,C$是$A$的任意两个不同的主析取范式,则$B\Leftrightarrow{C}$
  - 设$m_i$只出现在$B$中而不出现在$C$中;于是$i$对应的二进制串$x_1\cdots{x_n}$是$B$的成真赋值,但不是$C$的成真赋值,与$B\Leftrightarrow{C}$矛盾
  - 所以$B,C$的包含的最小项相同,即$B,C$是同一个主析取范式
  - 所以唯一性成立
- 主合取发生范式的证明类似

#### 例

- $(p\to{q})\to{r}$ $\Leftrightarrow$ $(p\wedge{\neg{q}}\wedge\neg{r})$ $\vee$ ${(\neg{p}\wedge{r}})$ $\vee$ ${(q\wedge{r})}$
  - $(p\wedge{\neg{q}}\wedge\neg{r})$是最小项,其成真赋值二进制串为100,记为$m_{(100)}$十进制下表示为$m_4$
  - ${(\neg{p}\wedge{r}})$ $\Leftrightarrow$ $m_1\vee{m_3}$
  - ${(q\wedge{r})}$ $\Leftrightarrow$ $m_3\vee{m_7}$
  - 所以主析取式为$(p\to{q})\to{r}$ $\Leftrightarrow$  $m_1\vee{m_3}\vee{m_4}\vee{m_7}$
- $p\vee{q}$
  - 容易看出它本身就是一个二元极大项,且是主合取范式,标号为$0$,即$M_{0}$
  - 根据两种主范式关系,其主析取范式为$m_1\vee m_2\vee m_3$
  - 如果要用基础方法计算主析取范式,过程如下
    - $p\vee{q}$ $\Leftrightarrow$ $(p\wedge{(q\vee{\neg{q}})})\vee{((p\vee{\neg{p}})\wedge{q})}$
      - $\Leftrightarrow$ $((p\wedge{q})\vee{(p\wedge{\neg{q})}})$ $\vee$ $((p\wedge{q})\vee{(\neg{p}\wedge{q})})$
      - $\Leftrightarrow$ $(p\wedge{q})\vee{(p\wedge{\neg{q})}}$ $\vee$ ${(\neg{p}\wedge{q})}$
      - $\Leftrightarrow$ $m_3\vee{m_2}\vee{m_1}$
      - $\Leftrightarrow$ $m_1\vee{m_2}\vee{m_3}$

## 主范式的性质👺

### 求公式的成真与成假赋值

- 首先,我们知道给定一个$n$元命题公式$A$,其真值表有$2^{n}$个条目(所有的$n$元命题公式可以产生$2^{2^{n}}$个条目)
- 集合定义:$S=\{1,\cdots,2^{n}-1\}$

- 若公式$A$中含有$n$个命题变项,则$A$的**主析取范式**含有$s(0\leqslant{s}\leqslant{2^{n}})$个**极小项**,且$A$**恰好**有$s$个**成真赋值**,这些成真赋值恰好是所含极小项下标的二进制串表示,其余$2^{n}-s$个赋值都是**成假赋值**
  - 设$A$ $\Leftrightarrow$ $m_{i_1}\vee\cdots\vee m_{i_s}$,$m_{ij}=(q_1)\wedge\cdots\wedge{(q_n)}$,其中$j=1,\cdots,s$,$(q_{r}),r=1,\cdots,n$表示$q_r$或$\neg q_r$
  - $A$为真当且仅当$m_{ij}$中至少有一个真值为真,显然$i_1,\cdots,i_s$分别使得$m_{i_1},\cdots,m_{i_s}$为真,也就能使$A$为真
  - 除此$s$个成真赋值外,所有赋值$j_1,\cdots,j_{t}$($t=2^{n}-s$个)都不能使$m_{i_1},\cdots,m_{i_s}$中地任何一个成真,相应地$A$成假
  - 上述结论表明,我们可以从给定的主析取范式中直接根据各个极小项的下标得出所有的成真赋值($i_1,\cdots,i_s$);然后用集合$S$减去成真赋值下标构成的集合(也就是主析取式中未出现的下标集合),就是所有成假赋值的集合$(j_1,\cdots,j_t),t=2^{n}-s$



#### 主析取范式直接得到主合取范式

1. 类似的分析主合取范式
   - 对于主合取范式,$A$ $\Leftrightarrow$ $M_{j_1}\wedge\cdots\wedge M_{j_w}$,$M_{jk}=(q_1)\vee\cdots\vee{(q_n)}$,其中$(q_{r}),r=1,\cdots,n$表示$q_r$或$\neg q_r$
   - 赋值$j_1,\cdots,j_w$分别使得$M_{j_1},\cdots,M_{jw}$成假,因而它们的合取公式成假,即使得$A$成假
     - 其余赋值使得$M_{j_1},\cdots,M_{jw}$都成真,即使$A$成真
   - 因此,若已知$A$的主析取范式有$s$个极小项$(0<s<2^{n})$,即$A$有$s$个成真赋值,
     - 则$A$有$w=2^{n}-s$个成假赋值,$A$的主合取范式有$w=2^{n}-s$项的极大项
     - 设$w$个极大项的下标分别是$j_1,\cdots,j_w$,它们和极小项下标$i_1,\cdots,i_s$恰好能一一对应$S$中的元素
   - 事实上,$m_{j_1}\cdots{m_{j_w}}$是$\neg{A}$的极小项:$\neg{A}=m_{j_1}\vee\cdots\vee{m_{jw}}$
     - $A$ $\Leftrightarrow$ $\neg{\neg{A}}$ $\Leftrightarrow$ $\neg{(m_{j_1}\vee\cdots\vee{m_{jw}})}$ $\Leftrightarrow$ $\neg m_{j_1}\wedge\cdots\wedge\neg{m_{jw}}$ $\Leftrightarrow$ $M_{j_1}\wedge{\cdots}\wedge{M_{jw}}$
2. 上述分析解释了主合取范式与主析取范式间的关系,并且说明了为什么主析取范式和主合取范式共同反映(容易还原)真值表所能表达的全部信息

### 判断公式的类型

- 主范式能判断公式类型,这也是主范式能体现真值表的表现
- 设$A$中含有$n$个命题变项,则
  - 从极小项的角度
    - $A$为重言式当且仅当$A$的主析取范式包含$2^{n}$个极小项($A$有$2^{n}$个成真赋值)
    - $A$为矛盾是当且仅当$A$的主析取范式不含任何极小项(主合取范式包含$2^{n}$个极大项,$A$有$2^{n}$个成假赋值);此时$A$的主析取范式为0(表示矛盾式)
    - $A$为可满足式当且仅当$A$的主析取范式包含至少一个极小项
  - 从极大项的角度
    - $A$为重言式当且仅当$A$的主合取范式不含极大项(规定此时$A$的主合取范式为1)
    - $A$为矛盾是当且仅当$A$的主合取范式包含$2^{n}$个极大项
    - $A$是可满足式时,$A$至少有一个成真赋值,因此$A$的主合取范式极大项个数少于$2^{n}$

### $n$元命题公式的主析取范式(主合取范式)的个数

- 根据排列组合可知,主析取范式和主合取范式的个数$N_1,N_2$相等,它们都可以从$n$元极小项集合($N=2^{n}$个元素)中抽取$0\sim{2^{n}}$个
- 因此都为$N_1=N_2=\sum_{i=0}^{N}\binom{N}{i}$=$(1+1)^{N}$=$2^{2^n}$,则个数字和所有$n$元命题公式的真值表个数相等

### 判断两个命题公式是否等值

- 设$A,B$共有$n$个命题变项,按$n$个命题变项求出$A,B$的主析取范式$A',B'$,显然$A$ $\Leftrightarrow$ $A'$ ,$B$ $\Leftrightarrow$ $B'$
- 若$A'=B'$,则$A$ $\Leftrightarrow$ $B$,否则$A$ $\not\Leftrightarrow$ $B$

## 给出一个满足给定真值表的命题公式

- 我们以半加器和全加器为例进行讨论相关算法
- 这部分涉及数字逻辑(数字电路逻辑,这门课很多内容是抽象数理逻辑具象化(或说知识应用))
  - 数理逻辑中的真,假分别对应于数字电路逻辑中的二值(1,0)或高,低电平
- 我们的任务使从给定真值表通过一定的方法给出满足真值表的公式

### 半加器

- 例如二进制半加器(不考虑上一位的进位,但是考虑下一位进位;其输入变元$x,y$其输出变元包含半$h$和半进位$d$),我们根据半加器的真值表来求取一个真值表和半加器相同的命题公式

- | x    | y    | 本位和位h | 下一位进位d |
  | ---- | ---- | --------- | ----------- |
  | 0    | 0    | 0         | 0           |
  | 0    | 1    | 1         | 0           |
  | 1    | 0    | 1         | 0           |
  | 1    | 1    | 0         | 1           |

  - 分析此表,其包含了两个公式(输出半和位,半进位)

    - $x,y,h$;$x,y,d$

  - 下面我尝试给出主析取范式$h(x,y)$,$d(x,y)$

    - 根据公式和其主范式的关系,如果要求主析取范式,则我们只需要关注真值表中的成真赋值

    - 若想要求主合取范式

      - 可以仅关注真值表中的成假赋值
      - 也可以先求主析取范式,然后根据主合取范式和主析取范式的关系间接求得

    - | x    | y    | h    |
      | ---- | ---- | ---- |
      | 0    | 0    | 0    |
      | 0    | 1    | 1    |
      | 1    | 0    | 1    |
      | 1    | 1    | 0    |

    - | x    | y    | d    |
      | ---- | ---- | ---- |
      | 0    | 0    | 0    |
      | 0    | 1    | 0    |
      | 1    | 0    | 0    |
      | 1    | 1    | 1    |

  - $h=m_1\vee{m_2}$=$(\neg{x}\wedge{y})\vee(x\wedge{\neg{y}})$,

    - 类似地可以求$h=M_0\wedge{M_3}$=$({x}\vee{y})\wedge{(\neg{x}\vee{\neg{y}})}$

  - $d=m_{3}$=$x\wedge{y}$;

    - 类似地可以求得$d=M_0\wedge{M_1}\wedge{M_2}$=$(x\vee{y})\wedge{({x}\vee{\neg y})}\wedge{(\neg{x}\wedge{y})}$

### 全加器

- 全加器不仅考虑了下一位的进位(carry out,简记为cout,或$c$),同时考虑了上一位的进位

- 为此,输入也要有一个进位(carry in,简记为`cin`,或$c'$)来使上一位进位进入加法运算

- | $1,\cdots,{2^{n}-1}$ | x    | y    | 上一位进位cin(c') | 本位和位s | 下一位进位cout(c) |
  | -------------------- | ---- | ---- | ----------------- | --------- | ----------------- |
  | 0                    | 0    | 0    | 0                 | 0         | 0                 |
  | 1                    | 0    | 0    | 1                 | 1         | 0                 |
  | 2                    | 0    | 1    | 0                 | 1         | 0                 |
  | 3                    | 0    | 1    | 1                 | 0         | 1                 |
  | 4                    | 1    | 0    | 0                 | 1         | 0                 |
  | 5                    | 1    | 0    | 1                 | 0         | 1                 |
  | 6                    | 1    | 1    | 0                 | 0         | 1                 |
  | 7                    | 1    | 1    | 1                 | 1         | 1                 |

- $s$=$(\neg{x}\wedge{\neg y}\wedge{{c'}})$ $\vee$ $(\neg{x}\wedge{y}\wedge{\neg c'})$ $\vee$ $(x\wedge{\neg{y}}\wedge{\neg c'})$ $\vee$ $(x\wedge{y}\wedge{c'})$

  - =$m_1\vee{m_2}\vee{m_4}\vee{m_{7}}$

- $c$=$(\neg{x}\wedge{y}\wedge{{c'}})$ $\vee$ $({x}\wedge{\neg y}\wedge{c'})$ $\vee$ $(x\wedge{{y}}\wedge{\neg c'})$ $\vee$ $(x\wedge{y}\wedge{c'})$

  - =$m_3\vee{m_5}\vee{m_6}\vee{m_7}$

### 半加器和全加器的联系

- 全加器可以由两个半加器和一个或门实现
- 设输入位为$x,y$的半加器的本位和的函数表示$h(x,y)=(\neg{x}\wedge{y})\vee(x\wedge{\neg{y}})$(函数$h$是**异或门**)
  - 半进位$d(x,y)=x\wedge{y}$(即**与门**)
- 则
  - 全加器的本位和$s(x,y,c')$ $\Leftrightarrow$ $(h(x,y)\wedge{\neg{c'}})\vee{(\neg{h(x,y)}\wedge{c'})}$ $\Leftrightarrow$ $h(h(x,y),c')$`(1)`,异或门嵌套
  - 下一位进位$c(x,y,c')$ $\Leftrightarrow$ $(h(x,y)\wedge{c'})\vee{d(x,y)}$ $\Leftrightarrow$ $d(h(x,y),c')\vee{d(x,y)}$`(2)`,其中$c'$是全加器用来接受上一位进位的输入变量
  - 根据`(1)`,容易仅需要两个半加器(分别记为半加器$a_1,a_2$)即可实现$s$的计算
    - $a_1$计算$h(x,y)$,同时提供$d(x,y)$
    - $a_2$计算$h(h(x,y),c')$,同时还提供$d(x,y),d(h(x,y),c')$`(1.1)`
  - 根据`(1.1),(2)`,再加上一个**或门**就可以计算$c$,
- 所以两个半加器和一个或门即可实现全加器
- 至于半加器,可以使用一个异或门和与门实现(其中异或门可以由两个与门,两个非门和一个或门实现)

Note:

- 设半加器本位输出和$h=(\neg{x}\wedge{y})\vee(x\wedge{\neg{y}})$;全加器下一位进位输出$s$:

- $s$ $\Leftrightarrow$ $(\neg{x}\wedge{\neg y}\wedge{{c'}})$ $\vee$ $(\neg{x}\wedge{y}\wedge{\neg c'})$ $\vee$ $(x\wedge{\neg{y}}\wedge{\neg c'})$ $\vee$ $(x\wedge{y}\wedge{c'})$
  - $\Leftrightarrow$ $[((\neg x\wedge{\neg{y}})\vee({x}\wedge{y}))\wedge{c'}]$ $\vee$ $[((\neg{x}\wedge{y})\vee{(x\wedge{\neg y})})\wedge{\neg{c'}}]$
  - 再由分配律和德摩根,可知$w=(\neg x\wedge{\neg{y}})\vee({x}\wedge{y})$和$h=(\neg{x}\wedge{y})\vee{(x\wedge{\neg y})}$是互非的关系:$w=\neg{h}$
  - 从而$s$ $\Leftrightarrow$ $(\neg{h}\wedge{c'})\vee(h\wedge{c'})$

## 主范式合并化简

- 从主范式合并化简为尽可能简单的等价范式是重要问题
- 这个过程和主范式化的是互逆的过程
- 主范式的意义在于能够方便的比较两个公式是否等价以及其他真值表能够完成的任务
- 化简的意义在于,使公式更加简洁,从而在某些应用上更加方便和高效
- 比如涉及一个具有特定真值表的组合逻辑电路,公式越简单,所需要的基本逻辑门也就越少,布线和硬件成本也更低,功耗也更优
- 容易知道,化简得结果可能不唯一,但好的结果使项数尽可能少,每项的变元尽可能少

### 卡诺图法

- 在数字逻辑中,这个任务称为逻辑函数化简
  - 有表格化方法,叫做卡诺图法,其借助格雷码设计而成,通过画卡诺圈来给出化简后的公式
    - 这种方法有比较一般的步骤,但是对于变量数目多的(4个以上),就比较繁琐
  - 也可用公式的运算律(等值式模式)作合并化简工作,这种方式对于基本功要求比较扎实

### 公式法

1. 并项法:$(A\wedge B)\vee(\neg{A}\wedge{B})$ $\Leftrightarrow$ $B$;该公式可以将两个**与项**合并为一个,并且消去其中的一个变量
2. 吸收法:$A\vee (A\wedge B)$ $\Leftrightarrow$ $A$;吸收多余的**与项**
3. 消去法:$A\vee(\neg{A}\wedge{B})$ $\Leftrightarrow$ $A\vee{B}$;消去**与项**多余的**因子**
4. 配项消项法:$(A\wedge{B})\vee(\neg{A}\wedge{C})$ $\Leftrightarrow$ $(A\wedge{B})\vee{(\neg{A}\wedge{C})}\vee{(B\wedge{C})}$配项多出一个**与项**,尝试合并其他与项来消去更多**与项**



### 最简范式

- 最简主析取式(最简与或式):简单合取式个数最少(与项个数最少);简单合取式(与项)中变量个数最少
- 最简主合取式(最简或与式):简单析取式个数最少(或项个数最少);简单析取式(或项)中变量个数最少