[toc]



## å†…å­˜ä¸­çš„æ•°ç»„å…ƒç´ ä½ç½®è®¡ç®—

- è®¾ä¸€ä¸ªæ•°ç»„å…ƒç´ å ç”¨L=3ä¸ªå­˜å‚¨å•å…ƒ
  - $a_1,a_2,a_3;a_4,a_5,a_6$
  - $å…¶ä¸­a_iè¡¨ç¤ºç¬¬iä¸ªå­˜å‚¨å•å…ƒ$
- $é‚£ä¹ˆå…ƒç´ e_0å ç”¨a_1,a_2,a_3;å…ƒç´ e_1å ç”¨a_4,a_5,a_6$
  - $Loc(e_0)=a_1,e_0çš„èµ·å§‹åœ°å€å°±æ˜¯a_1çš„åœ°å€$
  - $Loc(e_1)=a_1+1\times L=a_1+1\times3=a_4$
  - $Loc(e_i)=Loc(e_0)+i\times L=a_1+iL=a_{1+iL}$
  - $Loc(e_j)=Loc(e_i)+(j-i)L$

### é—­åŒºé—´å†…çš„å…ƒç´ æ•°é‡MatchedSize

- $MatchedSize(index_i,index_j)è¡¨ç¤º,åºåˆ—\{a_n\}çš„å…ƒç´ a_iåˆ°å…ƒç´ a_jä¹‹é—´è¿åŒä¸¤ç«¯åŒ…å«äº†å¤šå°‘ä¸ªå…ƒç´ $

- $$
  |\Delta|=increment(index1,index2)=|index2-index1|
  \\
  m(start,end)=MatchedSize(index1,index2)=|\Delta|+1=|index2-index1|+1
  $$

  - æ¨¡å¼ä¸²åŒ¹é…ç®—æ³•(æœ´ç´ åŒ¹é…/kmp)

  - ç‰¹æ®ŠçŸ©é˜µå‹ç¼©/è§£å‹å…¬å¼

    - kå¯¹è§’çŸ©é˜µ,å…¶ç¬¬iè¡Œå½¢å¦‚:

      - $$
        0\cdots0,a_{i,j_1},\cdots,a_{i,j_k},0\cdots 0
        $$

    - é—®,$a_{i,j_k}å‰é¢çš„éé›¶å…ƒç´ æœ‰å‡ ä¸ª$; 

      - ä¸Šé¢çš„é—®é¢˜çœ‹ä¼¼ä¸æ˜¯MatchedSizeçš„åº”ç”¨åœºåˆ,ä½†å…¶å®,ç¨å¾®æƒ³ä¸€ä¸‹,ä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºMatchedSize

      - $$
        0\cdots0,\underbrace{a_{i,j_1},\cdots,a_{i,j_{k-1}}}_{å‡ ä¸ªå…ƒç´ ?},a_{i,j_k},0\cdots 0
        $$

        

      - $m_{(1,k-1)}=j_{k-1}-j_1+1$

      - $ç‰¹åˆ«çš„,ä¸‰å¯¹è§’çŸ©é˜µ(k=3)ä¸­,ç¬¬iè¡Œå…ƒç´ a_{i,j}å‰é¢çš„éé›¶å…ƒç´ æœ‰å‡ ä¸ª?$

        - $j_1=i-1,j_{k-1}=j-1$
        - $elems=m(i-1,j-1)=(j-1)-(i-1)+1=j-i+1$

    - é—®:$\underbrace{a_i\cdots a_{j-1}}_{å­ä¸²é•¿åº¦ä¸ºL}a_{j}$

      - $å…¶ä¸­a_jçš„åºå·ä¸ºy$
      - $é‚£ä¹ˆa_içš„åºå·xä¸ºå¤šå°‘?$
        - $åæ ‡å·®\Delta=j-i=L$
        - $\underbrace{a_ia_{i+1}\cdots a_{j-1}a_{j}}_{å­ä¸²é•¿åº¦ä¸ºL+1}$
          - $L+1=y-x+1å³: x=y-L$
        - $a_i\underbrace{a_{i+1}\cdots a_{j-1}a_{j}}_{å­ä¸²é•¿åº¦ä¸ºL}$
          - $x=y-L$

### ğŸ˜å°ç»“

- ä»ä¸€ç»´åºåˆ—çš„è®¡æ•°å…¬å¼&åæ ‡å…¬å¼çš„å„ç§å½¢å¼ä¸Šçœ‹

- $å…³ç³»å¼|j-i|=|\Delta(L)|è¶³ä»¥è§£å†³æ‰€æœ‰ç›¸å…³é—®é¢˜(ä»¥åæ ‡å·®\Deltaä¸ºæ ¸å¿ƒ)$

  - $$
    \\åæ ‡å·®=å¢é‡é•¿åº¦
    \\
    j-i=\Delta=L_{[a_{i},a_{j-1}]}=L_{[a_{j},a_{i+1}]}\tag{core}\geqslant 0
    \\
    (i-j=-\Delta)
    $$


    $$
    L_{[a_{i},a_{j}]}=|\Delta|+1=|j-i|+1
    $$

- $å°†åæ ‡å·®\Deltaç”¨é—­åŒºé—´è·ç¦»Læˆ–(L\pm 1)è¡¨ç¤ºå‡ºæ¥$

- $Lé€šå¸¸æ˜¯a_i\sim a_jé—­åŒºé—´å†…çš„å…ƒç´ æ•°é‡,è¿™æ—¶å€™\Delta(L)=L-1$

åˆ©ç”¨ä¸Šé¢çš„å…³ç³»å¼åˆ—ç­‰å¼,$æ‰€æœ‰å…³äºi,j,Lçš„å€¼éƒ½å¯ä»¥ä¸€æ­¥è®¡ç®—çš„æ—¶é—´å†…å¾—å‡º$

å…¬å¼ä¸­éƒ½å…·æœ‰åæ ‡å·®(å‡è®¾i<j)

- $é—­åŒºé—´å…ƒç´ æ•°é‡L=\Delta+1=j-i+1$
- $é—­åŒºé—´å·¦ç«¯ç‚¹åæ ‡iå¯ä»¥ç”±:i=j-\Delta=j-L+1;$
- $å³ç«¯ç‚¹åæ ‡j=i+\Delta=i+L-1$