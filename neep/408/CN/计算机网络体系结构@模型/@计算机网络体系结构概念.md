[toc]



# è®¡ç®—æœºç½‘ç»œçš„ç»„æˆ

## ç»„æˆéƒ¨åˆ†è§’åº¦

- ç¡¬ä»¶
  - ä¸»æœº(ç«¯ç³»ç»Ÿ)
  - é€šä¿¡é“¾è·¯(å…‰çº¤/åŒç»çº¿)
  - äº¤æ¢è®¾å¤‡(è·¯ç”±å™¨,äº¤æ¢æœº)
- è½¯ä»¶
  - å®ç°èµ„æºå…±äº«çš„è½¯ä»¶
  - æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨çš„å„ç§å·¥å…·è½¯ä»¶
    - ç½‘ç»œæ“ä½œç³»ç»Ÿ
    - é‚®ä»¶æ”¶å‘ç¨‹åº
    - FTPç¨‹åº
    - èŠå¤©ç¨‹åº
    - ...
- åè®®
  - è®¡ç®—æœºç½‘ç»œçš„æ ¸å¿ƒéƒ¨åˆ†
  - è§„å®šäº†ç½‘ç»œä¼ è¾“æ—¶éµå¾ªçš„è§„èŒƒ

## å·¥ä½œæ–¹å¼è§’åº¦

- è¾¹ç¼˜éƒ¨åˆ†
  - æ‰€æœ‰è¿æ¥åˆ°Internetä¸Š,ä¾›ç”¨æˆ·ç›´æ¥ä½¿ç”¨çš„ä¸»æœºç»„æˆ
    - ç”¨æ¥è¿›è¡Œé€šä¿¡å’Œèµ„æºå…±äº«
- æ ¸å¿ƒéƒ¨åˆ†
  - å¤§é‡çš„ç½‘ç»œå’Œé“¾æ¥è¿™äº›ç½‘ç»œçš„è·¯ç”±å™¨ç»„æˆ

## åŠŸèƒ½ç»„æˆ

- é€šä¿¡å­ç½‘
  - åŒ…æ‹¬
    - å„ç§ä¼ è¾“**ä»‹è´¨**
    - **é€šä¿¡è®¾å¤‡**
    - ç›¸åº”çš„ç½‘ç»œ**åè®®**ç»„æˆ
  - ä½¿å¾—ç½‘ç»œå…·æœ‰
    - æ•°æ®ä¼ è¾“
    - äº¤æ¢
    - æ§åˆ¶
    - å­˜å‚¨çš„èƒ½åŠ›
    - å®ç°è”ç½‘è®¡ç®—æœºä¹‹é—´çš„æ•°æ®é€šä¿¡
- èµ„æºå­ç½‘
  - å®ç°**èµ„æºå…±äº«**çš„**è®¾å¤‡åŠå…¶è½¯ä»¶**çš„é›†åˆ
    - å‘ç½‘ç»œç”¨æˆ·æä¾›å…¶ä»–è®¡ç®—æœºä¸Šçš„
      - ç¡¬ä»¶èµ„æº
      - è½¯ä»¶èµ„æº
      - æ•°æ®èµ„æº

#  è®¡ç®—æœºç½‘ç»œæ•°æ®å•å…ƒåŸºæœ¬è”ç³»

## åŸºæœ¬æ¦‚å¿µ

### å®ä½“

- ä»»ä½•å¯ä»¥**å‘é€æˆ–æ¥å—ä¿¡æ¯çš„**
  - ç¡¬ä»¶
  - è½¯ä»¶è¿›ç¨‹
  - é€šå¸¸æ˜¯ä¸€ä¸ªè½¯ä»¶æ¨¡å—

### å¯¹ç­‰å±‚

- ä¸åŒ**æœºå™¨**ä¸Šçš„åŒä¸€å±‚ç§°ä¸ºå¯¹ç­‰å±‚

### å¯¹ç­‰å®ä½“

- åŒä¸€å±‚çš„ä¸åŒå®ä½“ç§°ä¸ºå¯¹ç­‰å®ä½“

- ç¬¬nå±‚(ä¸‹å±‚)å®ä½“å®ç°çš„æœåŠ¡ä¸ºç¬¬n+1å±‚(ä¸Šå±‚)æä¾›æœåŠ¡

## åè®®@æ¥å£@æœåŠ¡

- ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/830c8c2ece0e46d4854df304a1f2c95b.png)

### åè®®

- è§„åˆ™çš„é›†åˆ
  - å…·æœ‰çº¿è·¯ç®¡ç†
  - å·®é”™æ§åˆ¶
  - æ•°æ®è½¬æ¢ç­‰åŠŸèƒ½
- ç”±3éƒ¨åˆ†ç»„æˆ
  - è¯­æ³•
    - è§„å®šä¼ è¾“æ ¼å¼
  - è¯­ä¹‰
    - å®šä¹‰åŠŸèƒ½
      - æ§åˆ¶ä¿¡æ¯
      - åŠ¨ä½œ
      - åº”ç­”
  - åŒæ­¥
    - äº‹ä»¶æ‰§è¡Œé¡ºåºçš„è¯¦ç»†è¯´æ˜
    - è§„å®šæ‰§è¡ŒåŠ¨ä½œçš„æ¡ä»¶å’Œæ—¶åº

### æ¥å£

- ç›¸é‚»å±‚é—´æ¥å£
  - ç³»ç»Ÿå±‚æ¬¡çš„ä¸Šä¸‹å±‚ä¹‹é—´è¿›è¡Œé€šä¿¡çš„æ¥å£
  - æœ¬å±‚(ç¬¬Nå±‚)çš„SAPæ˜¯å…¶ä¸Šå±‚(ç¬¬N+1å±‚)å¯ä»¥è®¿é—®æœ¬å±‚(ç¬¬Nå±‚)(æä¾›çš„)æœåŠ¡çš„åœ°æ–¹

- åŒä¸€ç»“ç‚¹å†…,ç›¸é‚»ä¸¤å±‚é—´äº¤æ¢ä¿¡æ¯çš„è¿æ¥ç‚¹
- æ¯å±‚åªèƒ½ä¸ºç´§é‚»çš„å±‚æ¬¡ä¹‹é—´å®šä¹‰æ¥å£,ä¸èƒ½è·¨å±‚å®šä¹‰æ¥å£
- åŒä¸€ç»“ç‚¹ç›¸é‚»å±‚çš„å®ä½“é€šè¿‡SAP(service access point)è¿›è¡Œäº¤äº’
  - SAP,not SPA

- æœåŠ¡æ˜¯é€šè¿‡SAPæä¾›ç»™ä¸Šå±‚ä½¿ç”¨çš„

#### æœåŠ¡è®¿é—®ç‚¹SAP



- | åˆ†å±‚       | SAP(å‘ç›¸é‚»ä¸Šå±‚æä¾›çš„æœåŠ¡è®¿é—®ç‚¹) |
  | ---------- | ------------------------------- |
  | åº”ç”¨å±‚     | ç”¨æˆ·ç•Œé¢                        |
  | ä¼ è¾“å±‚     | ç«¯å£å·                          |
  | ç½‘ç»œå±‚     | IPåœ°å€                          |
  | æ•°æ®é“¾è·¯å±‚ | ç½‘å¡åœ°å€                        |
  | ç‰©ç†å±‚     | ç½‘å¡æ¥å£                        |

  - ä¾‹å¦‚:
    - ç”¨æˆ·é€šè¿‡**åº”ç”¨å±‚çš„SAP:ç”¨æˆ·ç•Œé¢**ä½¿ç”¨åº”ç”¨å±‚çš„æœåŠ¡
    - åº”ç”¨å±‚ä½¿ç”¨ä¼ è¾“å±‚çš„SAP:ç«¯å£å·,æ¥ä½¿ç”¨ä¼ è¾“å±‚æä¾›çš„æœåŠ¡
    - ...
    - æ•°æ®é“¾è·¯å±‚é€šè¿‡ä½¿ç”¨ç‰©ç†çš„SAP:ç½‘å¡æ¥å£,æ¥è°ƒç”¨ç‰©ç†å±‚çš„æœåŠ¡

### æœåŠ¡

- ä¸‹å±‚ä¸ºç´§é‚»çš„ä¸Šå±‚æä¾›åŠŸèƒ½è°ƒç”¨(å‚ç›´)

#### æœåŠ¡åŸè¯­

- æœåŠ¡åŸè¯­MAP(Service Primitive; primitives; MAP)
  - è¯·æ±‚(Request)
  - æŒ‡ç¤º(Indication)
  - å“åº”(Response)
  - è¯å®(Confirmation)
- å¯¹äº**æœ‰åº”ç­”æœåŠ¡**,åŒ…æ‹¬å…¨éƒ¨4ç±»åŸè¯­
- æ— åº”ç­”é‚£æœåŠ¡,åªæœ‰**è¯·æ±‚å’ŒæŒ‡ç¤º**ä¸¤ç±»åŸè¯­
  - å“åº”å’Œè¯å®éƒ½æ˜¯åº”ç­”æœåŠ¡çš„èŒƒç•´



## æŠ¥æ–‡(åè®®æ•°æ®å•å…ƒPDU)ğŸˆ

- ä½“ç³»ç»“æ„çš„å„å±‚çš„æŠ¥æ–‡(PDU)éƒ½åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†
  - æ•°æ®éƒ¨åˆ†SDU
  - æ§åˆ¶ä¿¡æ¯éƒ¨åˆ†PCI

### SDU

- æœåŠ¡æ•°æ®å•å…ƒSDU([Service data unit](https://en.wikipedia.org/wiki/Service_data_unit):)ä¸ºå®Œæˆç”¨æˆ·è¦æ±‚çš„åŠŸèƒ½è€Œä¼ é€çš„æ•°æ®,å¯ä»¥å…·ä½“åœ°æŠŠç¬¬nå±‚çš„SDUè®°ä¸º:$n-SDU$

### PCI

- åè®®æ§åˆ¶ä¿¡æ¯:æ§åˆ¶åè®®æ“ä½œçš„ä¿¡æ¯,å¯ä»¥å…·ä½“åœ°æŠŠç¬¬nå±‚çš„PCIè®°ä¸º:$n-PCI$

### PDU

- å¯¹ç­‰å±‚ä¹‹é—´ä¼ é€çš„æ•°æ®å•ä½,ç§°ä¸ºè¯¥å±‚çš„PDU([Protocol data unit  ](https://en.wikipedia.org/wiki/Protocol_data_unit)),å…·ä½“æŠŠç¬¬nå±‚çš„PDUè®°ä¸º:$n-PDU$
- ä¸ºäº†ä¹¦å†™ç»“æ„æ¸…æ™°,å°†ä¸åŒå±‚çš„PDUç”¨å‰ç¼€`LayerName@`è¡¨ç¤º
  - ä¾‹å¦‚:`ç‰©ç†å±‚@PDU`è¡¨ç¤ºç‰©ç†å±‚çš„æœåŠ¡æ•°æ®å•å…ƒ
- æ¯å±‚çš„åè®®æ•°æ®å•å…ƒéƒ½æœ‰é€šä¿—çš„åç§°:
  - ä¼ è¾“å±‚@PDUç§°ä¸º**æŠ¥æ–‡æ®µ**
    - å¯¹äºTCP/IPæ¨¡å‹è€Œè¨€
      - é‡‡ç”¨TCPåè®®æ—¶PDUç§°ä¸º**æ®µ**(segment)
      - é‡‡ç”¨UDPåè®®æ—¶PDUç§°ä¸º**æŠ¥æ–‡**(datagram)
  - ç½‘ç»œå±‚@PDUç§°ä¸º**åˆ†ç»„/åŒ…**(packet)
    - å¯¹äºTCP/IPæ¨¡å‹ä¸­ç½‘é™…å±‚ä½¿ç”¨çš„IPåè®®,å…¶åè®®æ•°æ®å•å…ƒPDUå¯ä»¥ç§°ä¸ºIP Datagram(IPæ•°æ®æŠ¥)
      - å’Œä¼ è¾“å±‚UDPåè®®çš„datagramä¸ä¸€æ ·
    - packet:**ç½‘ç»œ**é‡Šä¹‰:
      - å°åŒ…ï¼›åˆ†ç»„ï¼›å°åŒ…
  - ç‰©ç†å±‚@PDUç§°ä¸º**æ¯”ç‰¹(bit)**
  - æ•°æ®é“¾è·¯å±‚@PDUç§°ä¸º**å¸§**

#### OSI model PDU

Protocol data units of the [OSI model](https://en.wikipedia.org/wiki/OSI_model) are:[[1\]](https://en.wikipedia.org/wiki/Protocol_data_unit#cite_note-1)

- The Layer 4: [transport layer](https://en.wikipedia.org/wiki/Transport_layer) PDU is the [segment](https://en.wikipedia.org/wiki/Packet_segment) or the **datagram**.(æ®µ/æŠ¥æ–‡,ç»Ÿç§°**æŠ¥æ–‡æ®µ**)
- The Layer 3: [network layer](https://en.wikipedia.org/wiki/Network_layer) PDU is the [packet](https://en.wikipedia.org/wiki/Network_packet).(åˆ†ç»„(åŒ…))
- The Layer 2: [data link layer](https://en.wikipedia.org/wiki/Data_link_layer) PDU is the [frame](https://en.wikipedia.org/wiki/Frame_(networking)).(å¸§)
- The Layer 1: [physical layer](https://en.wikipedia.org/wiki/Physical_layer) PDU is the [bit](https://en.wikipedia.org/wiki/Bit) or, more generally, [symbol](https://en.wikipedia.org/wiki/Symbol_(data)).(æ¯”ç‰¹)

- Given a context pertaining to a specific OSI layer, *PDU* is sometimes used as a synonym for its representation at that layer.

![image-20220527233403145](https://img-blog.csdnimg.cn/img_convert/fced57cd1ca6fbd305183edf91e9d4c0.png)

#### Internet protocol suite PDU

Protocol data units for the [Internet protocol suite](https://en.wikipedia.org/wiki/Internet_protocol_suite) are:

- The [transport layer](https://en.wikipedia.org/wiki/Transport_layer) PDU is
  -  the [TCP segment](https://en.wikipedia.org/wiki/TCP_segment) for **TCP** ,
  -  the **datagram** for **UDP**
- The [Internet layer](https://en.wikipedia.org/wiki/Internet_layer) PDU is the [packet](https://en.wikipedia.org/wiki/Network_packet).
- The [link layer](https://en.wikipedia.org/wiki/Link_layer) PDU is the [frame](https://en.wikipedia.org/wiki/Frame_(networking)).

- On TCP/IP over Ethernet, the data on the physical layer is carried in [Ethernet frames](https://en.wikipedia.org/wiki/Ethernet_frame).

#### å…³ç³»ğŸˆ

- $SDU+PCI=PDU$
  - ä¸ºäº†ä¹¦å†™ç»“æ„æ¸…æ™°,å°†ä¸Šè¿°çš„`n-`å‰ç¼€ç”¨`n@`è¡¨ç¤º
    - $n@SDU+n@PCI=n@PDU$
    - å¦å¤–,ç”±å±‚é—´å…³ç³»,å¯ä»¥çŸ¥é“
      - $n@PDU=(n-1)@SDU$
        - ä¹Ÿå°±æ˜¯è¯´,ä¸Šä¸€å±‚(n)çš„PDUä¼ ç»™ä¸‹ä¸€å±‚(n-1)ä½œä¸ºæœåŠ¡æ•°æ®å•å…ƒè¿›è¡Œæ‰“åŒ…
        - ç›¸é‚»å±‚é—´çš„PDUå’ŒSDUçš„é€’æ¨å…³ç³»

 

### review

#### ä¼ è¾“å±‚@ç½‘ç»œå±‚

- **Segment**
  - A segment is the unit of end-to-end transmission in the  **TCP protocol**. 
  - A segment consists of a TCP header followed  by application data.
  -  A segment is transmitted by  encapsulation inside an **IP datagram**.

- **IP Datagram**
  - å’Œä¼ è¾“å±‚çš„UDPåè®®çš„æŠ¥æ–‡(Datagram)æœ‰æ‰€ä¸åŒ
  - IPåè®®æ˜¯ç½‘ç»œå±‚(ç½‘é™…å±‚)çš„,è€Œä¸”æ˜¯ä¸“é—¨æŒ‡çš„TCP/IP4å±‚æ¨¡å‹
  - An IP datagram is **the unit** of end-to-end transmission in  the **IP protocol**.
  -  An IP datagram consists of an IP header  followed by transport layer data, i.e., of an IP header  followed by a message.
  - In the description of the internet layer  , the  unqualified term "datagram" should be understood to refer  to an IP datagram.

#### ç½‘ç»œå±‚@æ•°æ®é“¾è·¯å±‚

- **Packet**
  - A packet is the unit of data passed across the **interface**  between **the internet layer** and **the link layer**.
  -  It  includes an IP header and data.
  -  A packet may be `a  complete IP datagram` or `a fragment of an IP datagram`.

#### æ•°æ®é“¾è·¯å±‚@ç‰©ç†å±‚

- **Frame**
  - A frame is the unit of transmission in a link layer  protocol, and consists of a link-layer header followed by
    a packet.

## ç”¨æˆ·æ•°æ®åœ¨å„å±‚çš„å°è£…

- 4æ¬¡å¤´éƒ¨å°è£…

- æ€»çš„æ¥è¯´,æ•°æ®å¾€è¶Šåº•å±‚èµ°,éœ€è¦å°è£…çš„å†…å®¹å°±è¶Šå¤š(å¤„ç†çš„å·¥åºè¶Šå¤š)

- åº”ç”¨ç¨‹åºæ·»åŠ çš„å¤´éƒ¨
- TCPå¤´éƒ¨(ä¼ è¾“å±‚å¤´éƒ¨)
- IPå¤´éƒ¨(ç½‘ç»œå±‚å¤´éƒ¨)
- Ethernetå¤´éƒ¨å’Œå°¾éƒ¨(å°è£…æˆå¸§)
	- å¦‚æœæ•°æ®é“¾è·¯å±‚å±€åŸŸç½‘é‡‡ç”¨ä»¥å¤ªç½‘æŠ€æœ¯,é‚£ä¹ˆIPåˆ†ç»„çš„å¤§å°ä¸è¶…è¿‡1500Byte(ä¸è¶³46Bytesæ—¶,éœ€è¦æ•°æ®é“¾è·¯å±‚åšå¡«å……å¤„ç†)
	- å¦‚æœæ•°æ®é“¾è·¯å±‚é‡‡ç”¨çš„ä¸æ˜¯Ethernet,é‚£ä¹ˆå¯¹IPåˆ†ç»„çš„å¤§å°æœ‰å…¶ä»–è¦æ±‚
	- EtherNet å’Œå„å±‚æ•°æ®æŠ¥ä¹‹é—´çš„å¤§è‡´å…³ç³»:
		-  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/2bb05d30664140e294cf7251877c25b4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAeHVjaGFveGluMTM3NQ==,size_20,color_FFFFFF,t_70,g_se,x_16)







