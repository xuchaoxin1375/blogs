[toc]

- 数字信号处理（DSP）是面向电子信息学科的专业基础知识，也是多门新兴学科的理论基础。作为广泛应用的脚本语言，Python在
  DSP领域中也很常用。

## 声音和信号

- 信号代表随着时间变化的量。这个定义是非常抽象的，所以我们从具象的例子:声音。
- 声音源自于空气压力的改变。
- 声音信号代表的是空气压力随着时间的变化。
- 传声器是测量上述变化并产生表示所测声音的电信号的设备。扬声器是通过输入的电信号产生声音的设备。传声器和扬声器都被称为**换能器** （transducer），因为它们将信号从一种形式转化成另一种形式，也就是变换了**能量的形式**。
- 这里着重于声音信号，但是其方法也同样适用于电信号、机械振动和其他各个领域的信号。
- 这套方法也同样适用于<u>随空间而不是时间变化的信号</u>，比如远足路线上的海拔变化。
- 还适用于不止一个维度的信号，比如图像,可以将它想象为在二维空间中变化的信号。又或者电影，它是二维空间中随着时间变化的信号。

## 周期信号

- 先从周期信号开始，周期信号是在一段时间之后重复出现的信号。

- 比如，你在敲钟时候，钟会振动从而产生声音。把这段声音录制下来，然后绘制出转换后的信号,
- 这个信号和三角函数相似，也就是说其形状和正弦三角函数的形状一样.
- 音叉产生的是正弦信号，因为线形的变化是一种简单的谐波运动形式。大部分乐器产生的是周期信号，但是这些信号的形状不是正弦
  式的。例如
  - ![在这里插入图片描述](https://img-blog.csdnimg.cn/5d1e388d94d94a2cae90657e9422749e.png)
  - 该信号是周期性的，但是信号的形状更加复杂。
  - **周期信号**的**形状**被称为**波形**。
  - 大部分乐器产生的波形比正弦信号的复杂。
  - 波形的形状决定了音乐的**音色**，也就是我们对**声音品性**的感受。
  - 对于比正弦信号更复杂的复杂波形，<u>人们主观上认为它更加富有内涵、更温暖而有趣</u>。

## 　频谱分析

- 任何信号都可以表示成一系列不同频率的正弦信号的叠加和。

- 最重要的数学概念之一是**离散傅里叶变换**（Discrete Fourier Transform, DFT）, DFT也就是将**信号**转换成**频谱**。

- **频谱**是指相加产生信号的**正弦波的集合**。

  - 频谱是指一个时域的信号在频域下的表示方式，可以针对信号进行傅里叶变换而得，所得的结果会是分别以幅度及相位为纵轴，频率为横轴的**两张图**，不过有时也会省略相位的信息

  - 有时也以“**幅度频谱**”表示**幅度**随频率变化的情形，“**相位频谱**”表示**相位**随频率变化的情形

  - 简单来说，频谱可以表示一个信号是<u>由哪些频率的弦波所组成</u>，也可以看出各频率弦波的大小及相位等信息。

  - 音源也可以由许多**不同频率**的声音组成。不同频率会刺激耳朵中对应的接收器。

  - 若主要的刺激只有一个频率，我们就可以听到其[音高](https://zh.wikipedia.org/wiki/音高)，音源的[音色](https://zh.wikipedia.org/wiki/音色)会由声音频号的频谱中，其他频率的部分来决定，也就是所谓[泛音](https://zh.wikipedia.org/wiki/泛音)。

- 幅度频谱

  - 是指一个信号在不同频率上的振幅分布情况，通常以图形的形式表示。在数字信号处理中，可以通过对信号进行傅里叶变换来获得幅度频谱。
  - 傅里叶变换将一个信号分解为不同频率的正弦和余弦信号，从而可以清楚地看到信号在不同频率上的能量分布情况。在幅度频谱图中，横轴表示频率，纵轴表示幅度，通常使用对数尺度来表示幅度，以便更好地显示信号在不同频率上的细节。
  - 幅度频谱广泛应用于信号分析、滤波、调制等领域。

- 相位频谱

  - 是指一个信号在不同频率上的相位分布情况，通常以图形的形式表示。在数字信号处理中，可以通过对信号进行傅里叶变换来获得相位频谱。
  - 傅里叶变换将一个信号分解为不同频率的正弦和余弦信号，从而可以清楚地看到信号在不同频率上的相位分布情况。在相位频谱图中，横轴表示频率，纵轴表示相位，通常使用弧度制来表示相位。
  - 相位频谱也是信号分析、滤波、调制等领域中重要的工具之一，尤其在音频处理和图像处理中，相位频谱具有重要的作用。

- 相关算法,比如**快速傅里叶变换**（Fast Fourier Transform, FFT）, 它是计算离散傅里叶变换的一种**高效方式**。

- 例如,小提琴录音的频谱

  - ![在这里插入图片描述](https://img-blog.csdnimg.cn/b9c3972f66a24e1ebd52bd823517a4e6.png)

  - x 轴表示的是合成这个信号的**频率范围**，y 轴表示各个**频率元素的强度**，或者说是**振幅**。

  - 其中**频率最低的元素**被称为**基频**。

  - 上图所示信号的**基频**在440 Hz左右（实际上要低一点，或者说“降调”）。

  - 此信号中，基频具有最高的幅度，所以它也是主频。

  - 通常情况下，感知到的声音的**音高**是由其基频决定的，<u>即使它不是主频</u>。

    - 频谱中的其他峰值的频率还有880、1 320、1 760和2 200，它们是**基频的整数倍**。

      - ```powershell
        PS C:\Users\cxxu\Desktop> 1..5|% {echo 440*$_=$(440*$_)}
        440*1=440
        440*2=880
        440*3=1320
        440*4=1760
        440*5=2200
        ```

    - 这些**频率元素**被称为**谐波**，因为它们在乐理概念上跟基频**和谐**：

  - 880 Hz是A5的频率，比基频高出一个八度。一个八度意味着频率的两倍；

- 在给定**谐波**和其各自的振幅之后，可以通过**加和正弦波**来重建信号了。

## 语音信号特征分析

- 语音信号处理虽然包括语音通信、语音合成、语音识别等，但其前提是对语音信号的分析。
- 只有将语音信号分析表示成其本质特性的参数，才有可能利用这些参数进行高效的语音通信，才能建立用于语音合成的语音库，也才可能建立用于识别的模板或知识库。
- 而且，语音合成的音质好坏、语音识别率的高低，都取决于对语音信号分析的准确性和精度。例如，利用线性预测分析来进行语音合成，其先决条件是要先用线性预测方法分析语音库，如果线性预测分析获得的语音参数较好，则用此参数合成的语音音质就好。
- 又如，利用带通滤波器组法来进行语音识别，其先决条件是要弄清楚语音共振峰的幅值、个数、频率变化范围及其分布情况。
- 因此，应先对语音信号进行**特征分析**，得到提高语音识别率的有用数据，并据此来设计语音识别系统的硬件和软件。
- 国内外的经验说明，语音分析的工作必须先于其他的语音信号处理工作。
- 例如，20世纪40年代，贝尔实验室的研究人员就对语音信号分析做了大量的、卓有成效的工作，这些成果推动了语音信号处理的发展。
- 根据所分析的**参数**不同，语音信号分析可分为<u>时域、频域、倒谱域</u>等方法。
- 进行语音信号分析时，最先接触到的、最直观的是它的时域波形。
  - 语音信号本身就是时域信号，因而时域分析是最早使用且应用范围最广的一种方法。
  - 时域分析具有简单直观、清晰易懂、运算量小、物理意义明确等优点，但<u>更为有效的分析多是围绕频域</u>进行的，因为语音中最重要的感知特性反映在其**功率谱**中，而相位变化只起着很小的作用。
  - 常用的频域分析方法有**带通滤波器组方法**、**傅里叶变换法**和**线性预测分析法**等
- **频谱**分析具有如下**优点**：
  - 时域波形较易随外界环境变化，但语音信号的频谱对外界环境变化具有一定的**顽健性**。
  - 另外，语音信号的**频谱**具有非常明显的**声学特性**，利用频域分析获得的**语音特征**具有实际的**物理意义**，如共振峰参数、基音周期参数等。
- **倒谱域**是将对数功率谱进行**反傅里叶变换**后得到的，它可以将**声道特性**和**激励特性**有效地分开，因此可以更好地揭示语音信号的本质特征。
  - 按照语音学的观点，可将语音信号分析分为模型分析法和非模型分析法两种。
  - 模型分析法是指依据语音信号产生的数学模型，来分析和提取表征这些模型的特征参数；
    - 共振峰模型分析及线性预测分析即属于这种方法。

  - 凡不进行模型化分析的其他方法都属于非模型分析法，包括上面提到的<u>时域分析法、频域分析法及同态分析法</u>等。
  - 贯穿于语音信号分析全过程的是“**短时分析技术**”。根据对语音信号的研究，其特性是随时间而变化的，所以它是一个非稳态过程。
  - 但从另一方面看，虽然语音信号具有时变特性，但不同的语音是由人的口腔肌肉运动构成声道的某种形状而产生的响应，而这种肌肉运动频率相对于语音频率来说是**缓慢**的，因而在一个短时间范围内，其特性基本保持不变，即相对稳定，所以可以将其看作是一个准稳态过程。
  - 基于这样的考虑，对语音信号的分析和处理必须建立在“短时”的基础上，即进行“短时分析”。
  - 将语音信号分为一段一段来分析，其中每一段称为一“**帧**”（frame）。
  - 由于语音信号通常在10~30ms之内是保持相对平稳的，因而帧长一般取10~30ms。


## 语音信号的采样和量化

- 语音信号是时间和幅度都连续变化的一维模拟信号，要想在计算机中对它进行处理，就要先进行采样和量化，将它变成时间和幅度都离散的数字信号。
- 在语音信号处理中，需要将**信号**表示成**可以处理的函数的形式**。
- 对于模拟信号$x_a(t)$，它表示函数值随着连续时间变量t 的变化趋势。
- 如果以一定的时间间隔T 对这样的连续信号**取值**，则连续信号$x_a(t)$即变成离散信号$x(n)=x_a(nT)$，这个过程称为**采样**，其中两个取样点之间的间隔T称为采样周期，它的倒数$F_s$ 称为**采样频率**。
- 根据采样定理，当采样频率**大于**信号**最高频率**的**两倍**时，在采样过程中就**不会丢失信息**，并且可以用采样后的信号重构原始信号。
  - 实际的信号常有一些低能量的频谱分量<u>超过采样频率的一半</u>，如浊音的频谱超过4kHz的分量比其峰值至少要低40dB；
  - 而对于清音，即使超过8kHz，频率分量也没有显著下降，因此语音信号所占的频率范围可以达到10kHz以上。
  - 虽然这样，但对语音清晰度有明显影响部分的最高频率为5.7kHz左右。
  - CCITT（国际电报电话咨询委员会）提出的G.711标准建议采样频率为8kHz，但一般情况下这只适合电话语音的情况，因为电话语音的频率为60~3400Hz。
  - 在实际的语音信号处理中，采样频率一般为8~10kHz。有一些系统为了实现更高质量的语音合成，或者使语音识别系统得到更高的识别率，将<u>可处理的语音信号</u>扩展到7~9kHz，这时的<u>采样频率一般为15~20kHz</u>。
  - 将8kHz采样率时的系统作为基线系统，当采样率为11kHz时，系统的误识率有10%的降低；
  - 继续升高采样率到16kHz时，系统的误识率与11kHz相比有10%的降低；
  - 当采样率继续增加时，误识率几乎没有降低。<u>因此在一般的识别系统中，采样率最高选择在16kHz。</u>

### 量化

- 采样后的信号在时间域上是离散的形式，但在幅度上还保持着**连续**的特点，所以要进行量化。
- 量化的目的是<u>将信号波形的幅度值**离散化**</u>。
- 一个**量化器**就是将整个信号的**幅度值**分成若干个**有限的区间**，并且把<u>落入同一个区间的样本点</u>都用<u>同一个幅度值</u>表示，这个幅度值称为**量化值**。

### 量化方式

- 量化方式有3种：零记忆量化、分组量化和序列量化。

- 零记忆量化是每次量化一个模拟采样值，并对所有采样点都<u>使用相同的量化器特性</u>。

- 分组量化是从可能输出组的离散集合中，选出一组输出值，代表<u>一组输入</u>的模拟采样值。

- 序列量化是在分组或非分组的基础上，用一些<u>邻近采样点的信息</u>对采样序列进行量化。

- 零记忆量化是最简单的一种，它的输入-输出特性采用**阶梯形函数的形式**。

- 中点上升量化器的输出没有零电平，在零附近有两个输入区间；正区间产生正输出电平，负区间产生负输出电平。

- 中点水平量化器有零电平输出，它对应于零输入区间。

- 量化范围和电平可以用不同方法选取，但通常都是均匀分布的。

- 一般量化值都用二进制来表示，如果用B 个二进制数表示量化值，即**量化字长**，那么一般将幅度值划分为$2^B$ 个等分区间。

- 从量化的过程可以看出，信号在经过量化后，一定存在一个**量化误差**。其定义为

  - $$
    e(n)=\hat{x}(n)-x(n)
    $$

    - $e(n)$为量化误差或噪声
    - $\hat{x}(x)$为量化后的采样值(量化器的输出)
    - $x(n)$为未量化的采样值(量化器的输入)

## 短时加窗

- 短时加窗处理经过数字化的语音信号实际上是一个**时变信号**，这是由于人在发音时声道一直处于变化状态，因此实际上的语音信号产生系统可以近似看作线性时变系统。
- 为了能用传统的方法对语音信号进行分析，假设语音信号在10~30ms短时间内是平稳的。后面的所有分析都是在语音信号短时平稳这个假设条件下进行的。
- 为了得到短时的语音信号，要对语音信号进行**加窗操作**。
  - 窗函数平滑地在语音信号上滑动，将语音信号分成帧。
  - 分帧可以连续，也可以采用交叠分段的方法，交叠部分称为帧移，一般为窗长的一半。
  - 在加窗的时候，不同的窗口选择将影响到语音信号分析的结果。
  - 在选择窗函数时，一般有两个问题要考虑。

### 窗函数形式

- 矩形窗
- 汉明窗
- 汉宁窗

### 窗函数长度

- 不论什么样的窗口，**窗的长度**对能否反映语音信号的**幅度**变化起**决定性作用**。
- 如果N 特别大，即等于几个基音周期量级，则窗函数等效于<u>很窄的低通滤波器</u>，此时信号短时信息将缓慢地变化，因而也就不能充分地反映波形变化的细节；
- 反之，如果N 特别小，即等于或小于一个基音周期的量级，则信号的能量将按照信号波形的细微状况而**很快地起伏**。
- 但如果N 太小，滤波器的**通带变宽**，则<u>不能得到较为平滑的短时信息</u>，因此窗口的长度要选择合适。
- **窗的衰减**基本上与窗的<u>持续时间无关</u>，因此当改变宽度N 时，只会使带宽发生变化。
- 前面的窗口长度是相对于语音信号的基音周期而言的。通常认为一个语音帧内，应含有1~7个基音周期。
- 然而不同人的基音周期变化范围很大，基音周期的持续时间会从高音调（女性或儿童）的约20个采样点（采样频率为10kHz）变化到很低音调（男性）的250个采样点，这意味着在进行分析时可能需要多个不同的N 值，所以N 的选择比较困难。
- 通常在采样频率为10kHz 的情况，N 选择在100~200 量级（10~20ms持续时间）是合适的。



## 语音信号的时域分析

- 对信号分析最自然、最直接的方法是以时间为自变量进行分析，语音信号典型的时域特征包括短时能量、短时平均过零率、短时自相关系数和短时平均幅度差等。
- 典型的语音信号特性是随着时间变化而变化的。
  - 例如，浊音和清音之间激励的改变，会使信号峰值幅度有很大的变化；
  - 在浊音范围内基频有相当大的变化。在一个语音信号的波形图中，这些变化十分明显，所以要求能用简单的时域处理技术对这样的信号特征给以有效的描述。

#### 短时能量分析

- 语音信号的能量随着时间变化比较明显，一般清音部分的能量比浊音的能量小得多。
- 语音信号的短时能量分析给出了反映这些幅度变化的一个合适的描述方法。

### 短时平均过零率

- 短时平均过零率是语音信号时域分析中<u>最简单的一种特征</u>。
- 顾名思义，它是指<u>每帧内信号通过零值的次数</u>。
- 对于连续语音信号，可以考察其<u>时域波形通过时间轴的情况</u>。
- 对于离散信号，实质上就是信号采样点<u>符号变化的次数</u>。
- 如果是正弦信号，它的平均过零率就是信号的频率除以两倍的采样频率，而采样频率是固定的，因此过零率在一定程度上可以反映出频率的信息。
- 语音信号不是简单的正弦序列，所以平均过零率的表示方法就不那么确切。
- 然而短时平均过零率仍然可以在一定程度上反映其频谱性质，可以通过短时平均过零率获得谱特性的一种粗略估计。

## 语音信号的频域分析

- 语音的感知过程与人类听觉系统具有频谱分析功能是紧密相关的。
- 因此，对语音信号进行频谱分析，是认识语音信号和处理语音信号的重要方法。
- 所采用的分析方法有很多，下面介绍滤波器组分析方法和傅里叶分析方法。

### 滤波器组方法

- 利用一组滤波器来分析语音信号的频谱，是最早采用的频谱分析方法之一。
- 这种方法使用简单、实时性好、受外界环境的影响小，所以至今这一方法仍是频谱分析的常用方法。
- 滤波器组法所用的滤波器可以是模拟滤波器，也可以是数字滤波器。
- 滤波器可以用宽带带通滤波器，也可以用窄带带通滤波器。
- 宽带带通滤波器具有平坦特性，用它可以粗略地求取语音的频谱，其频率分辨率降低，相当于短时处理时窗宽窄的那种情况。
- 使用窄带带通滤波器，其频率分辨率提高，相当于短时处理时窗宽较宽的那种情况。

## 短时谱

- 语音信号的频域分析就是分析语音信号的频域特征。从广义上讲，语音信号的频域分析包括语音信号的频谱、功率谱、倒频谱、频谱包络分析等，而常用的频域分析方法有带通滤波器组法、傅里叶变换法、线性预测法等几种。
- 因为语音波是一个非平稳过程，因此适用于周期、瞬变或平稳随机信号的<u>标准傅里叶变换不能用来直接表示语音信号</u>，而应该用**短时傅里叶变换**对语音信号的频谱进行分析，相应的**频谱**称为“**短时谱**”







